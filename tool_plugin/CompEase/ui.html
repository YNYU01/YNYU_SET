<!--
- Â©ç‰ˆæƒæ‰€æœ‰ï¼š2024-2025 YNYU @lvynyu2.gmail.com
- ç¦æ­¢æœªæˆæƒçš„å•†ç”¨åŠäºŒæ¬¡ç¼–è¾‘
- ç¦æ­¢ç”¨äºè¿æ³•è¡Œä¸ºï¼Œå¦‚æœ‰ï¼Œä¸ä½œè€…æ— å…³
- äºŒæ¬¡ç¼–è¾‘éœ€å°†å¼•ç”¨éƒ¨åˆ†å¼€æº
- å¼•ç”¨å¼€æºåº“çš„éƒ¨åˆ†åº”éµå¾ªå¯¹åº”è®¸å¯
- ä½¿ç”¨å½“å‰ä»£ç æ—¶ç¦æ­¢åˆ é™¤æˆ–ä¿®æ”¹æœ¬å£°æ˜
-->

<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net.cn/gh/YNYU01/ToolsSet@67b26c5cda59e4cd132cdc992edc9c5a3e38ba86/public/styles_main.css">
</head>

<body class="df-ffc cc noscrollbar" style=" overflow-y: scroll;">
  <div class="df-ffc w100 pos-r" style="gap: 4px; font-size: 10px; margin: 10px 0; padding: 6px; box-sizing: border-box; opacity: 0.6; border: 1px var(--boxBod) dashed; border-radius: 10px;"> 
    <div class="pos-a" style="width: 30px; right: 10px;">
      <svg width="100%" height="100%" viewBox="0 0 350 156" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M312 17.9812V19.068C312 24.0333 313.756 28.2715 317.267 31.7826C320.778 35.2937 325.016 37.0492 329.981 37.0492H331.068C336.033 37.0492 340.272 35.2937 343.783 31.7826C347.294 28.2715 349.049 24.0333 349.049 19.068V17.9812C349.049 13.0159 347.294 8.77766 343.783 5.26658C340.272 1.75553 336.033 0 331.068 0H329.981C325.016 0 320.778 1.75553 317.267 5.26658C313.756 8.77766 312 13.0159 312 17.9812ZM321.754 27.2951C319.482 25.0232 318.346 22.2809 318.346 19.068V17.9812C318.346 14.7683 319.482 12.026 321.754 9.75411C324.026 7.48225 326.768 6.34632 329.981 6.34632H331.068C334.281 6.34632 337.023 7.48225 339.295 9.75411C341.567 12.026 342.703 14.7683 342.703 17.9812V19.068C342.703 22.2809 341.567 25.0232 339.295 27.2951C337.023 29.567 334.281 30.7029 331.068 30.7029H329.981C326.768 30.7029 324.026 29.567 321.754 27.2951ZM334.362 9.44696C335.231 9.44696 336.215 9.65174 337.315 10.0613V17.0984C335.9 16.2283 334.916 15.7933 334.362 15.7933H329.42C328.969 15.7933 328.587 15.9517 328.274 16.2686C327.953 16.5922 327.793 16.9878 327.793 17.4554V19.5936C327.793 20.0613 327.953 20.4569 328.274 20.7805C328.587 21.0974 328.969 21.2558 329.42 21.2558H334.362C334.573 21.2558 334.98 21.1125 335.581 20.826C336.095 20.5812 336.673 20.2545 337.315 19.846V26.9651C336.218 27.3898 335.234 27.6021 334.362 27.6021H329.42C327.204 27.6021 325.318 26.8164 323.763 25.2449C322.219 23.6848 321.447 21.8011 321.447 19.5936V17.4554C321.447 15.248 322.219 13.3642 323.763 11.8041C325.318 10.2327 327.204 9.44696 329.42 9.44696H334.362ZM122.739 45.4885C128.057 42.2516 132.787 37.5808 136.93 31.4761L117.07 18C114.879 21.2287 112.61 23.5578 110.261 24.9875C108.344 26.1544 106.257 26.7379 104 26.738H19V50.738H104C110.743 50.738 116.99 48.9882 122.739 45.4885ZM142 130.903C133.053 146.968 122.208 155 109.465 155H13.438L44.6292 93.6444C45.3056 92.3138 44.339 90.738 42.8464 90.738H0V66.738H150V90.738H77.3239C74.6893 90.738 72.2779 92.2173 71.084 94.5658L52.562 131H109.465C111.218 131 113.223 129.773 115.479 127.319C117.022 125.641 118.548 123.535 120.058 121L142 130.903ZM293.34 122.276C286.316 129.324 276.482 132.737 263.839 132.514L264.226 108.388C270.543 108.499 274.93 107.322 277.387 104.857C279.76 102.475 280.947 98.1599 280.947 91.9118V43.3934H258.855V156H235.803V19.2634H302C303.105 19.2634 304 20.1588 304 21.2634V91.9118C304 105.023 300.447 115.145 293.34 122.276ZM176.971 156H220.567C198.982 145.831 186.24 135.16 182.342 123.987C181.917 122.771 182.865 121.552 184.153 121.552H229.079V19H160C158.895 19 158 19.8954 158 21V116.525C158 131.036 164.324 144.194 176.971 156ZM206.026 97.4225H181.053V84.3412C181.053 83.2367 181.948 82.3412 183.053 82.3412H204.026C205.131 82.3412 206.026 83.2367 206.026 84.3412V97.4225ZM204.026 58.2112H183.053C181.948 58.2112 181.053 57.3158 181.053 56.2112V43.13H206.026V56.2112C206.026 57.3158 205.131 58.2112 204.026 58.2112Z" fill="#D8D8D8"/>
      </svg>        
    </div>
    ğŸ’¬å…¬å‘Šï¼š
    <div class="df" style="gap: 4px;">-<div><a style="color:var(--mainColor2)" >[ToolsSet-å·¥å…·é›†]</a>å®Œæ•´ç‰ˆå·²ä¸‹æ¶ï¼Œå…¨æ–°ç‰ˆé¢„è®¡2025å¹´7æœˆå‘å¸ƒï¼Œæœ¬å·¥å…·åŠç›¸å…³æºç éµå¾ª<a style="color:var(--mainColor2); text-decoration: none;" href="https://choosealicense.com/licenses/agpl-3.0/" target="_blank" >GPL3.0</a>åè®®ï¼›</div></div>
    <div class="df" style="gap: 4px;">-<div>å¯ç§»æ­¥<a style="color:var(--mainColor2); text-decoration: none;" href="https://www.figma.com/community/plugin/1473650402759986360" target="_blank">[æ¸ é“ç¾æœ¯-å»¶å±•å·¥å…·é›†]</a>ï¼ˆå¼€æºåˆ†æ”¯ï¼‰ä½“éªŒå…¶ä»–åŠŸèƒ½ï¼Œä½¿ç”¨é—®é¢˜å¯è”ç³»æ¸ é“ç¾æœ¯åˆ¶ä½œç»„-åŒ¡å¨ï¼›</div></div>
    <div class="df" style="gap: 4px;">-<div>å¦‚æœ‰å…¶ä»–é—®é¢˜ï¼Œå°çº¢ä¹¦ç§ä¿¡<a style="color:var(--mainColor2); text-decoration: none;" href="https://www.xiaohongshu.com/user/profile/602c84520000000001002b1c" target="_blank" >äº‘é›¨_YNYU</a>ï¼›</div></div>
    <div class="df" style="gap: 4px;">-<div>å¯¹éæ”¯æŒå¯¹è±¡ä½¿ç”¨ä¸‹åˆ—åŠŸèƒ½å¯èƒ½é€ æˆä¸å¯é€†çš„æŸå¤±ï¼›</div></div>
  </div>
  <div class="df-ffc w100 noscrollbar" style="height: calc(100% - 170px); font-size: 12px; --toastW:260px; overflow-y: scroll;">

    <div class="df pos-r w100" style=" align-items: center; height: 18px;">
      <div class="tags-search-toast-area" style="left:0px; bottom: -1px;">
        <div class="tags-search-toast" style="bottom: -60px;"> 
          è¾“å…¥è¡Œåˆ—åˆ›å»ºè¡¨æ ¼ï¼ˆé»˜è®¤æ ·å¼ï¼‰ï¼Œå¯é€‰ä¸­å‘½ååˆ†åˆ«å¸¦â€œè¡¨å¤´â€ã€â€œæ•°æ®â€çš„2ä¸ªç»„ä»¶/å®ä¾‹ç”Ÿæˆï¼›
        </div>
      </div>
      <div
        class="tips-i">
        i
      </div>
      <h style="opacity: 0.6; height: 18px; ">è¡¨æ ¼åˆ›å»º</h>
    </div>

    <div style="display: flex; justify-content: space-between; margin: 3px 0;">
      <div class="input-btn-skill" style="width: 60px; min-width: 60px;">
        <input id="input-num-tableH" type="text" class="input-btn-skill" style="border:0px; height: 18px;"
          value="0" onKeyPress="if(window.event.keyCode==13) this.blur()" />
        <div class="input-btn-skill"
          style="border:0px; width:30px; border-radius: 0px ;background-color: var(--boxGry); opacity: 0.8;  color:var(--mainColor)">
          è¡Œ</div>
      </div>
      <div style="width: 10px; min-width: 4px;"></div>
      <div class="input-btn-skill" style="width: 60px; min-width: 60px;">
        <input id="input-num-tableL" type="text" class="input-btn-skill" style="border:0px; height: 18px;"
          value="0" onKeyPress="if(window.event.keyCode==13) this.blur()" />
        <div class="input-btn-skill"
          style="border:0px; width:30px; border-radius: 0px ;background-color: var(--boxGry); opacity: 0.8;  color:var(--mainColor)">
          åˆ—</div>
      </div>
      <div style="width: 20px; min-width: 10px;"></div>
      <div class="btn-skill pos-r" 
        onclick="
        tableData = [document.getElementById('input-num-tableH').value,document.getElementById('input-num-tableL').value]
        message([tableData,'addTable']);
        document.getElementById('input-num-tableH').value = 0,document.getElementById('input-num-tableL').value = 0">
        <div class="tags-search-toast-area" style="right: 0; bottom: -1px; height: 100%;width: 100%; ">
          <div class="tags-search-toast" style="width: 120px; right: -50%;z-index: 30;"> æ­£æ•°ä¸ºå¢ï¼Œè´Ÿæ•°ä¸ºå‡</div>
        </div>
        å¢å‡è¡Œåˆ—
      </div>
      <div style="width: 20px; min-width: 4px;"></div>
      <div class="btn-skill" onclick="message(['tableData','translateTable'])"> 
        <div class="tags-search-toast-area" style="right: 0; bottom: -1px; height: 100%;width: 100%; ">
          <div class="tags-search-toast" style="width: 200px; right: 0;z-index: 30;"> å¦‚åè½¬äº†è®¾è®¡ç¨¿ï¼Œåˆ™æ— éœ€åè½¬æ•°æ®</div>
        </div>
        åè½¬è¡Œåˆ—
      </div>
    </div>

    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="btn-skill" style="border: var(--boxBod) 1px solid; " onclick="
        var tableData = [document.getElementById('input-num-tableH').value,document.getElementById('input-num-tableL').value]
        message([tableData,'creTable'])"> å»ºç«‹è¡¨æ ¼ </div>
    </div>

    <div style="min-height: 18px;"></div>

    <div class="df pos-r w100" style=" align-items: center; height: 18px;">
      <div class="tags-search-toast-area" style="left:0px; bottom: -1px;">
        <div class="tags-search-toast"> é€šè¿‡è¡¨æ ¼æ•°æ®>> æ›¿æ¢#tableå†…å®¹ | æ›¿æ¢#æ•°æ®æµå†…å®¹ | æ›¿æ¢ç»„ä»¶å±æ€§ | æŒ‰æ ‡ç­¾æ›¿æ¢å±æ€§ <br>æ•°æ®æ–‡æ¡ˆæœ¬èº«æ¢è¡Œï¼Œéœ€åœ¨æ¢è¡Œå¤„æ·»åŠ è½¬ä¹‰ç¬¦ï¼Œé»˜è®¤ç”¨[enter]è¡¨ç¤º</div>
      </div>
      <div
        class="tips-i">
        i
      </div>
      <h style="opacity: 0.6; height: 18px; ">è¡¨å•ç¼–è¾‘</h>
    </div>

    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="input-btn-skill w100">
        <div class="input-btn-skill"
          style="border:0px; min-width:80px; border-radius: 0px ;background-color: var(--boxGry); opacity: 0.8;  color:var(--mainColor)">
          ç©ºæ•°æ®å ä½</div>
        <input type="text" class="input-btn-skill" style="border:0px; height: 18px;"
          value="" onKeyPress="if(window.event.keyCode==13) this.blur()" oninput="message([this.value,'setNullText'])"/>
      </div>
      <div class="input-btn-skill w100">
        <div class="input-btn-skill"
          style="border:0px; min-width:80px; border-radius: 0px ;background-color: var(--boxGry); opacity: 0.8;  color:var(--mainColor)"
          ondblclick="this.nextElementSibling.value = '[enter]';message(['[enter]','setEnterText']);if(isGetTableData){message(['getTableData','getTableData'])};">
          æ¢è¡Œè½¬ä¹‰ç¬¦
        </div>
        <input type="text" class="input-btn-skill" style="border:0px; height: 18px;"
          value="[enter]" 
          onKeyPress="if(window.event.keyCode==13){if(this.value == ''){this.value = '[enter]'}; this.blur()};" 
          oninput="if(this.value == ''){this.value = '[enter]'}; message([this.value,'setEnterText']);"
          onchange="if(this.value == ''){this.value = '[enter]'}; if(isGetTableData){message(['getTableData','getTableData'])}"/>
      </div>
    </div>
    <div class="pos-r">
      <textarea id="tableData-text" class="input-textarea noscrollbar"
        style="height: 180px; max-height: 400px; min-height: 180px;font-size: 10px;" 
        ondblclick="if(this.value == ''){ this.value = 'a1\tb1\tc1\na2\tb2\tc2\na3\tb3\tc3';userTableData = this.value;}"
        onchange="userTableData = this.value; "
        onfocus="dataTextTips.style.display = 'none';
         this.placeholder = ''; 
         this.parentNode.parentNode.style.overflowY = 'hidden';"
        onblur="if(!this.value){dataTextTips.style.display = 'block';};
        this.parentNode.parentNode.style.overflowY = 'scroll';"></textarea>
      <!--æ¸…ç©º-->
      <div style="width: 14px; position: absolute; right: 4px;top:4px; cursor: pointer; z-index: 3;"
        onclick="dataText.value = '';userTableData = '';dataTextTips.style.display = 'block';isGetTableData = false">
        <btn-close></btn-close>
      </div>
      <div id="table-text-tips" class="df-ffc pos-a"
        style="opacity: 0.4; gap: 10px; font-size: 10px; width: calc(100% - 20px);bottom: 10px; left: 10px;line-height: 2.5ch; pointer-events: none;">
        <div>
          -ã€æ‰¹é‡æ›¿æ¢æ–‡æœ¬ã€‘
          <span style="opacity: 0.6;">
            ä»…æ”¯æŒæ›¿æ¢æ–‡æœ¬ç±»å‹ç»„ä»¶å±æ€§ï¼Œ
          </span>
          ã€æ‰¹é‡ç»„ä»¶å±æ€§ã€‘
          <span style="opacity: 0.6;">
            æ”¯æŒæ›¿æ¢ä»»æ„ç±»å‹ç»„ä»¶å±æ€§ï¼ŒæŒ‰è¡¨å¤´æŸ¥æ‰¾å¯¹åº”ç»„ä»¶å±æ€§åï¼›
          </span>
          ã€ç»„ä»¶å±æ€§ã€‘
          <span style="opacity: 0.6;">
            çš„è¯¦ç»†ç”¨æ³•è¯·è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£/æ•™ç¨‹ï¼›
          </span>
        </div>
        <div>
          -ã€æ‰¹é‡æ ‡ç­¾å±æ€§ã€‘
          <span style="opacity: 0.6;">
            ä»…æ”¯æŒæ›¿æ¢ä»¥ä¸‹å±æ€§ï¼š
          </span>
          <span style="color:var(--liColor1);">
            fillcolor | strokecolor | fontsize | view | fillstyle | strokestyleï¼ˆ...å¾…ç»­ï¼‰
          </span>
          <span style="opacity: 0.6;">
            ï¼Œè¡¨å¤´/æ ‡ç­¾çš„æ ¼å¼ä¸ºï¼š
          </span>
          <span style="color:var(--liColor1);">
            #XXX.fillcolor
          </span>
          <span style="opacity: 0.6;">
            ï¼Œéœ€ç»™å¯¹åº”å›¾å±‚å‘½ååæ·»åŠ æ ‡ç­¾ï¼ˆå¯å¤šä¸ªæ ‡ç­¾ã€é‡å¤æ ‡ç­¾ï¼‰ï¼›
          </span>
        </div>
        <div>
          - 
          <span style="opacity: 0.6;">
            åŒ…è£¹å®¹å™¨å‘½åå¸¦
          </span>
          ã€tableã€‘+ã€åˆ—ã€‘|ã€æ•°æ®æµã€‘
          <span style="opacity: 0.6;">
            ä¼šå…ˆå¢å‡è¶³å¤Ÿå­å›¾å±‚ï¼Œå†æŒ‰è¡Œåˆ—/è¡Œæ›¿æ¢ï¼›
          </span>
        </div>
      </div>
    </div>
    
    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="btn-skill" onclick="message([userTableData,'reTableName'])"> æ‰¹é‡æ›¿æ¢å‘½å </div>
      <div class="btn-skill" onclick="message([userTableData,'reTable'])"> æ‰¹é‡æ›¿æ¢æ–‡æœ¬ </div>
    </div>
    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="btn-skill" onclick="message([userTableData,'setByTags'])"> æ‰¹é‡æ ‡ç­¾å±æ€§ </div>
      <div class="btn-skill" onclick="message([userTableData,'reComponentValue'])"> æ‰¹é‡ç»„ä»¶å±æ€§ </div>
    </div>
    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="btn-skill" onclick="message(['getTagsData','getTagsData']);"> æå–æ ‡ç­¾å±æ€§ </div>
      <div class="btn-skill" onclick="message(['getTableData','getTableData']);isGetTableData = true"> æå–ç»„ä»¶å±æ€§ </div>
      <!--div class="btn-skill" onclick="message(['linkCompDoc','linkCompDoc'])"> ç®€å•é‡é“¾ç»„ä»¶ </div-->
    </div>
    

    <div style="min-height: 18px;"></div>

    <div class="df pos-r w100" style=" align-items: center; height: 18px;">
      <div class="tags-search-toast-area" style="left:0px; bottom: -1px;">
        <div class="tags-search-toast"> åŸºäºæ’ä»¶ç”Ÿæˆçš„tableè®¾ç½®æ ·å¼</div>
      </div>
      <div
        class="tips-i">
        i
      </div>
      <h style="opacity: 0.6; height: 18px; ">è¡¨æ ¼æ ·å¼</h>
    </div>
    <div style="display: flex; justify-content: space-between; gap: 6px; margin: 3px 0;">
      <div class="btn-skill" onclick="message(['diffLine','diffColorTable'])"> é—´éš”åŒºåˆ†è‰² </div>
      <div class="btn-skill" onclick="message(['all','diffColorTable'])"> å¼€/å…³åŒºåˆ†è‰² </div>        
    </div>
  </div>
  <div class="df pos-a " style="width: calc(100% - 20px); justify-content: space-between; bottom: 0; opacity: 0.6;"
    ondblclick="message(['getnode','getnode'])">
    <div style="font-size: 10px;">ToolsSet-çº¯è¡¨å•ç‰ˆ</div>
    <div style="font-size: 10px;">Â©YNYU  lvynyu2@gmail.com</div>
  </div>

  <script>
    var isGetTableData;
    //å…¨å±€å˜é‡
    const root = document.documentElement;
    const dataText = document.getElementById('tableData-text');
    const dataTextTips = document.getElementById('table-text-tips');

    let tableData;//è¡Œåˆ—æ•°æ®
    let userTableData;//å¡«å……è¡¨æ ¼æˆ–æ•°æ®æµç”¨çš„æ•°æ®

    class close extends HTMLElement {
      constructor() {
        super();
        this.innerHTML = `
          <div class="wh100 btn-text" style="background:rgba(0,0,0,0.5); padding:20%; box-sizing: border-box; flex:0 0 auto; border-radius: 50%;">
            <svg width="100%" height="100%" viewBox="0 0 8 7" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="1.52515" y="0.318024" width="8" height="1" transform="rotate(45 1.52515 0.318024)" fill="var(--mainColor)"/>
              <rect x="7.18188" y="1.02512" width="8" height="1" transform="rotate(135 7.18188 1.02512)" fill="var(--mainColor)"/>
            </svg>
          </div>
        `;
      }
    };
    customElements.define('btn-close', close);
    //å°è£…postmessage
    function message(data){
      /*figma*/
      parent.postMessage({pluginMessage:data},"*")
      /*mastergo*/
      //parent.postMessage(data,"*")
    }

    window.onmessage = (messages) => {

      if(messages.data && messages.data.pluginMessage && messages.data.pluginMessage.pluginMessage){
        //console.log(message.data)
        //console.log(message.data.pluginMessage.pluginMessage)
        /*figma*/
        let pluginDatas = messages.data.pluginMessage.pluginMessage;
        /*mastergo*/
        //let pluginDatas = message.data;

        let info = pluginDatas[0];
        let type = pluginDatas[1];

        if(type == "tableForDoc"){
          //console.log(info)
          let docDataText = ''
          info.forEach((item,index) => {
            item.forEach((items,indexs) => {
              indexs !== (item.length - 1) ? docDataText += items + '\t' : index !== (info.length - 1) ? docDataText += items + '\n' : docDataText += items;
            })
          });
          //console.log(docDataText)
          dataText.value = docDataText;
          dataText.focus()
          userTableData = docDataText;
        }
        if(type == "sendDoc"){
          console.log(info)
        }   
      }
    }

    dataText.addEventListener('keydown', function (event) {
        if (event.key === 'Tab') {
          event.preventDefault(); // é˜»æ­¢é»˜è®¤Tabè¡Œä¸º
          const start = this.selectionStart;
          const end = this.selectionEnd;
          const selectedText = this.value.substring(start, end);
          const before = this.value.substring(0, start);
          const after = this.value.substring(end, this.value.length);
          this.value = before + '\t' + selectedText + after; // ç”¨4ä¸ªç©ºæ ¼æ›¿æ¢Tab
          this.selectionStart = this.selectionEnd = start + 4; // è®¾ç½®å…‰æ ‡ä½ç½®
        }
      });
  </script>
</body>
