<html data-plugin="fig" data-selects="false" data-selects-more="false" data-theme="dark" data-language="Zh" data-mobile="false">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/public/run.js"></script>
  <!-- INLINE_RUN -->
  <script>
PULGIN_LOCAL = true;
let userSkillStar = [];
if (ISPLUGIN){
  ROOT.setAttribute('data-mobile','false');
  ISMOBILE = false;
  toolMessage(['userTheme','getlocal'],PLUGINAPP);
  toolMessage(['userLanguage','getlocal'],PLUGINAPP);
  toolMessage(['userResize','getlocal'],PLUGINAPP);
  toolMessage(['tabPick','getlocal'],PLUGINAPP);
  toolMessage(['userSkillStar','getlocal'],PLUGINAPP);
}

window.addEventListener('message',(message)=>{
  let isPluginMessge = message.data && message.data.type && message.data.type == 'figma-ex-page-info';
  if(!isPluginMessge){
    let messages = message.data.pluginMessage.pluginMessage || ['',''];
    let info = messages[0];
    let type = messages[1];
    if(typeof(info) == 'string' && (info.split('[').length > 1 || info.split('{').length > 1)){
      info = JSON.parse(info);
    }
    switch (type){
      case 'userTheme': info == 'light' ? setTheme(true,false) : setTheme(false,false);break
      case 'userLanguage': info == 'Zh' ? setLanguage(true) : setLanguage(false);break
      case 'userResize': reRootSize(info);break
      case 'tabPick': viewPage(info);break
      case 'userSkillStar': userSkillStar = info || []; moveSkillStar(userSkillStar);break
      case 'selectInfo': reSelectInfo(info);break
      case 'selectInfoMain': addTableText(tableObjToText(info));break
      case 'selectComp': reSelectComp(info);break
    };
  };
});

/**
 * @param {Array} data - [info,typeName/skillName]
 * @param {string} app - PLUGINAPP(需定义) | 'fig' | 'mg'
 */
function toolMessage(data,app){
  switch (app){
    case 'fig': parent.postMessage({pluginMessage:data},"*"); break
    case 'mg' : parent.postMessage(data,"*");break
  }
}




</script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/builds/yn_style.css"  >
  <!-- INLINE_CSS -->
  <style>
@font-face {
  font-family: Shanggu Sans;
  src: url("https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/fonts/other/ShangguSans-Regular.otf") format('opentype');
  font-weight: 400;
  font-display: swap;;
}

:root{
  --top-h: 32px;
  --bottom-h: 40px;
  --side-w: 200px;
  --option-font: 12px;
  --pointer:url('https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/VI/pointer_24.png'),auto;
  --code3:#48a64d;
  --code4:#b677b1;
  --code5:#a66e48;
  --code6:#77b6b6;
  --code7:#a64848;
  --code8:#527ac4;
  --code9:#e09524;
  --code10:#ec657c;
  /*初始化*/
  --select-w: 100;
  --select-h: 100;
  --w: auto;
  --h: 100%;
}

html[data-theme="light"] {
  --boxGry: #d9d9d9;
  --themeColor: #1cc992;
}

html{
  cursor: url('https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/VI/cursor_16.png'),auto;
}

* {
  cursor: inherit;
}

body{
  min-width: 200px;
}

/*--组件修改*/
.show-next{
  margin:0 2px 0 -2px;
  cursor: var(--pointer,pointer);
}

.show-next::after {
  transform-origin: 40% 40%;
}

p [data-highlight]{
  color: var(--themeColor)
}

[data-radio]{
  width: fit-content;
  height: fit-content;
  flex: 0 0 auto;
  border: none;
  background: none;
  padding: 0.5ch 0;
}

[data-radio-main]:hover {
  background: var(--boxGry);
}

[data-theme="dark"] [data-radio-main="true"] {
  --mainColor: inherit;
}

[data-radio-main="true"] {
  background: var(--boxGry);
}

[data-skill-sec] [data-radio]{
  padding: 0;
  min-width: fit-content;
  height: 20px;
  box-sizing: border-box;
  font-size: 12px;
  border: 1px solid var(--boxBod);
  flex: 1;
}

[data-resize]::after {
  pointer-events: none;
}

[data-option="type"] {
  padding: 1ch 0 0.5ch 1ch;
}

[data-option="option"] {
  padding: 0.5ch 0 0.5ch 3ch;
}

[data-language="En"] [data-tips]::after{
  content: var(--tips-text-en,'something there');
}


#tips-all{
  display: none;
  justify-content: center;
  align-items: center;
  position: absolute;
  width: 100%;
  bottom: 80px;
  margin: auto;
  animation: boxUp 0.2s;
  z-index: 20;
  pointer-events: none;
}

.tips-all-text{
  color: #ffffff;
  background: rgba(0, 0, 0, 0.8);
  padding: 4px 8px;
  border-radius: 8px;
}

.switch [data-swi-icon]{
  transition:transform 0.2s ease-out;
  }
  
input[type="checkbox"]:checked+.switch [data-swi-icon]{
  transform: translateX(var(--swi-h,18px));
}

[data-input-unit]{
  height: 20px;
  width: 14px;
  flex: 0 0 auto;
  padding: 0 0 0 0.5ch;
  background: var(--boxGry);
  margin-left: -0.5ch;
  border-radius: 0 4px 4px 0;
}

[data-input-unit="auto"]{
  width: fit-content;
  padding:0 0.5ch 0 1ch;
}
/*组件修改--*/

html[data-language="En"] {
  --mainFontSize: 10px;
}

html[data-language="Zh"] {
  --mainFontSize: 12px;
}

body{
  font-size: var(--mainFontSize);
}

#top{
  height: var(--top-h);
  position: relative;
}

#top::after{
  content: '';
  position: absolute;
  bottom: -1px;
  width: 100%;
  height: 1px;
  background: var(--boxBod);
  opacity: 0.5;
}

#bottom{
  height: var(--bottom-h);
  bottom: 0;
  padding:0 10px 0 4px;
  box-sizing: border-box;
}

#bottom::before{
  content: '';
  position: absolute;
  top: -1px;
  width: 100%;
  height: 1px;
  background: var(--boxBod);
  opacity: 0.5;
}

[data-tab-for="page"]{
  gap: 4px;
  padding-left: 2%;
}

.tab-top{
  padding: 2px 4px;
  border-radius: 4px;
  text-transform: capitalize;
  opacity: 0.5;
}

input[type="checkbox"]:checked + .tab-top{
  opacity: 1;
  background: var(--swi-bak);
}

[data-page-id="page"]{
 height: calc(100vh - var(--bottom-h) - var(--top-h));
}

[data-tv-box]{
  display: flex;
  align-items: center;
  width: calc(100% - 10px);
  font-size: 10px;
}

[data-tv-text]::before,
[data-tv-text]::after{
  content: '❤';
  color: rgb(248, 153, 169);
  width: 10px;
  height: 10px;
  padding: 1px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 auto;
  transform: scale(0.8);
  animation: heartUp 0.5s cubic-bezier(0,10,1,1) infinite;
}

@keyframes heartUp {
  to{
    transform: scale(0.86);
  }
}

.btn-big{
  width: 12px;
  height: 12px;
  margin-left: 2px;
  cursor: var(--pointer,pointer);
}

input[type="checkbox"]:checked+.btn-big .path1 {
  transform: translateY(6px) translateX(-6px);
}

input[type="checkbox"]:checked+.btn-big .path2 {
  transform: translateX(6px) translateY(-6px);
}

[data-side]{
  left: 0;
  z-index: 11;
  /*animation: topTabUp 0.5s;*/
}

[data-side-mix]{
  width: var(--side-w);
  background: var(--boxGry);
  padding: 10px 10px;
  justify-content: space-between;
  display: none;
  overflow: hidden;
}


@keyframes sideUp {
  0%{
    width: 0;
  }
  100%{
    width: var(--side-w);
  }
}

@keyframes sideOver {
  0%{
    width: var(--side-w);
    padding-left: 10px;
  }
  100%{
    width: 0;
    padding-left: 0px;
  }
}

@keyframes topTabUp {
  0%{
    transform: translateY(calc(var(--top-h) * -1));
  }
  100%{
    transform: translateY(0%);
  }
}

[data-icon-more]{
  transition: transform 0.4s;
}

input[type="checkbox"]:checked + label [data-icon-more]{
  transform: rotate(90deg);
}

[data-icon-more-path]{
  stroke: var(--mainColor);
  stroke-width: 2;
  transition: transform 0.2s;
}

[data-icon-more-path="1"]{
  transform: matrix(1,0,0,1,1,4);
}
[data-icon-more-path="2"]{
  transform: matrix(1,0,0,1,1,10);
}
[data-icon-more-path="3"]{
  transform: matrix(1,0,0,1,1,16);
}

input[type="checkbox"]:checked + label [data-icon-more-path="1"]{
  transform: matrix(0.7,0.7,-0.7,0.7,3.64,3.64);
}
input[type="checkbox"]:checked + label [data-icon-more-path="2"]{
  transform: matrix(0.1,0,0,1,10,10);
}
input[type="checkbox"]:checked + label [data-icon-more-path="3"]{
  transform: matrix(0.7,-0.7,0.7,0.7,3.64,16.37);
}

[data-page-id="page"] [data-icon-more-path="1"] path{
  transform: matrix(0.25, 0, 0, 2, -2, 6);
}
[data-page-id="page"] [data-icon-more-path="2"] path{
  transform: matrix(0.25, 0, 0, 2, 7, 0);
}
[data-page-id="page"] [data-icon-more-path="3"] path{
  transform: matrix(0.25, 0, 0, 2, 16, -6);
}

input[type="checkbox"]:checked + label [data-icon-more-path="1"] path,
input[type="checkbox"]:checked + label [data-icon-more-path="2"] path,
input[type="checkbox"]:checked + label [data-icon-more-path="3"] path{
  transform: matrix(1,0,0,1,0,0);
}

#btn-theme-1,#btn-theme-2,#btn-theme-3{
  width: 20px;
  height: 20px;
  padding: 4px;
  box-sizing: border-box;
  background: var(--swi-bak);
  border-radius: 4px;
  border: 1px solid var(--boxBod);
}

[data-mainset-top],
[data-mainset-bottom]{
  display: none;
}

.btn-more{
  width: 16px;
  height: 16px;
  opacity: 0.6;
  cursor: var(--pointer,pointer);
}

[data-mainset-side-box]{
  gap:4px;
  padding: 10px 0;
  border-top: 1px solid var(--boxBod);
}

[data-language="Zh"] [data-any="en"]{
  display: none;
}

[data-language="En"] [data-any="zh"]{
  display: none;
}

[data-resize-window]{
  content: '';
  position: absolute;
  cursor:nw-resize;
  bottom: 2px;
  right: 2px;
  width: 8px;
  height: 8px;
  background: linear-gradient(to top left,
  transparent 20%,
  var(--boxBod) 21%,
  var(--boxBod) 25%,
  transparent 26%,
  transparent 45%,
  var(--boxBod) 46%,
  var(--boxBod) 50%,
  transparent 51%);
}

[data-tv-box]{
  padding: 0 4px;
}

[data-tv-cut]{
  height: 18px;
  border-radius: 10px;
  background:  rgba(0, 0, 0, 0.8);
  --mainColor: #b9b9b9;
  color: var(--mainColor);
  margin-top: 2px;
}

[data-theme="dark"] [data-tv-cut]{
  --mainColor: #9b9b9b;
}

[data-btn-name]{
  opacity: 0.6;
  white-space: initial;
  text-align: center;
}


/*--按钮类*/
[data-btn]{
  max-width: 580px;
  padding: 2px 0;
  border: 1px solid var(--boxBod);
  box-sizing: border-box;
  cursor: var(--pointer,pointer);
}

[data-btn]:hover{
  background: var(--boxGry);
}

[data-btn]:active{
  transform: translateY(1px);
}

[data-btn="main"]{
  width: calc(100% - 20px);
  border-radius: 20px;
  background: var(--boxGry);
}

[data-btn="main2"]{
  border-radius: 20px;
  background: var(--boxGry);
}

[data-btn="main"]:hover,[data-btn="main2"]:hover,[data-btn="skill-main"]:hover{
  background: var(--boxBod);
}

[data-btn="skill"],[data-btn="skill-main"]{
  border-radius: 4px;
}

[data-btn="skill-main"]{
  width: 100%;
  background: var(--boxGry);
}

[data-btn="help"]{
  margin: 6px 0;
  padding: 0;
  --boxBod: var(--themeColor);
  background: var(--themeColor);
  border-radius: 20px;
  color: #000;
}

[data-btn="help"]:hover{
  background: var(--code1);
}

[data-btn="icon"]{
  display: block;
  width: 40px;
  height: 40px;
  background: none;
  border: none;
}

[data-btn="icon"]:hover{
  background: none;
  opacity: 0.5;
}

[data-btn="moreset"]{
  width: 40px;
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border-radius: 4px;
  border: 1px solid var(--boxBod);
}

[data-btn="moreset"]:hover{
  background: var(--boxGry);
}

[data-btn="reset"]{
  width: 20px;
  height: 20px;
  flex: 0 0 auto;
  border-radius: 4px;
  margin-left: 4px;
}

input[type="checkbox"]:checked + .btn-moreset:hover{
  background: var(--themeColor);
  --mainColor: #242424;
}


.btn-moreset{
  width: 40px;
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border-radius: 4px;
  border: 1px solid transparent;
  background: var(--themeColor);
  --mainColor: #242424;
  cursor: var(--pointer,pointer);
}


input[type="checkbox"]:checked + .btn-moreset{
  background: transparent;
  border: 1px solid var(--boxBod);
  --mainColor: var(--boxBod);
}

[data-help]{
  width: 12px;
  height: 12px;
  border: 1px solid var(--mainColor); 
  border-radius: 50%;
  font-size: 10px;
  color: var(--mainColor);
  cursor: var(--pointer,pointer);
  margin-left: 4px;
}

[data-skilltype-icon]{
  width: 40px;
  height: 40px;
  padding: 4px;
  box-sizing: border-box;
  flex: 0 0 auto;
}

[data-skill-star] {
  width: 20px;
  height: 20px;
  position: absolute;
  cursor: var(--pointer,pointer);
  top: 4px;
  right: 4px;
}

[data-skillmodule="Useful & Starts"] span [data-skill-star]{
  display: inline-block;
  position: relative;
  top: 8px;
  left: 0;
  width: 24px;
  height: 24px;
}

[data-transform-center-box]{
  min-width: 70px;
  height: 70px;
  flex: 0 0 auto;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 4px;
  padding: 4px;
  border: 1px solid var(--boxBod);
  border-radius: 6px;
}

[data-transform-center-box] [data-radio]{
  align-self: center;
  justify-self: center;
  width: 14px;
  height: 14px;
  border: none;
}

[data-transform-center-box] [data-radio-main="true"]{
  color: transparent;
  background: var(--themeColor);
}

/*按钮类--*/

/*--模块类*/
[data-dailog]{
  display: none;
  width: 100vw;
  height: 100vh;
  padding: 50px 20px;
  background: rgba(0, 0, 0, 0.6);
  z-index: 12;
  gap: 4px;
  text-wrap: wrap;
}

[data-dailog-box] p{
  font-size: 11px;
}

[data-dailog-box] li{
  opacity: 0.6;
  font-size: 10px;
}

[data-language="Zh"] [data-dailog-box] li{
  line-height: 2em;
}

[data-dailog-box] p::before{
  content: '👌 ';
}

[data-dailog-close]{
  width: 80%;
  max-width: 480px;
}

[data-dailog-close] [data-close]{
  width: 20px;
  height: 20px;
}

[data-dailog-box]{
  width: 80%;
  height: 70%;
  max-width: 480px;
  padding: 2% 4%;
  box-sizing: border-box;
  border-radius: 10px;
  border: 1px solid var(--boxBod);
  background: var(--boxGry); 
  gap: 4px;
}

.bod-d{
  border: 1px var(--boxBod) dashed;
  border-radius: 10px;
}
[data-drop="upload"]{
  max-width: 560px;
  /*filter: drop-shadow(0 0 var(--drop-w,0) var(--mainColor));*/
}
[data-mode-id="upload"]{
  visibility: var(--drop-df,visible)/*collapse*/;
  gap: 10px;
  padding: 10px;
  font-size: 10px;
}
.file-tag{
  visibility: var(--drop-df,visible)/*collapse*/;
  border-radius: 0 0 10px 10px;
  background: var(--boxGry);
  padding: 2px 8px;
  font-size: 10px;
}
.upload-set{
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border: 1px solid var(--boxBod);
  border-radius: 4px;
}
.nobod {
  --boxBod: transparent;
}

#upload-textarea{
  height: 180px;
  min-height: 180px;
  resize: vertical;
  padding: 4px 10px;
  text-wrap: nowrap;
  line-height: 1.5em;
}

#upload-set-box{
  width:100%;
  justify-content: space-between;
}

#upload-set-main{
  gap: 4px;
}

[data-resize]::-webkit-resizer,
[data-resize] *::-webkit-resizer{
  display: none;
}

[data-create-tags-box]{
  resize: vertical;
  height: 200px;
  max-width: 560px;
  min-height: 20vh;
  max-height: 80vh;
}

[data-create-tags],[data-create-catalogues]{
  height: fit-content;
  display: none;
}

[data-create-tags-box="image"] [data-create-tags],
[data-create-tags-box="table"] [data-create-tags]{
  display: flex;
}

[data-create-tags]{
  flex-wrap: wrap;
  gap: 10px;
}

[data-create-tag]{
  height: 24px;
  padding: 2px 4px;
  background: var(--boxGry);
  border-radius: 6px;
  gap: 4px;
  font-size: 10px;
}

[data-tableset-thtd] label{
  cursor: var(--pointer,pointer);
}

[data-tablestyle-set]{
  gap: 4px;
}

[data-tablestyle-chk]{
  width: 20px;
  height: 20px;
  padding: 0.5ch;
}

[data-selectcomp-mix]{
  font-size: 10px;
}

[data-selectcomp-box="false"] [data-selectcomp-mix]{
  display: none;
}

[data-selectcomp-box="true"] [data-selectcomp-no]{
  display: none;
}

[data-selectcomp-1],[data-selectcomp-2]{
  color: var(--themeColor2)
}

input[type="checkbox"]:checked ~ [data-selectcomp-box],
input[type="checkbox"]:checked ~ [data-tablestyle-box]{
  width: 100vw;
}

[data-tablestyle-name]{
  font-size: 10px;
  margin-right: 0.5ch;
}

[data-skilltype-box]{
  max-width: 560px;
  height: 60px;
  padding: 0 10px;
  gap: 6px;
  margin: 0 auto;
}
[data-language="En"] [data-skilltype-box]{
  gap: 4px;
}

[data-skilltype-name]{
  font-size: 10px;
  line-height: 1.25em;
  text-wrap: wrap;
}

[data-skills-scroll]{
  max-width: 560px;
  border-top: 1px solid var(--boxBod);
  padding-bottom: 80px;
}

[data-skills-box]{
  padding-top: 10px;
  gap: 6px;
}

[data-skillmodule]{
  border-radius: 4px;
  padding: 6px;
  box-sizing: border-box;
  min-height: 180px;
  flex-wrap: wrap;
  gap: 6px;
}

[data-skillmodule="Useful & Starts"]{
  min-height: 80px;
}

[data-skill-sec]{
  position: relative;
  min-width: 200px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.03);
  padding: 8px;
  text-wrap: wrap;
}

[data-skill-sec]:hover{
  box-shadow:0 0 1px 1px var(--boxBod);
}

[data-theme="dark"] [data-skill-sec]{
  background: rgba(255, 255, 255, 0.03);
}

[data-skill-cover="end"]{
  opacity: 0.5;
  position: relative;
  overflow: hidden;
}

[data-skillnum-odd="1"] [data-skill-cover="end"]{
  display: none;
}

[data-skill-cover="end"]::after{
  content: '';
  position: absolute;
  width: 110%;
  height: 110%;
  top: -10%;
  left: -10%;
  background: url('https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@499353f70d93db793ee5a4102aba38f934c27292/VI/logo_graph_bod.png');
  background-size: 380px;
  animation: bgMove 50s linear infinite;
}

@keyframes bgMove {
  to{
    background-position: 380px 0;
  }
}

[data-skillmodule="Useful & Starts"] [data-skill-cover="end"]{
  opacity: 0.8;
}

[data-skillmodule="Useful & Starts"] [data-skill-cover="tips"]{
  margin-top: -6px;
}


[data-skill-title]{
  --icon-info: var(--boxBod);
  height: 14px;
  gap: 4px;
  margin-bottom: 4px;
}

[data-skill-sec-name]{
  font-size: 12px;
  opacity: 0.6;
  text-transform: capitalize;
}

[data-skill-btnname],[data-skill-btnname-top]{
  font-size: 10px;
}

[data-skill-btnname]::after{
  content: ' ▶';
  opacity: 0.6;
}

[data-skill-btnname-top]::after{
  content: ' ▼';
  opacity: 0.6;
}

[data-skill-line]{
  padding:0 4px;
  margin-bottom: 6px;
  gap: 4px;
}

[data-skill-more]{
  gap: 4px;
}

[data-skewscale-box]{
  width: 100%;
  height: 60px;
  position: relative;
  overflow: hidden;
}
[data-skewscale-box]::after{
  content: '+';
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  top: 0;
  left: calc(50% - 30px);
  width: 60px;
  height: 60px;
  z-index: 0;
}

[data-skewscale-view]{
  /**
  --select-h: 100;
  --select-w: 3000;
  --h: auto;/*谁小谁auto*/
  /**/
  --wh: calc(var(--select-w)/var(--select-h));
  aspect-ratio: var(--wh,1);
  width: var(--w,100%);
  height: var(--h,100%);
  max-height: calc(100% - 10px);
  max-width: calc(100% - 40px);
  border: 1px var(--themeColor) solid;
  box-sizing: border-box;
  transform: 
  skew(
    calc(var(--skewX,0) * 1deg),
    calc(var(--skewY,0) * 1deg))
  scale(
    calc(var(--scaleX,100) * 1%),
    calc(var(--scaleY,100) * 1%));
}

[data-selects-node]{
  width: 100%;
  max-width: 560px;
  height: 38px;
  font-size: 10px;
  text-wrap: wrap;
  text-align: center;
  opacity: 0.6;
  margin: 4px 0;
  background: rgba(0, 0, 0, 0.8);
  --mainColor: #b9b9b9;
  color: var(--mainColor);
  border-radius: 10px;
  transform: translateY(6px);
}

[data-selects="true"] [data-selects-node]{
  opacity: 1;
}

[data-selects="true"] [data-selects-node]::after{
  content: '';
}

[data-selects="false"] [data-selects-node]::after{
  content: var(--tips-text,'未选中任何图层');
  margin: 0 auto;
}
[data-language="En"] [data-selects-node]::after{
  --tips-text: var(--tips-text-en,'No layer selected');
}

[data-selects="false"] [data-selects-info-box]{
  display: none;
 }
 
[data-selects-info="more"]{
   display: none;
 }

[data-selects="true"] [data-selects-info-box],
[data-selects-more="true"] [data-selects-info="more"]{
  display: inline-flex;
}

[data-selects-info-box] span{
  text-wrap: nowrap;
}

[data-selects-info="main"],[data-selects-info="num"]{
  color: var(--themeColor2);
}

[data-selects-more="false"] [data-selects-info="main"]{
  color: var(--mainColor);
}

[data-selects="false"] [data-skill-line],
[data-selects="false"] [data-selects-must]{
  pointer-events: none;
  opacity: 0.6;
}

[data-skill-gap]{
  font-size: 10px;
  opacity: 0.6;
}

[data-clip-view]{
  width: 100%;
  height: 200px;
  position: relative;
  margin: 4px 0;
}

[data-clip-select]{
  /**
  --select-h: 1200;
  --select-w: 100;
  --w: auto;/*谁小谁auto*/
  /**/
  --wh: calc(var(--select-w)/var(--select-h));
  aspect-ratio: var(--wh,1);
  width: var(--w,100%);
  height: var(--h,100%);
  max-height: calc(100% - 30px);
  max-width: calc(100% - 30px);
  border-radius: 0;
}

[data-clip-set-box="w"]{
  width: 100%;
  height: calc(100% + 30px);
  top: -15px;
  left: 0;
}

[data-clip-set-box="h"]{
  width: calc(100% + 30px);
  height: 100%;
  top: 0;
  left: -15px;
}

[data-clip-w="0"]{
  --dis-w1: none;
  --dis-w2: none;
}
[data-clip-w="2"]{
  --xx: 33.3%;
  --dis-w1: block;
  --dis-w2: none;
}
[data-clip-w="4"]{
  --xx: 20%;
  --dis-w1: block;
  --dis-w2: block;
}
[data-clip-h="0"]{
  --dis-h1: none;
  --dis-h2: none;
}
[data-clip-h="2"]{
  --yy: 33.3%;
  --dis-h1: block;
  --dis-h2: none;
}
[data-clip-h="4"]{
  --yy: 20%;
  --dis-h1: block;
  --dis-h2: block;
}

[data-clip-set="x1"],[data-clip-set="x2"]{
  display: var(--dis-w1);
}
[data-clip-set="x3"],[data-clip-set="x4"]{
  display: var(--dis-w2);
}
[data-clip-set="y1"],[data-clip-set="y2"]{
  display: var(--dis-h1);
}
[data-clip-set="y3"],[data-clip-set="y4"]{
  display: var(--dis-h2);
}


[data-clip-set-box="w"] [data-clip-set]{
  width: var(--x,var(--xx));
  border-width:0 1px 0 0;
  resize: horizontal;
  max-width: calc(100% - 10px);
  min-width: 1px;
}

[data-clip-set-box="w"] [data-clip-set]::after{
  right: -4px;
  bottom: 0;
}

[data-clip-set-box="w"] [data-clip-set]::before{
  right: 6px;
  bottom: 0;
}

[data-clip-set-box="h"] [data-clip-set]{
  height: var(--y,var(--yy));
  border-width:0  0 1px 0;
  resize: vertical;
  max-height: calc(100% - 10px);
  min-height: 1px;
}

[data-clip-set-box="h"] [data-clip-set]::after{
  right: 0;
  bottom: -4px;
}

[data-clip-set-box="h"] [data-clip-set]::before{
  right: 0;
  bottom: 6px;
}

[data-clip-set]{
  border-style: solid;
  border-color: var(--boxBod);
}

[data-clip-set]::after{
  content: '';
  position: absolute;
  width: 8px;
  height: 8px;
  background: var(--themeColor);
  border-radius: 4px;
}

[data-clip-set]::-webkit-resizer{
  display: none;
}

[data-clip-set]::before{
  content: attr(data-clip-set);
  position: absolute;
  width: 8px;
  height: 8px;
  font-size: 8px;
}

/*模块类--*/

/*--纹理类*/
.tex-dot{
  --dot-wh: 1px;
  --dot-gap: 10px;
  background: 
  repeating-radial-gradient(
    circle at center,
    var(--dot-col) 0,
    var(--dot-col) var(--dot-wh),
    transparent var(--dot-wh),
    transparent calc(var(--dot-gap)*2)), var(--boxBak);
  background-size: var(--dot-gap) var(--dot-gap);
}

.tex-line{
  --line-col: rgba(0, 0, 0, 0.8);
  --line-size: 50px;
  --line-bod: 4%;
  --line-deg: -45deg;
  --line-bak: transparent;
  background: 
  repeating-linear-gradient(var(--line-deg),
    var(--line-col) -20%,
    var(--line-col) calc(-20% + var(--line-bod)),
    transparent calc(-20% + var(--line-bod)),
    transparent 30%,
    var(--line-col) 30%,
    var(--line-col) calc(30% + var(--line-bod)),
    transparent calc(30% + var(--line-bod)),
    transparent 80%,
    var(--line-col) 80%,
    var(--line-col) calc(80% + var(--line-bod)),
    transparent calc(80% + var(--line-bod)),
    transparent 100%
    ) 0 0/var(--line-size) var(--line-size),var(--line-bak);
    --pos-x: var(--line-size);
    --pos-y: 0;
    animation: posMove 2s infinite;
    animation-delay: 1s;
}

* .tex-line  {
  --pos-x: var(--line-size);
  --pos-y: 0;
  animation: posMove 2s infinite;
  animation-delay: 1s;
}

@keyframes posMove {
  to {
    background-position: var(--pos-x) var(--pos-y);
  }
}
/*纹理类--*/

@keyframes loadRo2 {/*旋转*/
  0%{
    transform: rotate(0deg) scale(1.1);
  }
  100%{
    transform: rotate(-180deg) scale(1.1);
  }
}

@media (max-width:469px) {
  [data-any="vw470"]{
    display: none;
  }
  [data-clip-view] {
    height: 250px;
  }
}

@media (min-width:470px) {
  [data-transform-center-module]{
    max-width: 72px;
  }
  
}

@media (max-width:460px) {
  [data-language="En"] [data-skillType-name]{
    max-width: 50px;
  }
}

@media (min-width:420px) {
  [data-mainset-bottom]{
    display: flex;
  }

  [data-mainset-side]{
    display: none;
  }

}

@media (max-width:359px) {
  #upload-textarea-box{
    width: 100%;
    flex: 0 0 auto;
  }
  [data-language="Zh"] [data-skillType-name]{
    max-width: 5ch;
  }
  .file-tag{
    max-width: 200px;
  }
  [data-any="vw360"]{
    display: none;
  }
}

@media (min-width:360px) {
  #upload-set-box{
    width: 40px;
  }
  #upload-set-main{
    width: 40px;
    height: calc(100% - 40px);
    flex-flow: column;
  }
  #upload-set-main [data-tips-x="left"]::after,
  #upload-set-main [data-tips-x="center"]::after {
    --x: calc(-100% + 40px);
  }

  [data-radio]{
    padding: 0.5ch;
  }
}
@media (max-width:299px) {
  [data-any="vw300"]{
    display: none;
  }
  [data-tips]::after, btn-info{
    display: none;
  }
  
}

@media (max-width:300px) {
  [data-transform-center-module]{
    max-width: 72px;
  }
  [data-clip-view] {
    height: 160px;
  }
}

@media (min-width:300px) {
  [data-skillType-box]{
    height: 80px;
  }
  [data-radio-main="true"] [data-tablestyle-name]{
    display: block;
  }
}

@media (max-width:239px) {
  [data-any="vw240"]{
    display: none;
  }

  [data-mainset-top]{
    display: flex;
  }

  [data-skill-sec]{
    min-width: 160px;
  }

  [data-skill-more]{
    flex-wrap: wrap;
  }

}

</style> 
</head>

<body class="noselect df-ffc df-cc">
  <!--顶部-->
  <div id="top" class="w100 df-sc">
    <div data-any="vw240" class="fl0" style="width: var(--top-h); height: var(--top-h);"></div>
    <!--公告栏-->
    <div data-tv-box data-any="vw240"  class="df-lc">
      <div data-tv-cut class="TV df-lc" >
        <div data-tv="true" class="df-lc" style="--tv-w: -29ch; --tv-s: 37s;">
          <div data-tv-text data-en-text="💬NOTICE:Please note the following">💬公告:公告内容公告内容公告内容</div>  
        </div>  
      </div> 
    </div>
    <div data-mainset-top class="df-lc" style="gap: 4px; margin-left: 2px;">
      <div id="btn-theme-3">
        <input id="theme-3" data-theme-check type="checkbox" checked="true">
        <label for="theme-3" class="btn-theme" style="position: relative;">
          <btn-theme></btn-theme>
        </label>
      </div>
      <input id="language-3" data-language-check type="checkbox" checked="true"/>
      <label for="language-3" class="switch pos-a" style="--swi-h:18px; --swi-r:6px; --swi-af:var(--mainColor);">
        <div class="pos-a" data-swi-icon style="top:3px; left: 2px; width: 11px; height: 11px; z-index: 2;">
          <svg style="margin: auto 1px;" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 22 22">
            <path fill="var(--boxBod)" d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2"></path>
          </svg>
        </div>
      </label>
    </div>
    <div class="df-cc" style="gap:4px; margin-right: 2%; font-size: 12px;">
      <input id="big" type="checkbox">
      <label for="big" class="btn-big df-cc">
        <btn-show></btn-show>
      </label>
    </div>
  </div>
  <!--全局tips-->
  <div id="tips-all">
    <div id="tips-all-text" class="tips-all-text" ></div>
  </div>
  <!--弹窗-->
  <div data-dailog data-close-id="dailog" class="pos-a df-ffc df-cc">
    <!--关闭-->
    <div data-dailog-close class="df-rc">
      <div data-close="close" data-close-for="dailog">
        <btn-close></btn-close>
      </div>
    </div>
    <div data-dailog-box class="ovy scrollbar df-ffc">
      <!--生成内容-->
    </div>
    
  </div>
  <!--侧边栏-->
  <div data-side data-any="vw240" class="df pos-a" style="top: 0; left: 0; --fill: var(--mainColor)">
    <div data-side-mix class="df-ffc" style="height: calc(100vh - 20px)">
      <div class="h100 df-ffc" style="justify-content: space-between;">
        <div ></div>
        <a class="df-cc" data-btn="help">
          <div data-en-text="HELP DOC">帮助文档</div>
          <div style="width:20px; height:20px; --arrow-w:2; transform:translate(2px,1px) rotate(-45deg);">
            <svg width="100%" height="100%" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.71411 11.3821H20.7141" stroke="#000" stroke-width="var(--arrow-w)" stroke-linecap="round"></path>
              <path d="M13.3421 4.38208L20.7141 11.3821L13.3421 18.3821" stroke="#000" stroke-width="var(--arrow-w)"></path>
            </svg>
          </div>
        </a>
      </div>
      <div data-mainset-side-box class="df-sc">
        <a href="https://www.ynyuset.cn" target="_blank" class="df-lc"
        data-tips="set" data-tips-y="top" data-tips-x="left" 
        style="--tips-gap: -16px; --tips-text: '🔗https://www.ynyuset.cn'; --tips-text-en: 'https://www.ynyuset.cn';
        gap: 2px; color: var(--mainColor); font-size: 10px; flex: 1;">
          ©2024-2025 
          <set-en data-any="en" class="fl0" style="height: 20px; margin-top: -2px;"></set-en>
          <set-zh data-any="zh" class="fl0" style="height: 20px; margin-top: -3px;"></set-zh>
        </a>
        <div data-mainset-side class="df-lc" style="gap: 4px;">
          <div id="btn-theme-1">
            <input id="theme-1" data-theme-check type="checkbox" checked="true">
            <label for="theme-1" class="btn-theme" style="position: relative;">
              <btn-theme></btn-theme>
            </label>
          </div>
          <input id="language-1" data-language-check type="checkbox" checked="true"/>
          <label for="language-1" class="switch pos-a" style="--swi-h:18px; --swi-r:6px; --swi-af:var(--mainColor);">
            <div class="pos-a" data-swi-icon style="top:3px; left: 2px; width: 11px; height: 11px; z-index: 2;">
              <svg style="margin: auto 1px;" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 22 22">
                <path fill="var(--boxBod)" d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2"></path>
              </svg>
            </div>
          </label>
        </div>
      </div>
    </div>
    
    <div class="df-cc" style="width: var(--top-h); height: var(--top-h); background: var(--boxGry);">
      <input id="btn-more" type="checkbox" />
      <label for="btn-more" class="btn-more" >
        <svg data-icon-more width="100%" height="100%" viewBox="0 0 20 20">
          <g data-icon-more-path="1" >
            <path fill="none" d="M18 0L0 0"></path>
          </g>
          <g data-icon-more-path="2">
            <path fill="none" d="M18 0L0 0"></path>
          </g>
          <g data-icon-more-path="3">
            <path fill="none" d="M18 0L0 0"></path>
          </g>
        </svg>
      </label>
    </div>
  </div>
  <!--侧边栏遮罩-->
  <div data-side-mask class="wh100 pos-a" style="display: none;  z-index: 10">
    <div class="wh100" style="background: rgba(0,0,0,0.3); backdrop-filter: blur(2px);"></div>
  </div>
  
  <!--功能页面-->
  <div class="df-ffc w100 df-cc">
    <div data-page-id="page" class="df-ffc w100" data-tab-pick="create">
      <div data-page-name="创建" data-page-name-en="create" data-page-main="true" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: flex;">
        <div class="w100 df-ffc ovy noscrollbar" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
          <div class="w100 df-ffc" style="align-items: center;">
            <!--步骤1-->
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>▼&nbsp;</span>
              <span data-en-text="Upload | Drop | Input" >上传 | 拖拽 | 输入</span>
              &nbsp;&nbsp;
              <span data-any="vw300" data-en-text="data to create node in batches" style="opacity: 0.6;"> 数据以批量创建内容</span>
              <div data-any="vw300" data-help="create" class="fl0 df-cc">?</div>
            </div>
            <!--上传文件-->
            <div data-drop="upload" class="w100 df-ffc df-cc bod-d">
              <div class="w100 df-cc">
                <div data-file-info class="file-tag" data-en-text="📁 No files there">📁 未选择任何文件</div>
              </div>
              <div data-mode-id="upload" class="df-cc">
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-img" type="file" accept=".jpg,.jpeg,.jfif,.webp,.png,.apng,.gif" style="display: none;" multiple/>
                  <label for="input-user-img" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text: '可上传1~10张大图, 支持常见图片格式'; --tips-text-en: 'Upload 1~10 large images (common formats)';" >
                    <btn-user-img  data-btn="icon" ></btn-user-img>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Cut large image">大图自动切片</div>
                </div>
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-table" type="file" accept=".csv,.xls,.xlsx"  style="display: none;"/>
                  <label for="input-user-table" data-tips="auto" data-tips-y="top" data-tips-x="center"
                  style="--tips-text: '上传单个表格, 需按一定格式填写'; --tips-text-en: 'Upload 1 table in the prescribed format';" >
                    <btn-user-table data-btn="icon"></btn-user-table>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Table to frame">表格创建画板</div>
                </div>
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-zy" type="file" accept=".zy,.sketch,.svg,.xml,.json,.zip,.rar,.7z" style="display: none;"/>
                  <label for="input-user-zy" data-tips="auto" data-tips-y="top" data-tips-x="right"
                  style="--tips-text: '上传由云即系列插件生成的图层信息文件'; --tips-text-en: 'Upload .zy (by YN+) or other compatible file';" >
                    <btn-user-zy data-btn="icon"></btn-user-zy>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Layers frome .zy">兼容格式导入</div>
                </div>
              </div>
            </div>
            <!--输入参数-->
            <div class="w100 df" style="flex-wrap: wrap; max-width: 560px; margin: 4px 0; gap: 4px;">
              <div id="upload-textarea-box" data-resize class="pos-r fl1" style="min-width: 180px;">
                <textarea spellcheck="false" id="upload-textarea" data-textarea="eg" 
                data-eg="name\tw\th\nkv\t1920\t1080\nbanner\t1200\t300\nload\t1080\t1640\nicon\t256\t256"
                data-eg-en="name\tw\th\nkv\t1920\t1080\nbanner\t1200\t300\nload\t1080\t1640\nicon\t256\t256"
                onfocus="
                let btn = this.parentNode.parentNode.querySelector('btn-re');
                btn.style.animation = 'loadRo2 2s linear infinite';
                btn.parentNode.style.borderColor = 'var(--mainColor)';
                "
                onblur="
                let btn = this.parentNode.parentNode.querySelector('btn-re');
                btn.style.animation = '';
                btn.parentNode.style.borderColor = 'var(--boxBod)';
                "></textarea>
                <!--清空-->
                <div class="pos-a" data-close="clear" style="right: 4px; top:4px; width: 12px; height: 12px;">
                  <btn-close></btn-close>
                </div>
                <div data-textarea="tips" class="pos-a w100 df-ffc" style="white-space: wrap; gap: 4px; font-size: 10px; color: var(--boxBod); bottom: 0; padding: 10px; box-sizing: border-box; animation: boxUp 0.5s; pointer-events: none;">
                  <li data-li-style="2" data-en-text="Double click fill sample" >双击填充示例</li>
                  <li data-li-style="2" data-en-text="Copy from a sheet or manually input with tab character(key)" >从表格复制或用制表符（tab键）手动输入</li>
                  <li data-li-style="2" data-en-text="Table header must with: name | w | h (optional: s | type | add | node)" >表头固定用：name,w,h,(可选：s,type,add,node), 无顺序要求</li>
                </div>
              </div>
              <div id="upload-set-box" class="df" style="flex-wrap: wrap; max-width: 560px; margin:0 0 4px 0; gap: 4px;">
                <div id="upload-set-main" class="df">
                  <div id="upload-set-1" data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text:'转为标签/大纲';  --tips-text-en:'Convert to tags/catalogue';">
                    <btn-re class="df-cc wh100"></btn-re>                   
                  </div>
                  <div id="upload-set-2" data-selects-must data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text:'从所选对象获取数据';  --tips-text-en:'Retrieve data from the selected node';">
                    <btn-getbyselect></btn-getbyselect>                   
                  </div>
                  <a href="https://www.ynyuset.cn/tool_web/ListEase/" target="_blank" id="upload-set-3" data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="center"
                  style=" --tips-text:'前往制作更复杂的模板数据';  --tips-text-en:'To create more complex template data';">
                    <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle fill="var(--mainColor)" cx="3" cy="4" r="2"/>
                      <path stroke="var(--mainColor)" d="M3 5V10H9"/>
                      <path stroke="var(--mainColor)" d="M3 4H9"/>
                      <path stroke="var(--mainColor)" d="M3 5V16H9"/>
                      <rect fill="var(--mainColor)" x="7" y="8" width="12" height="4" rx="2"/>
                      <rect fill="var(--mainColor)" x="7" y="2" width="12" height="4" rx="2"/>
                      <rect fill="var(--mainColor)" x="7" y="14" width="12" height="4" rx="2"/>
                    </svg>                                       
                  </a>
                </div>
                <input id="upload-moreset" type="checkbox" checked onchange="showNext(this,this.parentNode.parentNode.nextElementSibling,'flex',true)">
                <label for="upload-moreset" class="btn-moreset" data-tips="auto" data-tips-y="top" data-tips-x="right"
                style="--tips-text:'高级设置';  --tips-text-en:'Advanced setting'; --xx: 40px;">
                  <btn-set></btn-set>
                </label>
              </div>
            </div>
            <!--更多设置-->
            <div id="upload-moreset-box" class="w100 df-lc" style="flex-wrap: wrap; max-width: 560px; gap: 4px; display: none;">
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 180px;">
                <div data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch; 
                  --tips-text:'修改生效列, 用于剔除数据';  --tips-text-en:'Select columns to take effect'; width: 20px; height: 20px;">
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path stroke="var(--mainColor)" fill="var(--mainColor)" d="M1.40967 3.66602C1.40967 2.56145 2.3051 1.66602 3.40967 1.66602H7.40967V6.59054H1.40967V3.66602Z"/>
                    <rect stroke="var(--mainColor)" x="1.40967" y="7.13843" width="5.63721" height="5.5603" />
                    <path stroke="var(--mainColor)" d="M1.40967 12.6987H7.04688V18.2185H3.40967C2.3051 18.2185 1.40967 17.3231 1.40967 16.2185V12.6987Z"/>
                    <path stroke="var(--mainColor)" fill="var(--mainColor)" d="M9.86572 2.19995H17C18.1046 2.19995 19 3.09538 19 4.19995V7.36918H9.86572V2.19995Z"/>
                    <rect stroke="var(--mainColor)" x="9.86572" y="7.36914" width="9.13428" height="5.7478"/>
                    <path stroke="var(--mainColor)" d="M9.86572 13.1169H19V17.0002C19 18.1048 18.1046 19.0002 17 19.0002H9.86572V13.1169Z"/>
                  </svg>
                </div>
                <input id="input-user-table-title" data-input class="nobod fl1" type="text" 
                placeholder="name,w,h,s,type,add,node" 
                value="name,w,h,s,type,add,node"
                data-input-must="name,w,h" data-input-type="text"> 
                <!--重置-->
                <div data-input-reset data-btn="reset">
                  <btn-reset></btn-reset>
                </div>  
              </div>
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 180px;">
                <div data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch; 
                  --tips-text:'画板命名后缀, 自定义格式或选择预设';  --tips-text-en:'Frame naming suffix,input or select a preset'; width: 20px; height: 20px;">
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect fill="var(--mainColor)" x="16" y="4" width="4" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" y="4" width="8.5" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" y="16" width="20" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" x="18" y="4" width="17" height="2" rx="1" transform="rotate(90 18 4)"/>
                    <rect fill="var(--mainColor)" x="4" y="2" width="20" height="2" rx="1" transform="rotate(90 4 2)"/>
                    <path fill="var(--mainColor)" d="M6.97137 16.0954C6.62768 16.3986 6.09115 16.1182 6.14391 15.6629L6.71709 10.717L10.7051 12.8016L6.97137 16.0954Z"/>
                    <path fill="var(--mainColor)" d="M11.3154 11.5259L7.35709 9.45685L11.5784 1.38079C11.8343 0.891339 12.4385 0.701954 12.9279 0.957792L15.1138 2.10035C15.6032 2.35618 15.7926 2.96036 15.5368 3.44982L11.3154 11.5259Z"/>
                  </svg>
                </div>
                <input id="input-framename" data-input class="nobod fl1" type="text" data-input-type="text" data-input-must="none" value=" w×h">  
                <div class="df-lc pos-r" data-select data-select-value=" w×h" style="gap: 4px; width: 90px; z-index:2;">
                  <input id="select-value-1" type="text" data-select-input readonly value=" w×h">
                  <input id="select-show-1" data-select-pick=" w×h" type="checkbox">
                  <label for="select-show-1" class="show-next wh100" style="position: absolute; top:0; right: 0;"></label>
                  <div data-select-options="" class="df-ffc pos-a w100 noscrollbar" style="white-space: wrap; display: none; top:24px;">
                    <div data-option="type" data-en-text="Basic">基础</div>
                    <div data-option="option" data-option-main="false" data-option-value="none">none</div>
                    <div data-option="option" data-option-main="true" data-option-value=" w×h">&nbsp;w×h</div>
                    <div data-option="option" data-option-main="false" data-option-value=" w_h">&nbsp;w_h</div>
                    <div data-option="type" data-en-text="Complex">复杂</div>
                    <div data-option="option" data-option-main="false" data-option-value=" w×h s">&nbsp;w×h s</div>
                    <div data-option="option" data-option-main="false" data-option-value=" w_h s">&nbsp;w_h s</div>
                    <div data-option="option" data-option-main="false" data-option-value="add w×h s">add w×h s</div>
                    <div data-option="option" data-option-main="false" data-option-value="add w_h s">add w_h s</div>
                  </div>
                </div>
              </div>
            </div>
            <div style="height: 4px;"></div>
            <!--步骤2-->
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>▼&nbsp;</span>
              <span data-en-text="Edit final tags/catalogue" > 编辑标签/大纲 </span>
                &nbsp;&nbsp;
                <span data-en-text="to create finally" data-any="vw240" style="opacity: 0.6;">以确认最终创建内容</span>
            </div>
            <div class="wh100 pos-r" data-resize style="max-width: 560px;">
              <div data-create-tags-box class="wh100 upload-set pos-r ovy noscrollbar">
                <div data-create-tags class="w100 df-lc">
                  <!--动态填充-->
                </div>
                <div data-create-catalogues class="w100 df-ffc">
                  <!--动态填充-->
                </div>
                <!--清空-->
                <div class="pos-a" style="right: 4px; top:4px; width: 12px; height: 12px;">
                  <btn-close></btn-close>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div data-create-any data-btn="main" class="df-cc" data-en-text="CREATER">创建</div>
      </div>
      <div data-page-name="导出" data-page-name-en="export" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="w100 df-ffc" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
        </div>
        <div data-btn="main" class="df-cc" data-en-text="EXPORT">导出</div>
      </div>
      <div data-page-name="编辑" data-page-name-en="editor" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="w100 df-ffc" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
        </div>
        <div data-btn="main" class="df-cc" data-en-text="APPLY">应用</div>
      </div>
      <div data-page-name="变量" data-page-name-en="variable" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        
      </div>
      <div data-page-name="表单" data-page-name-en="sheet" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="w100 df-ffc ovy noscrollbar" style="height: calc(100% - 20px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
          <div class="wh100 df-ffc" style="box-sizing: border-box; max-width: 560px;">
            <!--步骤1-->
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>▼&nbsp;</span>
              <span data-en-text="Get a basic table" >创建基础表格模板</span>
              &nbsp;&nbsp;
              <span data-any="vw300" data-en-text="and make it more diverse" style="opacity: 0.6;">并进一步定制化设计</span>
              <div data-any="vw300" data-help="sheet" class="fl0 df-cc">?</div>
            </div>
            <div data-tableset-thtd class="df-lc w100">
              <div class="df-lc" style="max-width: 100%; margin:0 auto; gap: 4px;">
                <div class="df-lc pos-r upload-set" style="gap:4px; max-width: calc(100% - 44px);">
                  <input id="chk-tablestyle" checked type="checkbox" >
                  <label for="chk-tablestyle" data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch;  width: 22px; height: 22px;
                  --tips-text:'按预设样式生成组件/修改表格';  --tips-text-en:'Create/change from the preset style';">
                    <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill="var(--mainColor)" d="M7.96875 7.57129H3V12.0713H6.61914L6.50391 13.0713H3V16.5713C3 17.1236 3.44772 17.5713 4 17.5713H9.5V15.4512L10.5 14.5693V17.5713H16C16.5523 17.5713 17 17.1236 17 16.5713V13.0713H12.1982L12.5205 12.7871L13.332 12.0713H17V7.57129H15.2656L17.5137 3.26758C17.8157 3.61783 17.9999 4.07254 18 4.57129V16.5713L17.9893 16.7754C17.887 17.7841 17.0357 18.5713 16 18.5713H4C2.96435 18.5713 2.113 17.7841 2.01074 16.7754L2 16.5713V4.57129C2.00016 3.46686 2.89553 2.57129 4 2.57129H10.583L7.96875 7.57129Z"/>
                      <path fill="var(--mainColor)" d="M11.8598 12.0372L8.12642 15.3311C7.78273 15.6343 7.24651 15.3537 7.29927 14.8985L7.87154 9.95317L11.8598 12.0372ZM12.7329 0.616255C12.9887 0.127036 13.5931 -0.0621097 14.0825 0.193403L16.269 1.33598C16.7583 1.59183 16.9475 2.19621 16.6919 2.68559L12.4702 10.7618L8.51216 8.69243L12.7329 0.616255Z"/>
                    </svg>                  
                  </label>
                  <div data-tablestyle-box class="df-lc" style="gap: 4px; overflow: auto;">
                    ▶
                    <div class="noscrollbar" data-scroll>
                      <div data-tablestyle-set class="df-lc" data-radio-value="1">
                        <div class="fl0 df-lc" data-radio data-radio-data="1" data-radio-main="true">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M18 16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16C17.1046 2 18 2.89543 18 4V16ZM3 14V16C3 16.5523 3.44772 17 4 17H16C16.5523 17 17 16.5523 17 16V14H3ZM3 10H17V7H3V10Z"/>
                            </svg>    
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="Space filling">间格区分色</div>         
                        </div>
                        <div class="fl0 df-lc" data-radio data-radio-data="2" data-radio-main="false">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M18 16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16C17.1046 2 18 2.89543 18 4V16ZM3 16C3 16.5523 3.44772 17 4 17H16C16.5523 17 17 16.5523 17 16V7H3V16Z"/>
                            </svg>
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="No strokes">无描边</div>         
                        </div>
                        <div class="fl0 df-lc" data-radio data-radio-data="3" data-radio-main="false">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M16 2C17.1046 2 18 2.89543 18 4V16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16ZM3 12.5V16C3 16.5523 3.44772 17 4 17H16C16.5523 17 17 16.5523 17 16V12.5H3ZM3 11.5H17V7H3V11.5Z"/>
                            </svg> 
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="Row strokes">仅横线</div>         
                        </div>
                        <div class="fl0 df-lc" data-radio data-radio-data="4" data-radio-main="false">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M16 2C17.1046 2 18 2.89543 18 4V16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16ZM10.5 17H16C16.5523 17 17 16.5523 17 16V12.5H10.5V17ZM3 16C3 16.5523 3.44772 17 4 17H9.5V12.5H3V16ZM10.5 11.5H17V7H10.5V11.5ZM3 11.5H9.5V7H3V11.5Z"/>
                            </svg>   
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="All strokes">全描边</div>         
                        </div>
                        <div class="fl0 df-lc" data-radio data-radio-data="5" data-radio-main="false">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M16 2C17.1046 2 18 2.89543 18 4V16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16ZM3 13V16C3 16.5523 3.44772 17 4 17H16C16.5523 17 17 16.5523 17 16V13H3ZM3 12H17V8H3V12ZM4 3C3.44772 3 3 3.44772 3 4V7H17V4C17 3.44772 16.5523 3 16 3H4Z"/>
                            </svg>   
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="Row strokes 2">仅横线 2</div>         
                        </div>
                        <div class="fl0 df-lc" data-radio data-radio-data="6" data-radio-main="false">
                          <div data-tablestyle-chk>
                            <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill="var(--mainColor)" d="M16 2C17.1046 2 18 2.89543 18 4V16L17.9893 16.2041C17.887 17.2128 17.0357 18 16 18H4C2.96435 18 2.113 17.2128 2.01074 16.2041L2 16V4C2 2.89543 2.89543 2 4 2H16ZM10.5 17H16C16.5523 17 17 16.5523 17 16V13H10.5V17ZM3 16C3 16.5523 3.44772 17 4 17H9.5V13H3V16ZM10.5 12H17V8H10.5V12ZM3 12H9.5V8H3V12ZM10.5 7H17V4C17 3.44772 16.5523 3 16 3H10.5V7ZM4 3C3.44772 3 3 3.44772 3 4V7H9.5V3H4Z"/>
                            </svg>  
                          </div>
                          <div data-any="vw360" data-tablestyle-name data-en-text="All strokes 2">全描边 2</div>         
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="df-lc pos-r upload-set" style="gap:4px; max-width: calc(100% - 44px);">
                  <input id="chk-selectcomp" type="checkbox" checked >
                  <label for="chk-selectcomp" data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="right" style="--tips-w: 8ch;  width: 22px; height: 22px;
                  --tips-text:'以所选对象为组件';  --tips-text-en:'Create from the selected node';">
                    <btn-getbyselect></btn-getbyselect>                  
                  </label>
                  <div data-selectcomp-box="false" class="df-lc" style="gap: 4px; display: none; overflow: auto;">
                    ▶
                    <div class="noscrollbar df-lc" data-scroll>
                      <div data-selectcomp-no style="padding: 0 10px;" data-en-text="Has not compliant components">未选中有效的组件</div>
                      <div data-selectcomp-mix class="df-lc" style="gap:4px">
                        <span data-any="vw240">
                          <span data-en-text="Header:">表头:</span>
                        </span>
                        <span data-selectcomp-1>none</span>
                        <div></div>
                        <div></div>
                        <span data-any="vw240">
                          <span data-en-text="Data:">数据:</span>
                        </span>
                        <span data-selectcomp-2>none</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div> 
            <div class="w100 df-cc" style="margin: 8px 0 4px 0; gap: 2px;">
              <div data-create-table class="w100 df-cc" data-btn="main2" data-en-text="Create Table">创建表格</div>  
              <div class="df-cc fl0" data-btn="main2" style="width: 22px; height: 22px; padding: 4px;">
                <input id="table-more" type="checkbox" onchange="showNext(this,'data-tableset-more','flex')">
                <label for="table-more" class="btn-more">
                  <svg data-icon-more width="100%" height="100%" viewBox="0 0 20 20">
                    <g data-icon-more-path="1">
                      <path fill="none" d="M18 0L0 0"></path>
                    </g>
                    <g data-icon-more-path="2">
                      <path fill="none" d="M18 0L0 0"></path>
                    </g>
                    <g data-icon-more-path="3">
                      <path fill="none" d="M18 0L0 0"></path>
                    </g>
                  </svg>
                </label>
              </div>
            </div>
            <div class="df-ffc" data-tableset-more data-skill-sec style="gap: 4px; margin: 4px 0; display: none;">
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Only Create @th/td">仅创建组件</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Make Compliant">合规化组件</div>
              </div>
              <div class="w100 df-cc">
                <span data-skill-gap>
                  <span>---</span>
                  <span data-en-text="To xxx@table elements"> 基于xxx@table元素</span>
                  <span>---</span>
                </span>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-lc w100" style="gap: 4px;">
                  <div class="df-lc fl1">
                    <input id="table-column-num" type="text" value="0" data-input="" data-input-type="int" data-input-must="0,1000" style="text-align: center;">
                    <div class="df-cc" data-input-unit="auto" data-en-text=" C ">列</div>
                  </div>
                  <div class="df-lc fl1" >
                    <input id="table-row-num" type="text" value="0" data-input="" data-input-type="int" data-input-must="0,1000" style="text-align: center;">
                    <div class="df-cc" data-input-unit="auto" data-en-text=" R ">行</div>
                  </div>
                </div>
                <div class="df-lc w100" >
                  <div class="df-cc" style="border-radius: 10px 0 0 10px;" data-btn="skill-main" data-en-text="Add C/R">增加行列</div>
                  <div class="df-cc" style="border-left: 0; border-radius:0 10px 10px 0;" data-btn="skill-main" data-en-text="Reduce C/R">减少行列</div>
                </div>
                
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Apply Preset Style">应用样式</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Row Column Swap">反转行列</div>
              </div>
              <div class="w100 df-cc">
                <span data-skill-gap>
                  <span>---</span>
                  <span data-en-text="To xxx@th/td elements"> 基于xxx@th/td元素</span>
                  <span>---</span>
                </span>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Select a Row">选中单行</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Select many Rows ">选中多行</div>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Select Block">区域选中</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Select Inline">连续选中</div>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Pseudo Merge">伪合并表格</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Select Inline">连续选中</div>
              </div>
            </div>
            <div style="height: 4px;"></div>
            <!--步骤2-->
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>▼&nbsp;</span>
              <span data-en-text="Control component properties by sheet" >用表格数据批量+参数化控制组件</span>
            </div>
            <div class="w100 df" style="max-width: 560px;">
              <div id="upload-tablearea-box" data-resize class="pos-r fl1">
                <textarea spellcheck="false" id="upload-tablearea" data-textarea="eg"  style=" min-height: 160px;" 
                data-eg="A1\tB1\tC1\na2\tb2\tc2\na3\tb3\tc3\na4\tb4\tc4"
                data-eg-en="A1\tB1\tC1\na2\tb2\tc2\na3\tb3\tc3\na4\tb4\tc4"
                ></textarea>
                <!--清空-->
                <div class="pos-a" data-close="clear" style="right: 4px; top:4px; width: 12px; height: 12px;">
                  <btn-close></btn-close>
                </div>
                <div data-textarea="tips" class="pos-a w100 df-ffc" style="white-space: wrap; gap: 4px; font-size: 10px; color: var(--boxBod); bottom: 0; padding: 10px; box-sizing: border-box; animation: boxUp 0.5s; pointer-events: none;">
                  <li data-li-style="2" data-en-text="Double click fill sample" >双击填充示例</li>
                  <li data-li-style="2" data-en-text="Copy from a sheet or manually input with tab character(key)" >从表格复制或用制表符（tab键）手动输入</li>
                  <li data-li-style="2" data-en-text="Only fill-table-data without table header" >表格填充无需表头, 批量组件属性/标签属性映射需要表头</li>
                </div>
              </div>
            </div>
            <!--更多设置-->
            <div data-tablearea-moreset class="w100 df-lc" style="flex-wrap: wrap; max-width: 560px; gap: 4px; margin: 4px 0;">
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 120px;">
                <div data-tips="auto" class="fl0 df-cc" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch; 
                  --tips-text:'设置换行转义符, 用于兼容需要换行的数据';  --tips-text-en:'Set a character to represent line feed'; width: 20px; height: 20px;">
                  <svg width="120%" height="120%" viewBox="0 0 20 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-width="0.25" stroke="var(--mainColor)" fill="var(--mainColor)" d="M15.0417 9.94629C15.0416 11.6031 13.6985 12.9462 12.0417 12.9463H8.29461V13.999C8.29455 14.4246 7.79631 14.6557 7.47137 14.3809L4.57976 11.9346C4.10782 11.5352 4.10788 10.8067 4.57976 10.4072L7.47137 7.96094C7.79633 7.68597 8.29461 7.91709 8.29461 8.34277V9.39551H11.4909V5.13379H15.0417V9.94629Z"/>
                    <rect stroke="var(--mainColor)" x="2" y="2" width="16" height="16" rx="2"/>
                    <rect fill="var(--mainColor)" x="2" y="21" width="16" height="2" rx="1"/>
                  </svg>       
                </div>
                <input id="input-linefeed" data-input class="nobod fl1" type="text" 
                placeholder="[enter]" 
                value="[enter]"> 
                <!--重置-->
                <div data-input-reset data-btn="reset">
                  <btn-reset></btn-reset>
                </div>  
              </div>
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 120px;">
                <div data-tips="auto" class="fl0 df-cc" data-tips-y="top" data-tips-x="center" style="--tips-w: 8ch; 
                  --tips-text:'设置空数据占位符, 可避免潜在的错误';  --tips-text-en:'Set a character to replace null data'; width: 20px; height: 20px;">
                  <svg width="120%" height="120%" viewBox="0 0 20 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-width="0.25" stroke="var(--mainColor)" fill="var(--mainColor)" d="M14.4007 5.40071C15.0952 6.09516 15.0952 7.22121 14.4007 7.91564L12.5149 9.80149L14.4007 11.6873C15.0951 12.3817 15.0951 13.5078 14.4007 14.2023C13.7063 14.8967 12.5803 14.8967 11.8858 14.2023L9.99997 12.3164L8.11413 14.2023C7.41969 14.8967 6.29365 14.8967 5.5992 14.2023C4.90476 13.5078 4.90476 12.3818 5.5992 11.6873L7.48505 9.80149L5.5992 7.91564C4.90476 7.2212 4.90476 6.09516 5.5992 5.40071C6.29366 4.70641 7.41973 4.70632 8.11413 5.40071L9.99997 7.28656L11.8858 5.40071C12.5803 4.70627 13.7063 4.70627 14.4007 5.40071Z"/>
                    <rect stroke="var(--mainColor)" x="2" y="2" width="16" height="16" rx="2"/>
                    <rect fill="var(--mainColor)" x="2" y="21" width="16" height="2" rx="1"/>
                  </svg>       
                </div>
                <input id="input-nulldata" data-input class="nobod fl1" type="text"
                placeholder="--" 
                value="--">  
                <!--重置-->
                <div data-input-reset data-btn="reset">
                  <btn-reset></btn-reset>
                </div> 
              </div>
            </div>
            <div class="df-ffc" data-tableset-more data-skill-sec style="gap: 4px; margin: 4px 0;">
              <div class="df-lc w100" data-skill-more style="flex-wrap: wrap; text-wrap: nowrap; font-size: 10px; gap: 4px; margin-bottom: 4px;">
                <div class="fl1 df-lc" style=" gap: 4px; min-width: 160px;">
                  <div class="df ovh noscrollbar" data-scroll data-en-text="· Clone instance by data quantity">· 数据数量&gt;实例数量时, 复制最末实列</div>
                  <div style="width: 1%;"></div>
                  <div class="df-rc" style="min-width: 36px;">
                    <input id="switch-autoclone" type="checkbox" checked="true">
                    <label for="switch-autoclone" class="switch" style="--swi-h: 16px"></label>
                  </div>
                </div>
                <div class="fl1 df-lc" style="gap: 4px; min-width: 160px;">
                  <div class="df ovh noscrollbar" data-scroll data-en-text="· Reduce instance by data quantity">· 数据数量&lt;实例数量时, 从最末实列开始删减</div>
                  <div style="width: 1%;"></div>
                  <div class="df-rc" style="min-width: 36px;">
                    <input id="switch-autoreduce" type="checkbox" checked="true">
                    <label for="switch-autoreduce" class="switch" style="--swi-h: 16px"></label>
                  </div>
                </div>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Mapping Names">图层命名映射</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Mapping Datas">表格数据映射</div>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Mapping Properties">组件属性映射</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Mapping Tags">标签属性映射</div>
              </div>
              <div class="w100 df-cc">
                <span data-skill-gap>
                  <span>---</span>
                  <span data-en-text="Get datas from selection">从所选图层返回数据</span>
                  <span>---</span>
                </span>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Get Names">获取图层命名</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Get Datas">获取表格数据</div>
              </div>
              <div class="df-lc w100" data-skill-more data-selects-must>
                <div class="df-cc" data-btn="skill-main" data-en-text="Get Properties">获取组件属性</div>
                <div class="df-cc" data-btn="skill-main" data-en-text="Get Tags">获取标签属性</div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <div data-page-name="更多功能" data-page-name-en="more tools" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="wh100 df-ffc" style="align-items: center; padding: 10px; box-sizing: border-box;">
          <!--功能tags-->
          <div class="w100 fl0 noscrollbar df" data-scroll>
            <div data-skilltype-box class="df-lc fl0" data-radio-value="1" >
              <div data-radio data-radio-data="1" data-radio-main="true" class="df-ffc df-cc" style="gap: 4px;">
                <div data-skilltype-icon>
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--mainColor)" d="M9.10133 5.24013C9.4668 4.4921 10.5329 4.4921 10.8983 5.24013L11.9152 7.32142L14.2089 7.64537C15.0332 7.76179 15.3626 8.77567 14.7642 9.3544L13.099 10.9647L13.4996 13.2462C13.6437 14.0661 12.7812 14.6928 12.0458 14.3024L9.99983 13.2163L7.95381 14.3024C7.21847 14.6928 6.35601 14.0661 6.50002 13.2462L6.9007 10.9647L5.23551 9.3544C4.63703 8.77567 4.96646 7.76179 5.79081 7.64537L8.08446 7.32142L9.10133 5.24013Z"/>
                    <rect stroke="var(--mainColor)" x="2.5" y="2.5" width="15" height="15" rx="2"/>
                  </svg>           
                </div>
                <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Useful & Starts" >
                  常用功能
                </div>
              </div>
              <div data-radio data-radio-data="2" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
                <div data-skilltype-icon>
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--mainColor)" d="M7 7H2V2H7V7ZM3 3V6H6V3H3Z"/>
                    <rect fill="var(--mainColor)" x="6" y="4" width="6" height="1" rx="0.5"/>
                    <rect fill="var(--mainColor)" x="4" y="6" width="1" height="6" rx="0.5"/>
                    <path fill="var(--mainColor)" d="M3 15C3 14.4477 3.44772 14 4 14H6C6.55228 14 7 14.4477 7 15V17C7 17.5523 6.55228 18 6 18H4C3.44772 18 3 17.5523 3 17V15Z"/>
                    <path fill="var(--mainColor)" d="M8.5 15C8.5 14.4477 8.94772 14 9.5 14H11.5C12.0523 14 12.5 14.4477 12.5 15V17C12.5 17.5523 12.0523 18 11.5 18H9.5C8.94772 18 8.5 17.5523 8.5 17V15Z"/>
                    <path fill="var(--mainColor)" d="M8.5 9.5C8.5 8.94772 8.94772 8.5 9.5 8.5H11.5C12.0523 8.5 12.5 8.94772 12.5 9.5V11.5C12.5 12.0523 12.0523 12.5 11.5 12.5H9.5C8.94772 12.5 8.5 12.0523 8.5 11.5V9.5Z"/>
                    <rect fill="var(--mainColor)" x="14" y="14" width="4" height="4" rx="1"/>
                    <path fill="var(--mainColor)" d="M14 9.5C14 8.94772 14.4477 8.5 15 8.5H17C17.5523 8.5 18 8.94772 18 9.5V11.5C18 12.0523 17.5523 12.5 17 12.5H15C14.4477 12.5 14 12.0523 14 11.5V9.5Z"/>
                    <path fill="var(--mainColor)" d="M14 4C14 3.44772 14.4477 3 15 3H17C17.5523 3 18 3.44772 18 4V6C18 6.55228 17.5523 7 17 7H15C14.4477 7 14 6.55228 14 6V4Z"/>
                  </svg>              
                </div>
                <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Pixel & Transform" >
                  像素&变换
                </div>
              </div>
              <div data-radio data-radio-data="3" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
                <div data-skilltype-icon>
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--mainColor)" d="M9 2L8.99992 4.81319H8.02803L7.94126 3.8956H6.19353L6.19361 8.41026L7.13657 8.5641V10H3.66841V8.5641L4.73222 8.41026L4.73214 3.8956H3.05867L2.97767 4.81319H2L2.00008 2H9Z"/>
                    <path fill="var(--mainColor)" d="M2 13C2 11.8954 2.89543 11 4 11H8C9.10457 11 10 11.8954 10 13V17C10 18.1046 9.10457 19 8 19H4C2.89543 19 2 18.1046 2 17V13Z"/>
                    <path fill="var(--mainColor)" d="M11.7126 4.04181C11.8915 3.86285 12.1817 3.86285 12.3607 4.04181L13.7493 5.43044C13.9282 5.6094 13.9282 5.89954 13.7493 6.0785L12.3607 7.46713C12.1817 7.64609 11.8915 7.64609 11.7126 7.46713L10.324 6.0785C10.145 5.89954 10.145 5.6094 10.324 5.43044L11.7126 4.04181Z"/>
                    <path fill="var(--mainColor)" d="M14.2585 1.49591C14.4374 1.31695 14.7276 1.31695 14.9066 1.49591L16.2952 2.88454C16.4741 3.0635 16.4741 3.35365 16.2952 3.5326L14.9066 4.92124C14.7276 5.10019 14.4374 5.10019 14.2585 4.92123L12.8699 3.5326C12.6909 3.35365 12.6909 3.0635 12.8699 2.88454L14.2585 1.49591Z"/>
                    <rect fill="var(--mainColor)" x="14.5825" y="6.26343" width="2.88032" height="2.88032" rx="0.458252" transform="rotate(45 14.5825 6.26343)"/>
                    <path fill="var(--mainColor)" d="M16.8044 4.04181C16.9833 3.86285 17.2735 3.86285 17.4525 4.04181L18.8411 5.43044C19.02 5.6094 19.02 5.89954 18.8411 6.0785L17.4525 7.46713C17.2735 7.64609 16.9833 7.64609 16.8044 7.46713L15.4158 6.0785C15.2368 5.89954 15.2368 5.6094 15.4158 5.43044L16.8044 4.04181Z"/>
                    <path stroke="var(--mainColor)"  stroke-linecap="round" stroke-dasharray="2 2" d="M11.5 13.5C11.5 12.3954 12.3954 11.5 13.5 11.5H16.5C17.6046 11.5 18.5 12.3954 18.5 13.5V16.5C18.5 17.6046 17.6046 18.5 16.5 18.5H13.5C12.3954 18.5 11.5 17.6046 11.5 16.5V13.5Z"/>
                  </svg>                                   
                </div>
                <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Text & Layer" >
                  文本&图层
                </div>
              </div>
              <div data-radio data-radio-data="4" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
                <div data-skilltype-icon>
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--mainColor)" d="M12.5 7H7.5V2H12.5V7ZM8.5 3V6H11.5V3H8.5Z"/>
                    <rect fill="var(--mainColor)" x="1" y="3" width="3" height="3"/>
                    <rect fill="var(--mainColor)" x="16" y="3" width="3" height="3"/>
                    <rect fill="var(--mainColor)" x="12" y="4" width="4" height="1"/>
                    <rect fill="var(--mainColor)" x="4" y="4" width="4" height="1"/>
                    <path stroke="var(--mainColor)" stroke-linecap="round" d="M17 10C17 7.59975 15.0191 5.57184 12 5M3 10C3 7.58397 4.95063 5.55643 8 5"/>
                    <circle stroke="var(--mainColor)" cx="8.5" cy="10.5" r="1.5"/>
                    <path fill="var(--mainColor)" d="M4.63324 12.8363L4.94986 12.4494L4.94986 12.4494L4.63324 12.8363ZM11.1597 13.6771L11.4886 14.0537L11.5013 14.0426L11.5132 14.0307L11.1597 13.6771ZM12.5 13.6103L12.8271 13.2319L12.8166 13.2233L12.5 13.6103ZM17.5 13.5731C17.5 13.2969 17.2761 13.0731 17 13.0731C16.7239 13.0731 16.5 13.2969 16.5 13.5731H17.5ZM16.5 12C16.5 12.2761 16.7239 12.5 17 12.5C17.2761 12.5 17.5 12.2761 17.5 12H16.5ZM17.5 11.5C17.5 11.2239 17.2761 11 17 11C16.7239 11 16.5 11.2239 16.5 11.5H17.5ZM7.19138 14.9294L6.87476 15.3163L7.19138 14.9294ZM4.63324 12.8363L4.31662 13.2233L6.87476 15.3163L7.19138 14.9294L7.508 14.5424L4.94986 12.4494L4.63324 12.8363ZM9.77349 14.8878L10.1024 15.2644L11.4886 14.0537L11.1597 13.6771L10.8307 13.3006L9.44458 14.5112L9.77349 14.8878ZM12.5 13.6103L12.173 13.9886L16.673 17.8783L17 17.5001L17.327 17.1218L12.827 13.232L12.5 13.6103ZM11.1597 13.6771L11.5132 14.0307C11.6948 13.8491 11.9846 13.8346 12.1834 13.9973L12.5 13.6103L12.8166 13.2233C12.2202 12.7353 11.351 12.7787 10.8061 13.3236L11.1597 13.6771ZM3 13.6103H3.5C3.5 13.1885 3.99015 12.9562 4.31662 13.2233L4.63324 12.8363L4.94986 12.4494C3.97046 11.648 2.5 12.3449 2.5 13.6103H3ZM4 18.0001V18.5001H16V18.0001V17.5001H4V18.0001ZM17 17.0001H17.5V13.5731H17H16.5V17.0001H17ZM16 18.0001V18.5001C16.8284 18.5001 17.5 17.8285 17.5 17.0001H17H16.5C16.5 17.2762 16.2761 17.5001 16 17.5001V18.0001ZM3 17.0001H2.5C2.5 17.8285 3.17157 18.5001 4 18.5001V18.0001V17.5001C3.72386 17.5001 3.5 17.2762 3.5 17.0001H3ZM3 17.0001H3.5V13.6103H3H2.5V17.0001H3ZM17 12H17.5V11.5H17H16.5V12H17ZM7.19138 14.9294L6.87476 15.3163C7.81915 16.089 9.18336 16.0671 10.1024 15.2644L9.77349 14.8878L9.44458 14.5112C8.89316 14.9928 8.07463 15.006 7.508 14.5424L7.19138 14.9294Z"/>
                  </svg>                  
                </div>
                <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Vector & Generate" >
                  矢量&生成
                </div>
              </div>
              <div data-radio data-radio-data="5" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
                <div data-skilltype-icon>
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--mainColor)" d="M7.53784 8.53784C7.53784 7.98556 7.98556 7.53784 8.53784 7.53784H11.4618C12.0141 7.53784 12.4618 7.98556 12.4618 8.53784V11.4618C12.4618 12.0141 12.0141 12.4618 11.4618 12.4618H8.53784C7.98556 12.4618 7.53784 12.0141 7.53784 11.4618V8.53784Z"/>
                    <path stroke="var(--mainColor)" d="M17.5 8.125V7C17.5 4.51472 15.4853 2.5 13 2.5H11.875M17.5 11.875V13C17.5 15.4853 15.4853 17.5 13 17.5H11.875M2.5 11.875V13C2.5 15.4853 4.51472 17.5 7 17.5H8.125M2.5 8.125V7C2.5 4.51472 4.51472 2.5 7 2.5H8.125"/>
                    <path stroke="var(--mainColor)" d="M5.65112 7.65112C5.65112 6.54655 6.54655 5.65112 7.65112 5.65112H12.3489C13.4535 5.65112 14.3489 6.54655 14.3489 7.65112V12.3489C14.3489 13.4535 13.4535 14.3489 12.3489 14.3489H7.65112C6.54655 14.3489 5.65112 13.4535 5.65112 12.3489V7.65112Z" stroke-dasharray="2.14 2.14"/>
                    <circle stroke="var(--mainColor)" cx="10" cy="2.5" r="1.5"/>
                    <circle stroke="var(--mainColor)" cx="10" cy="17.5" r="1.5"/>
                    <circle stroke="var(--mainColor)" cx="2.5" cy="10" r="1.5"/>
                    <circle stroke="var(--mainColor)" cx="17.5" cy="10" r="1.5"/>
                  </svg>                  
                </div>
                <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Style & Prototype" >
                  样式&原型
                </div>
              </div>
            </div>
          </div>
          <!--功能列表-->
          <div  data-skills-scroll class="wh100 df-ffc ovy noscrollbar">
            <div data-skills-box class="w100 df-ffc">
              <div class="w100 df" data-skillmodule="Useful & Starts">
                <!--自动添加-->
                <div class="fl1 df-cc" data-skill-sec data-skill-cover="end" style="display: flex;">
                  <span data-any="vw240" data-skill-cover="tips">
                    <span data-en-text="Click the star">
                      点击功能块右上角的星星
                    </span>
                    <span data-skill-star="false">
                        <btn-star></btn-star>
                    </span>
                    <span data-en-text="of functional module to add it to here~">
                      即可收藏到此处~
                    </span>
                  </span>
                </div>
              </div>
              <div class="w100 df" data-skillmodule="Pixel & Transform">
                <div class="fl1" data-skill-sec="inSituRasterize">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Slice Size">切片大小</div>
                    <div data-pixel-mix class="df-lc pos-r" data-select data-select-value="≤ 4096px" style="gap: 4px; width: 90px; z-index:2;">
                      <input id="select-value-2" type="text" data-select-input readonly="" value="≤4096">
                      <input id="select-show-2" data-select-pick="≤4096" type="checkbox">
                      <label for="select-show-2" class="show-next wh100" style="position: absolute; top:0; right: 0;"></label>
                      <div data-select-options="" class="df-ffc pos-a w100 noscrollbar" style="white-space: wrap; display: none; top:24px;">
                        <div data-option="option" data-option-main="true" data-option-value="≤ 4096px">≤ 4096px</div>
                        <div data-option="option" data-option-main="false" data-option-value="≤ 2048px">≤ 2048px</div>
                        <div data-option="option" data-option-main="false" data-option-value="≤ 1024px">≤ 1024px</div>
                      </div>
                    </div>
                  </div>
                  <div class="df-sc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Scale">像素倍率</div>
                    <div class="df-lc" style="flex: 0 0 auto; width: 50px;">
                      <input id="input-pixelScale" type="text" value="1"
                      data-input data-input-type="float" data-input-must="0.1,20" 
                      style="flex: 0 0 auto; width: 32px; text-align: center;"/>
                    <div class="df-cc" data-input-unit>x</div>
                    </div>
                    <div></div>
                    <div class="df-lc fl1" data-pixelscale-set data-radio-value="1" style="gap: 2px;">
                      <div data-radio data-radio-data="1" data-radio-main="true" class="df-cc">
                        1x
                      </div>
                      <div data-radio data-radio-data="2" data-radio-main="false" class="df-cc">
                        2x
                      </div>
                      <div data-radio data-radio-data="3" data-radio-main="false" class="df-cc">
                        3x
                      </div>
                      <div data-radio data-radio-data="4" data-radio-main="false" class="df-cc">
                        4x
                      </div>
                    </div>
                  </div>
                  <div class="df-sc" data-skill-line>
                    <div class="df-lc w100" data-skill-more>
                      <div data-pixel-copy class="df-cc" data-btn="skill-main" data-en-text="Pixel As Copy">保留原图层</div>
                      <div data-pixel-overwrite class="df-cc" data-btn="skill-main" data-en-text="Pixel Overwrite">覆写原图层</div>
                    </div>
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="uniformScale">
                  <div data-skill-star="false">
                      <btn-star></btn-star>
                  </div>
                  <div class="df-sc" data-skill-line>
                    <div class="df-ffc fl1" style="gap: 7px; max-width: 160px;">
                      <div data-any="vw240" style="height: 6px;"></div>
                      <div class="df-lc w100" style="max-width: 160px;">
                        <div data-skill-btnname data-any="vw240" data-en-text="Each ratio">按百分比</div>
                        <input id="uniform-set-s" type="text" value="1" data-input data-input-type="float" data-input-must="0.001,100" style="text-align: center;">
                        <div class="df-cc" data-input-unit="">x</div>
                      </div>
                      <div class="df-lc w100" style="max-width: 160px;">
                        <div data-skill-btnname data-any="vw240" data-en-text="Same width">按宽度</div>
                        <input id="uniform-set-w" type="text" value="" data-input data-input-type="float" data-input-must="0.001,100" style="text-align: center;">
                        <div class="df-cc" data-input-unit="">w</div>
                      </div>
                      <div class="df-lc w100" style="max-width: 160px;">
                        <div data-skill-btnname data-any="vw240" data-en-text="Same height">按高度</div>
                        <input id="uniform-set-h" type="text" value="" data-input data-input-type="float" data-input-must="0.001,100" style="text-align: center;">
                        <div class="df-cc" data-input-unit="">h</div>
                      </div>
                    </div>
                    <div data-transform-center-module class="df-ffc df-cc fl1" style="gap: 4px; margin-left: 10px;">
                      <div data-skill-btnname-top data-any="vw240" data-en-text="Scale center">缩放中心</div>
                      <div data-transform-center-box data-radio-value="1" class="w100" >
                        <div data-radio data-radio-data="1" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="2" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="3" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="4" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="5" data-radio-main="true" class="df-cc">▪</div>
                        <div data-radio data-radio-data="6" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="7" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="8" data-radio-main="false" class="df-cc">▪</div>
                        <div data-radio data-radio-data="9" data-radio-main="false" class="df-cc">▪</div>
                      </div>
                    </div>                    
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="easeTransform">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                  <div class="df-cc" data-skill-line>
                    <div data-skewscale-box class="fl0 df-cc">
                      <div data-skewscale-view ></div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Skew X">左右倾斜</div>
                    <div data-skewset-x  data-number data-number-value="0" class="df-lc fl1" style="flex: 1;">
                      <input data-input="range" type="range" min="-80" max="80" value="0">
                      <input data-input="value" data-input-must="-80,80" data-input-type="int" 
                      type="text" class="txt-c" style="width: 30px; flex: 0 0 auto; margin-left: 4px;" value="0">
                      <div class="df-cc" data-input-unit>°</div>
                      <div data-input-reset data-btn="reset">
                        <btn-reset></btn-reset>
                      </div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Skew Y">上下倾斜</div>
                    <div data-skewset-y data-number data-number-value="0" class="df-lc fl1" style="flex: 1;">
                      <input data-input="range" type="range" min="-80" max="80" value="0">
                      <input data-input="value" data-input-must="-80,80" data-input-type="int" 
                      type="text" class="txt-c" style="width: 30px; flex: 0 0 auto; margin-left: 4px;" value="0">
                      <div class="df-cc" data-input-unit>°</div>
                      <div data-input-reset data-btn="reset">
                        <btn-reset></btn-reset>
                      </div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Scale X">左右变形</div>
                    <div data-scaleset-x data-number data-number-value="100" class="df-lc fl1" style="flex: 1;">
                      <input data-input="range" type="range" min="1" max="200" value="100">
                      <input data-input="value" data-input-must="1,200" data-input-type="int" 
                      type="text" class="txt-c" style="width: 30px; flex: 0 0 auto; margin-left: 4px;" value="100">
                      <div class="df-cc" data-input-unit>%</div>
                      <div data-input-reset data-btn="reset">
                        <btn-reset></btn-reset>
                      </div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Scale Y">上下变形</div>
                    <div data-scaleset-y data-number data-number-value="100" class="df-lc fl1" style="flex: 1;">
                      <input data-input="range" type="range" min="1" max="200" value="100">
                      <input data-input="value" data-input-must="1,200" data-input-type="int" 
                      type="text" class="txt-c" style="width: 30px; flex: 0 0 auto; margin-left: 4px;" value="100">
                      <div class="df-cc" data-input-unit>%</div>
                      <div data-input-reset data-btn="reset">
                        <btn-reset></btn-reset>
                      </div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-reset-all class="df-cc" data-btn="skill-main" data-en-text="Reset All Transform">重置全部</div>
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="clipGrid">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                  <div data-clip-view class="fl0 df-cc" data-skill-line>
                    <div data-clip-select data-clip-w="2" data-clip-h="2" class="bod-d pos-r">
                      <div class="pos-a df" data-clip-set-box="w">
                        <div data-clip-set="x1" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="x2" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="x3" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="x4" class="ovh fl0 pos-r"></div>
                      </div>
                      <div class="pos-a df-ffc" data-clip-set-box="h">
                        <div data-clip-set="y1" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="y2" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="y3" class="ovh fl0 pos-r"></div>
                        <div data-clip-set="y4" class="ovh fl0 pos-r"></div>
                      </div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Clip LR">左右裁切</div>
                    <div class="df-lc fl1" data-clip-w-set data-radio-value="2" style="gap: 4px;">
                      <div class="df-cc" data-radio data-radio-main="false" data-radio-data="0">x0</div>
                      <div class="df-cc" data-radio data-radio-main="true" data-radio-data="2">x2</div>
                      <div class="df-cc" data-radio data-radio-main="false" data-radio-data="4">x4</div>
                    </div>
                  </div>
                  <div class="df-lc" data-skill-line>
                    <div data-any="vw240" data-skill-btnname data-en-text="Clip TB">上下裁切</div>
                    <div class="df-lc fl1" data-clip-h-set data-radio-value="2" style="gap: 4px;">
                      <div class="df-cc" data-radio data-radio-main="false" data-radio-data="0">x0</div>
                      <div class="df-cc" data-radio data-radio-main="true" data-radio-data="2">x2</div>
                      <div class="df-cc" data-radio data-radio-main="false" data-radio-data="4">x4</div>
                    </div>
                  </div>
                  <div class="df-sc" data-skill-line="">
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="As Copy">仅裁切</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="As Component">转组件（推荐）</div>
                    </div>
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="alterImageFill">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                  <div class="df-ffc df-cc" data-skill-line>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Clear Filter">清除调整</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Raw Size">还原尺寸</div>  
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="​High Pass">高反差保留</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Invert Alpha">反转通道</div>
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Crop Blank">多余空白裁剪</div>  
                      <div class="df-cc" data-btn="skill-main" data-en-text="Crop Current Scale">当前比例裁剪</div>  
                    </div>
                    <div data-skill-gap>
                      <span>----</span>
                      <span data-any="vw240" data-en-text="Last level default as reference layer">
                        默认以最低图层作为参考</span>
                      <span>----</span>
                    </div> 
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Same Filter">统一调整参数</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Same Full">统一填充模式</div>  
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Same Clip Position">统一裁剪位置</div>
                      <div class="w100" data-any="vw240"></div>  
                    </div>
                  </div>
                </div>
                <div class="fl1" data-any="vw470" data-skill-sec data-skill-cover="end"></div>
              </div>
              <div class="w100 df" data-skillmodule="Text & Layer">
                <div class="fl1"  data-skill-sec="SplitText">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="MergeText">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                </div>
                <div class="fl1"  data-skill-sec="LayersLayout">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                  <div class="df-ffc df-cc" data-skill-line>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Arrange By Ratio">自动重排</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Auto Constraints">简单约束</div>  
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Reversing Index">反转顺序</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Exchange Position">调换位置</div>  
                    </div>
                    <div data-skill-gap>
                      <span>----</span>
                      <span data-any="vw240" data-en-text="For components(may with auto layout)">
                        基于组件(部分需在自动布局中)</span>
                      <span>----</span>
                    </div> 
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Clone to Fill">填充到容器</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Absolute & Fill">自适应底框</div>  
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Heavy Chain">重链组件</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Copy New">重置组件</div>
                    </div>
                    <div class="df-lc w100" data-skill-more>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Clone New">复制母组件</div>
                      <div class="df-cc" data-btn="skill-main" data-en-text="Release">解除母组件</div>  
                    </div>
                  </div>
                </div>
                <div class="fl1" data-any="vw470" data-skill-sec data-skill-cover="end"></div>
              </div>
              <div class="w100 df" data-skillmodule="Vector & Generate">
                <div class="fl1"  data-skill-sec="easeTransform">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                </div>
                <div class="fl1" data-any="vw470" data-skill-sec data-skill-cover="end"></div>
              </div>
              <div class="w100 df" data-skillmodule="Style & Prototype">
                <div class="fl1"  data-skill-sec="easeTransform">
                  <div data-skill-star="false">
                    <btn-star></btn-star>
                  </div>
                </div>
                <div class="fl1" data-any="vw470" data-skill-sec data-skill-cover="end"></div>
              </div>
            </div>
          </div>
          <!--选中信息-->
          <div class="df-lc noscrollbar" data-selects-node data-scroll style="padding: 0 10px; box-sizing: border-box;">
            <span class="df-lc" data-selects-info-box style="margin: 0 auto;">
              <div style="width: 12px; height: 12px;">
                <btn-hasselect></btn-hasselect>         
              </div>
              &nbsp;
              <span data-selects-info="main"></span>
              <span class="df-cc" data-selects-info="more">
                &nbsp;+&nbsp;
                <span data-selects-info="sec"></span>
                ..&nbsp;
                <span data-selects-info="num"></span>
                &nbsp;
                <span data-en-text="layers">图层</span>
              </span>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--底部-->
  <div id="bottom" class="df-sc w100 pos-a">
    <div data-scroll class="df noscrollbar" data-tab="auto" data-tab-for="page" style="padding: 6px 4px;">
      <!--自动填充tab-->
    </div>
    <div data-mainset-bottom class="df-lc" style="gap: 4px; margin-left: 2px;">
      <div id="btn-theme-2">
        <input id="theme-2" data-theme-check type="checkbox" checked="true">
        <label for="theme-2" class="btn-theme" style="position: relative;">
          <btn-theme></btn-theme>
        </label>
      </div>
      <input id="language-2" data-language-check type="checkbox" checked="true"/>
      <label for="language-2" class="switch pos-a" style="--swi-h:18px; --swi-r:6px; --swi-af:var(--mainColor);">
        <div class="pos-a" data-swi-icon style="top:3px; left: 2px; width: 11px; height: 11px; z-index: 2;">
          <svg style="margin: auto 1px;" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 22 22">
            <path fill="var(--boxBod)" d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2"></path>
          </svg>
        </div>
      </label>
    </div>

  </div>
  <!--插件端调整大小-->
  <div data-resize-window></div>
  
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/builds/yn_comp.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/builds/yn_tool.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/public/compressor.min.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/public/xlsx.min.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/public/jszip.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@87994d52ec5565405aa0a44d9bca6e52e8965b8a/public/graph.js"></script>
  <!-- INLINE_JS -->
  <script>
/*初始数据*/
let skillSecInfo = [
  {
    id: 'inSituRasterize',
    name: ["原地栅格化","in-situ rasterize"],
    tips:  ["",""],
  },
  {
    id: 'easeTransform',
    name: ["简单变形","ease transform"],
    tips:  ["",""],
  },
  {
    id: 'uniformScale',
    name: ["等比缩放","uniform scale"],
    tips:  ["",""],
  },
  {
    id: 'alterImageFill',
    name: ["图片填充修改","alter image fill"],
    tips:  ["",""],
  },
  {
    id: 'clipGrid',
    name: ["宫格裁切","clip grid"],
    tips:  ["",""],
  },
  {
    id: 'SplitText',
    name: ["拆分文本","split text"],
    tips:  ["",""],
  },
  {
    id: 'MergeText',
    name: ["合并文本","merge text"],
    tips:  ["",""],
  },
  {
    id: 'LayersLayout',
    name: ["图层&布局","layers layout"],
    tips:  ["",""],
  },
  {
    id: '',
    name: ["",""],
    tips:  ["",""],
  },
  {
    id: '',
    name: ["",""],
    tips:  ["",""],
  },
  {
    id: '',
    name: ["",""],
    tips:  ["",""],
  },
  {
    id: '',
    name: ["",""],
    tips:  ["",""],
  },
]

let toUserTips = {
  worktime: ["🔒下班时间不建议工作~ (付费解锁)","🔒You shouldn't work after work!(pay to unlock)"],
  random: [
    ["久坐伤身, 快起来走两步吧~","Get up and take a walk now~"],
    ["身心要紧, 不舒服及时休息~","Put down your work and rest in time~"],
    ["工具提效, 是为了多陪家人~","Spend more time with your family~"],
    ["支持开源, 要价值而非价格~","Support open source and design~"],
    ["久坐伤身, 快起来走两步吧~","Get up and take a walk now~"],
    ["身心要紧, 不舒服及时休息~","Put down your work and rest in time~"],
    ["工具提效, 是为了多陪家人~","Spend more time with your family~"],
    ["支持开源, 要价值而非价格~","Support open source and design~"],
  ],
};

let helpData = {
  create: [
    ["p",
    "本页功能主要用于/++ 批量创建画板、图层等 ++/",
    "This page is used for batch creation of /++ frames, layers, etc ++/"],
    ["li",
    "传入大图（长图）可创建大小均匀的切片组, 以避免压缩",
    "Upload large images (long images) will create slice groups to avoid compression"],
    ["li",
    "传入带命名、宽高等信息的表格数据则创建画板",
    "Upload table data with name, width, height, and other information, will will create frames"],
    ["li",
    "传入由本系列插件生成的兼容文件则创建图层",
    "Upload files by YN+ or other compatible file will create layers"],
    ["li",
    "图片支持格式: <br> /++ .jpg | .jpeg | .jfif | .webp | .png | .apng | .gif ++/",
    "Image file type:<br> /++ .jpg | .jpeg | .jfif | .webp | .png | .apng | .gif ++/"],
    ["li",
    "表格支持格式: <br> /++ .csv | .xls | .xlsx ++/",
    "Table file type: <br> /++ .csv | .xls | .xlsx ++/"],
    ["li",
    "兼容文件支持格式: <br>/++ .zy | .sketch | .svg | .xml | .json | .zip | .rar | .7z ++/",
    "Compatible file type: <br> /++ .zy | .sketch | .svg | .xml | .json | .zip | .rar | .7z ++/"],
    ["br","",""],
    ["p",
    "拖拽和上传文件会立即生成用以确认最终生成内容的/++ 标签/大纲 ++/",
    "Dragging or uploading files will immediately convert to /++ tags/catalogue ++/"],
    ["li",
    "拖拽的文件需全部是为图片类、全部是表格类或全部是兼容文件, /++ 不能混杂类型 ++/",
    "Drag and drop files must be all images, tables, or compatible files. /++ Mixed file types are not allowed ++/"],
    ["li",
    "上传文件设置了具体格式, 不支持的格式将无法点选",
    "The three upload buttons restrict the file format, and unsupported formats cannot be uploaded"],
    ["br","",""],
    ["p",
    "通过文本框输入数据, 需要点击第一个按钮来生成标签/大纲",
    "If input data through the textarea, click the first button to convert the data to tags/catalogue"],
    ["li",
    "输入表格数据无需包含表头、单位, /++ 可双击文本框查看示例 ++/",
    "Does not need to include a table header or unit./++ May double-click the textarea to fill an example <span>"],
    ["li",
    "可以选中文件里的画板或图层, 然后点击第二个按钮获取命名和宽高数据",
    "Select frames or layers in the file, and then click the second button to obtain theirs name, width and height data"],
    ["li",
    "如果需要制作更复杂的模板, 点击第三个按钮前往资源助手",
    "If you need to create more complex templates, click the third button to go to the /++ YN+ ListEase ++/ online"],
    ["br","",""],
    ["p",
    "表格数据默认按/++ 命名、宽高、目标文件大小、目标文件格式、补充信息 ++/的顺序读取列, 如需修改规则可点击第四个按钮展开高级设置",
    "Table data is read in the order of /++ name, width, height, target file size, target file format, and supplementary information ++/ by default. To modify the rules, click the fourth button to expand advanced settings"],
    ["li",
    "修改列顺序规则时需注意,必须包含命名和宽高"
    ,"When modifying column order rules, it is important to include /++ name, width and height ++/"],
    ["li",
    "画板名默认带w×h后缀, 如/++ kv 1920×1080 ++/, 可选择其他预设或自行定义",
    "The frame defaults to a suffix with width and height,such as /++ kv 1920 × 1080 ++/, you can selected a presets or input oneself"],
  ],
  sheet: [
    ["p",
    "使用本功能需要掌握【组件】和【组件属性】等基本知识",
    ""],
    ["li",
    "组件使元素能保持一致的样式, 并通过实例的/++ 继承性 ++/实现批量控制样式",
    ""],
    ["li",
    "组件属性是将需要修改的样式以表单的形式放在属性栏最上方, 方便/++ 参数化管理组件 ++/",
    ""],
    ["p",
    "表格由至少两个组件: /++ xxx@th(表头) | xxx@td(表数据) ++/, 嵌套自动布局而成, 请注意, 这里采用先按列再按行的布局, 与常见表格逻辑相反, 但更适合设计领域",
    "The table should build with auto-layout from least 2 components: /++ xxx@th(table-header) | xxx@td(table-data) ++/. Please note that the layout here is based on columns first and then rows, which is opposite to the common table logic but more suitable for the design field"],
    ["li",
    "首次使用该功能, 建议直接点击按钮生成一个表格示例, 以便理解其中的规范要求",
    ""],
    ["li",
    "默认生成3*3的表格, 也可以输入具体行列来生成, 但随后填充数据时会自动调节行列",
    ""],
    ["li",
    "默认先生成表头和表格组件, 如选中了命名为xxx@th和xxx@td的组件, 则会直接生成表格",
    ""],
    ["li",
    "组件必须包含用多个图层实现的描边和填充, 并绑定/++ 布尔类型组件属性: --bod-l(左描边) | --bod-r(右描边) | --bod-t(上描边) | --bod-b(下描边) | --fills(填充) ++/",
    ""],
    ["li",
    "组件会先包裹在一个列中xxx@column, xxx@th会始终在第一个, 然后多个列会包裹在一个表中xxx@table",
    ""],
    ["li",
    "组件必须包含一个文字图层, 并绑定/++ 字符类型组件属性: --data(数值/文本) ++/",
    ""],
    ["br","",""],
    ["p",
    "因为【组件属性】功能的强大, 我们会有很多办法实现批量替换数据, 不仅限于表格, 因此【表格】可视为【批量替换数据】的一种特殊情况",
    ""],
    ["li",
    "使用【表格数据映射】时, 仅检索xxx@table下,每列xxx@column的xxx@th和xxx@td的--data属性进行修改",
    ""],
    ["li",
    "如需要更复杂的组件属性组合, 需使用【组件属性映射】功能来完成数据映射",
    ""],
    ["li",
    "【文本数据映射】不需要表头作为查找组件属性的依据, 直接按行列对应关系填充数据, 【组件属性映射】则需要将对应组件属性名作为表头, 按图层顺序修改对应的值",
    ""],
    ["li",
    "【组件属性映射】对变体的选项值也同样生效,需设置唯一的变体属性名(默认是Property) 需避免存在同名的情况, 变体集内的组件命名无影响",
    ""],
    ["br","",""],
    ["p",
    "通过将xxx@th和xxx@td组件宽度设置为充满, 我们可以轻松地用xxx@column控制列宽,也可以直接在图层里连选列内的xxx@td, 而选中行的方式可能比较复杂",
    ""],
    ["li",
    "【选中单行】功能可以查找相邻父级同位置的图层, 请确保图层结构的一致性",
    ""],
    ["li",
    "【选中多行】功能可以在选中单行的基础上, 将所在行之间的其他行一并选中",
    ""],
    ["li",
    "【区域选中】功能类似框选, 会在选中两个xxx@td形成的框内所有的xxx@td ",
    ""],
    ["li",
    "【连续选中】功能可类似文本段落的连选, 会从第一个xxx@td开始逐行选中, 到第二个xxx@td结束",
    ""],
    ["br","",""],
    ["p",
    "为弥补组件属性的局限性问题, 可使用【标签属性映射】来完成 /++ #xxx.fill(填充色值) | #xxx.stroke(描边色值) | #xxx.fillStyle(填充样式名) | #xxx.strokeStyle(描边样式名)| #xxx.visible(可见性true/false) | #xxx.opacity(透明度0~1) | #xxx.fontSize(字号) ++/ 的参数化控制",
    ""],
    ["li",
    "选中的对象将按图层顺序对应每一行的数值,修改时会先判断对象是否带标签, 然后再遍历子对象, 对象/子对象本身可以包含多个标签, 可以存在不同的标签组合, 这对实现更复杂的样式变化很有用 ",
    ""],
    ["li",
    "",
    ""],
    ["li",
    "",
    ""],
    ["br","",""],
    ["p",
    "",
    ""],
    ["li",
    "",
    ""],
    ["br","",""],
  ]
};

/*静态数据或对象*/
const UI_MINI = [200,460];
const UI = [300,660];
const UI_BIG = [620,660];
const sideMix = document.querySelector('[data-side-mix]');
const sideMask = document.querySelector('[data-side-mask]');
const btnMore = document.getElementById('btn-more');
const btnResize = document.querySelector('[data-resize-window]');
const btnBig = document.getElementById('big');
const TV_text = document.querySelector('[data-tv-text]');
const dropUp = document.querySelector('[data-drop="upload"]');
const fileInfo = document.querySelector('[data-file-info]');
const btnHelp = document.querySelectorAll('[data-help]');
const dailog = document.querySelector('[data-dailog]');
const dailogBox = document.querySelector('[data-dailog-box]');
const skillTypeBox = document.querySelector('[data-skilltype-box]');
const skillAllBox = document.querySelector('[data-skills-box]');
const skillSecNode = document.querySelectorAll('[data-skill-sec]');
const skillStar = document.querySelectorAll('[data-skill-star]');
const skillAllModel = document.querySelectorAll('[data-skillmodule]');
const skillStarModel = document.querySelector('[data-skillmodule="Useful & Starts"]');
const selectInfoBox = document.querySelectorAll('[data-selects-node]');
const createTagsBox = document.querySelector('[data-create-tags]');
const cataloguesBox = document.querySelector('[data-create-catalogues]');
const skillBtnMain = document.querySelectorAll('[data-btn="skill-main"]');
const clearTags = document.querySelector('[data-create-tags-box]').querySelector('btn-close').parentNode;
const convertTags = document.getElementById('upload-set-1');
const getTableText = document.getElementById('upload-set-2');
const chkTablestyle = document.getElementById('chk-tablestyle');
const chkSelectcomp = document.getElementById('chk-selectcomp');
const createAnyBtn = document.querySelector('[data-create-any]')
const createTableBtn = document.querySelector('[data-create-table]');
const tableStyleSet = document.querySelector('[data-tablestyle-set]');

let skillModel = [];
let skilltypeNameNode = skillTypeBox.querySelectorAll('[data-skilltype-name]');
skilltypeNameNode.forEach(item => {
  let name1 = item.getAttribute('data-zh-text');
  name1 = name1 ? name1 : item.textContent.trim();
  let name2 = item.getAttribute('data-en-text');
  skillModel.push([name1,name2]);
});
let isSkillScroll = true;
let tableStyle = [
  {th:[0,0,0,0,1],td:[0,0,0,0,'space']},//间格区分色
  {th:[0,0,0,0,1],td:[0,0,0,0,0]},//无描边
  {th:[0,0,0,0,1],td:[1,0,1,0,0]},//仅横线
  {th:[0,0,0,0,1],td:[1,1,1,1,0]},//全描边
  {th:[0,0,0,0,0],td:[1,0,1,0,0]},//仅横线（表头无区分色
  {th:[0,0,0,0,0],td:[1,1,1,1,0]},//全描边（表头无区分色
];

/*表单绑定*/
const userImg = document.getElementById('input-user-img');
const userTable = document.getElementById('input-user-table');
const userZy = document.getElementById('input-user-zy');
const userTableTitle = document.getElementById('input-user-table-title');
const frameName =  document.getElementById('input-framename');
const userText = document.getElementById('upload-textarea');

const pixelScale = document.getElementById('input-pixelScale');

/*动态数据或对象*/
let CreateImageInfo = [];
let CreateTableInfo = [];
let SelectNodeInfo = [];

let isResize = false;
let reStartW,reStartH,reStartX,reStartY;
let tableTitleMust = userTableTitle.getAttribute('placeholder').split(',');
let imageType = document.getElementById('input-user-img').getAttribute('accept').split(',').map(item => item.replace('.',''));
let tableType = document.getElementById('input-user-table').getAttribute('accept').split(',').map(item => item.replace('.',''));
let zyType = document.getElementById('input-user-zy').getAttribute('accept');
let frameNmaeSelect = [];
frameName.nextElementSibling.querySelectorAll('[data-option="option"]')
.forEach(item => {
  frameNmaeSelect.push(item.getAttribute('data-option-value'));
});

window.addEventListener('load',()=>{
  /*
  viewPage('sheet')
  /**/;
  if(window.innerWidth < 300){
    TV_MOVE = true;
  } else {
    TV_MOVE = false;
  };
  reTV();
  loadFont();
  reSkillNum();
  addSkillTitle();
  addToUserTips();
  setInterval(() => {
    addToUserTips();
  }, 12000);
});

window.addEventListener('resize',()=>{
/*防抖*/
let MOVE_TIMEOUT;
if(MOVE_TIMEOUT){
    clearTimeout(MOVE_TIMEOUT)
};
MOVE_TIMEOUT = setTimeout(()=>{
  if(window.innerWidth < 300){
    TV_MOVE = true;
  } else {
    TV_MOVE = false;
  }
},500);
});


/* ---界面初始化--- */

/**
 * 重载字体样式
 * @param {node | null} area -可传入重载范围, 可以是元素本身, 或id/自定义属性等唯一值；
 */
function loadFont(area){
  let loadFontAfter = [
    "data-en-text",
    "data-en-input",
    "data-en-placeholder",
    "data-turnto",
    "data-back",
  ];
  let areas;
  if(area){
    areas = getElementMix(area);
  } else {
    areas = document;
  };
  setTimeout(()=>{
    loadFontAfter.forEach(key => {
      let nodes = areas.querySelectorAll(`[${key}]`);
      nodes.forEach(item => {
        item.style.fontFamily = '"Shanggu Sans", Arial, Helvetica, sans-serif';
      })
    });
  },100);
};
//动态变化公屏文案
function addToUserTips(){
  let languge = ROOT.getAttribute('data-language');
  let num = languge == 'Zh' ? 0 : 1;
  let languge2 = languge == 'Zh' ? 'en' : 'zh';
  let random = toUserTips.random[Math.floor(Math.random()*toUserTips.random.length)]
  TV_text.textContent = random[num]
  TV_text.setAttribute('data-'+ languge2 +'-text',random[1 - num]);
  TV_text.setAttribute('data-'+ languge.toLowerCase() +'-text',random[num]);
  let textW
  if(num){
    textW = random[num].length * -1 - 4 + 'ch';//英文1ch
  }else{
    textW = random[num].length * -2 - 4 + 'ch';//中文2ch
  }
  TV_text.parentNode.style.setProperty('--tv-w',textW)

};
//添加带tips的功能标题
function addSkillTitle(){
  skillSecNode.forEach(secnode =>{
    let secid = secnode.getAttribute('data-skill-sec');
    if(secid){
      let info = skillSecInfo.find(item => item.id == secid);
      let node = document.createElement('div');
      node.setAttribute('data-skill-title','');
      node.className = 'df-lc';
      let tips = document.createElement('div');
      tips.setAttribute('data-tips','');
      tips.setAttribute('data-tips-x','left');
      tips.setAttribute('data-tips-y','top');
      tips.setAttribute('style',`--tips-text:'${info.tips[0]}'; --tips-text-en:'${info.tips[1]}';`);
      tips.innerHTML = '<btn-info></btn-info>'
      node.appendChild(tips);
      let name = document.createElement('div');
      let languge = ROOT.getAttribute('data-language');
      name.setAttribute('data-zh-text',info.name[0]);
      name.setAttribute('data-en-text',info.name[1]);
      name.setAttribute('data-skill-sec-name','');
      let text = languge == 'Zh' ? info.name[0] : info.name[1];
      name.innerHTML = text;
      node.appendChild(name);
      secnode.prepend(node);
      //重置文字样式
      loadFont(secnode.parentNode);
    };
  });
};
//处理选中图层的信息
function reSelectInfo(info){
  SelectNodeInfo = info;
  if(info.length > 0){
    ROOT.setAttribute('data-selects','true');
    selectInfoBox.forEach(item => {
      let main = item.querySelector('[data-selects-info="main"]');
      let sec = item.querySelector('[data-selects-info="sec"]');
      let num = item.querySelector('[data-selects-info="num"]');
      main.textContent = info[0][0];
      sec.textContent = info[1] ? info[1][0] : '';
      num.textContent = info.length;
    });
  if(info.length > 1){
    ROOT.setAttribute('data-selects-more','true');
  }else{
    ROOT.setAttribute('data-selects-more','false');
  }
 }else{
  ROOT.setAttribute('data-selects','false')
 }
};
//按用户偏好修改界面大小
function reRootSize(info){
  if(info[0] > UI[0]){
    btnBig.checked = true;
  } else {
    btnBig.checked = false;
  }
}


/* ---界面交互--- */

let tool = new TOOL_JS();
//侧边栏展开
btnMore.addEventListener('change',(event)=>{
  if(event.target.checked){
    sideMix.style.display = 'flex';
    sideMask.style.display = 'block';
    sideMix.style.animation = 'sideUp 0.3s ease-out';
    sideMask.style.animation = 'loadOp 0.3s ';
  } else {
    sideMix.style.animation = 'sideOver 0.3s ease-out';
    sideMask.style.animation = 'overOp 0.3s ease-out';
    setTimeout(()=>{ 
      sideMix.style.display = 'none'
      sideMask.style.display = 'none'
    },280)
  }
});
//侧边栏关闭
document.addEventListener('click',(event)=>{
  if(!sideMix.contains(event.target) && sideMask.style.display !== 'none' && sideMix.style.display !== 'none' && btnMore.checked == true ){
    btnMore.checked = false;
    let inputEvent = new Event('change',{bubbles:true});
    btnMore.dispatchEvent(inputEvent);
  }
});
//缩放窗口
btnResize.addEventListener('mousedown',(event)=>{
  isResize = true;
  let reNodeStyle = document.defaultView.getComputedStyle(ROOT);
  reStartW = parseInt(reNodeStyle.width,10);
  reStartH = parseInt(reNodeStyle.height,10);
  reStartX = event.clientX;
  reStartY = event.clientY;
  //console.log(reStartW,reStartH)
  document.addEventListener('mousemove',(e)=>{
    if(isResize){
      let w = reStartW + e.clientX - reStartX;
      let h = reStartH + e.clientY - reStartY;
      w = Math.max(w,UI_MINI[0]);
      h = Math.max(h,UI_MINI[1]);
      toolMessage([[w,h],'resize'],PLUGINAPP);
      /*//
      console.log(w,h)
      ROOT.style.width = w;
      ROOT.style.height = h;
      //*/
      
      /*防抖*/
      let MOVE_TIMEOUT;
      if(MOVE_TIMEOUT){
          clearTimeout(MOVE_TIMEOUT)
      };
      MOVE_TIMEOUT = setTimeout(()=>{
        storageMix.set('userResize',[w,h]);
        if(w > UI[0]){
          btnBig.checked = true;
        } else {
          btnBig.checked = false;
        }
      },500);
    }
  });
  document.addEventListener('mouseup',()=>{
    isResize = false;
  })
});
//打印所选对象
document.getElementById('bottom').addEventListener('dblclick',()=>{
  toolMessage(['','getnode'],PLUGINAPP)
});
//最大化窗口
btnBig.addEventListener('change',()=>{
  let w = window.innerWidth;
  let h = window.innerHeight;
  if(btnBig.checked){
    if(w < UI[0] || h < UI[1]){
      toolMessage([false,'big'],PLUGINAPP);
      btnBig.checked = false;
    }else{
      toolMessage([true,'big'],PLUGINAPP);
    }
  }else{
    toolMessage([false,'big'],PLUGINAPP);
  }
});
//点击上传
userImg.addEventListener('change',(e)=>{
  let files = Array.from(userImg.files);
  reFileInfo(files);
  addImageTags(files)
});
userTable.addEventListener('change',(e)=>{
  let files = Array.from(userTable.files);
  reFileInfo(files);
  addTableText(files)
});
userZy.addEventListener('change',(e)=>{
  let files = Array.from(userZy.files);
  reFileInfo(files);
  addZyCatalogue(files)
});
//拖拽上传
let dragAreaInfo;
dropUp.addEventListener('dragover',(e)=>{
  dragAreaInfo = dropUp.getBoundingClientRect();
  e.stopPropagation();
  e.preventDefault();
  e.dataTransfer.dropEffect = 'copy';
  dropUp.style.filter = 'drop-shadow(0 0 4px let(--mainColor))';
  dropUp.style.setProperty('--drop-df','collapse');
});
dropUp.addEventListener('dragleave',(e)=>{
  let x = e.clientX;
  let y = e.clientY;
  let areaX = dragAreaInfo.x;
  let areaY = dragAreaInfo.y;
  let areaW = dragAreaInfo.width;
  let areaH = dragAreaInfo.height;
  if( x <= areaX || x >= areaX + areaW || y <= areaY || y >= areaY + areaH){
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
    dropUp.style.filter = '';
    dropUp.style.setProperty('--drop-df','visible');
  }
});
dropUp.addEventListener('drop',(e)=>{
  e.stopPropagation();
  e.preventDefault();
  dropUp.style.filter = '';
  dropUp.style.setProperty('--drop-df','visible');
  let files = Array.from(e.dataTransfer.files);
  let filesTypes = [...new Set(files.map(item => item.name.split('.')[item.name.split('.').length - 1].toLowerCase()))];
  let sameType = null;
  
  if(filesTypes.filter(item => imageType.includes(item)).length == filesTypes.length){
    sameType = 'image';
  };
  if(filesTypes.filter(item => tableType.includes(item)).length == filesTypes.length){
    sameType = 'table';
  };
  if(filesTypes.filter(item => zyType.includes(item)).length == filesTypes.length){
    sameType = 'zy';
  };
  if(sameType){
    files = files.sort((a, b) => b.size - a.size);
    reFileInfo(files);
    switch (sameType){
      case 'image': addImageTags(files,true);break
      case 'table': addTableText(files,true);break
      case 'zy': addZyCatalogue(files,true);break
    }
  } else {
    tipsAll(['只能上传同类型文件','The file type must meet the requirements'],3000)
  }
  
});
//创建内容
createAnyBtn.addEventListener('click',()=>{
  let type = createTagsBox.parentNode.getAttribute('data-create-tags-box');
  switch (type){
    case 'image':
      let images = getFinalInfo(CreateImageInfo);
      tipsAll(['读取中, 请耐心等待','Reading, please wait a moment'],images.length * 800);
      setTimeout(()=>{
        toolMessage([images,'createImage'],PLUGINAPP);
      },100);
    ;break
    case 'table':
      //console.log(CreateTableInfo)
      let tables = getFinalInfo(CreateTableInfo,true);
      tipsAll(['读取中, 请耐心等待','Reading, please wait a moment'],CreateTableInfo.length * 100);
      setTimeout(()=>{
        toolMessage([tables,'createFrame'],PLUGINAPP);
      },100);
    ;break
    case 'zy': ;break
  };
  //移除未勾选的数据
  function getFinalInfo(info,isname){
    let finalCreate = [...info]
    let nocreateTag = createTagsBox.querySelectorAll('[data-create-final="false"]');
    nocreateTag.forEach(item => {
      let id = item.querySelector('input').id;
      let idnum = id.split('_')[id.split('_').length - 1];
      finalCreate.splice(idnum,1);
    });
    if(isname){
      let createTag = createTagsBox.querySelectorAll('[data-create-final="true"]');
      createTag.forEach((item,index) => {
        let name = item.querySelector('[data-create-info="name"]').textContent.trim()
        finalCreate[index].name = name;
      });
    };
    return finalCreate;
  };
});
//功能列表滚动绑定tab
skillAllModel.forEach(item =>{
  item.addEventListener('mouseenter',() => {
    isSkillScroll = false;
    let modelid = item.getAttribute('data-skillmodule');
    let index = skillModel.findIndex(skill => skill.includes(modelid));
    let tab = skillTypeBox.querySelector(`[data-radio-data="${(index + 1)}"]`);
    tab.click();
  });
});
skillTypeBox.addEventListener('mouseenter',() => {
  isSkillScroll = true;
});

//加载图片
function loadImage(file){
  return new Promise((resolve,reject) => {
    const reader = new FileReader()
    reader.onload = (e)=>{
      const image = new Image();
      image.onload = ()=> resolve(image);
      image.onerror = (error)=> reject(error);
      image.src = e.target.result;
    };
    reader.onerror = (error)=>{reject(error)};
    reader.readAsDataURL(file);
  });
};
//加载表格
function loadTable(file){
  return new Promise((resolve,reject) => {
    const reader = new FileReader();
    let type = file.name.split('.')[file.name.split('.').length - 1].toLowerCase();
     if(type == 'xls' || type == 'xlsx'){
      reader.onload = (e)=>{
        let zip = new JSZip();
        zip.loadAsync(reader.result)
        .then((zipContents)=>{
          zip.file('xl/worksheets/sheet1.xml').async('string')
          .then((sheetContent)=>{
            zip.file('xl/sharedStrings.xml').async('string')
            .then((strContent)=>{
              const parser = new DOMParser();
              const xmlDoc = parser.parseFromString(sheetContent,'text/xml');
              const rows = getTag(xmlDoc,'row');
              const strDoc = parser.parseFromString(strContent,'text/xml');
              const sis = getTag(strDoc,'si');
              let sharedStrings = [];
              for( let i = 0; i < sis.length; i++){
                let t = getTag(sis[i],'t');
                sharedStrings.push(t[0].textContent.trim());
              };
              let XY = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z']
              let rowTitle = getTag(rows[0],'c')
              let maxlength = XY.indexOf(rowTitle[rowTitle.length - 1].getAttribute('r').replace(/[0-9]/g,''))*1 + 1;
              let titles =  getRow(0,maxlength) + '\n';
              let values = '';
              for(let i = 1; i < rows.length; i++){
                let value = getRow(i,maxlength);
                if(i == rows.length - 1){
                  values += value;
                } else {
                  values += value + '\n';
                };
              };
              resolve(titles + values.trim());
              //console.log(titles + values)
              function getTag(xml,name){
                return xml.getElementsByTagName(name);
              };
              function getRow(index,length){
                let text = '';
                for( let i = 0; i < length; i++){
                  let v;
                  let c = rows[index].querySelector(`[r="${XY[i] + (index + 1)}"]`);
                  if(c){
                    v = getTag(c,'v')[0].textContent;
                    if(c.getAttribute('t') == 's'){
                      v = sharedStrings[v*1];
                    };
                  }else{
                    v = ''
                  }    
                  if(i == length - 1){
                    text += v;
                  } else {
                    text += v + '\t';
                  }
                };
                return text;
              };
            }); 
          });
        });
      };
      reader.onerror = (error)=>{reject(error)};
      reader.readAsArrayBuffer(file);
     };
     if(type == 'csv'){
      reader.onload = (e)=>{
        let csvData = reader.result;
        let values = csvData.replace(/\r/g,'').replace(/\,/g,'\t');
        //console.log(values) 
        resolve(values.trim())
      };
      reader.onerror = (error)=>{reject(error)};
      reader.readAsText(file);
     };
  });
}

//添加标签前处理
async function addImageTags(files,isCreate){
  clearTags.click();
  let sizes = files.map(item => item.size);
  let sizeAll = sizes.reduce((a,b) => a + b, 0);
  sizeAll = sizeAll*1 == NaN ? files.length : sizeAll; //大图至少算1M大小
  tipsAll(['读取中, 请耐心等待','Reading, please wait a moment'],sizeAll/1024/1024 * 100); //加载1M需要100毫秒
  for(let i = 0; i < files.length; i++){
    let file = files[i];
    let name = file.name.split('.').filter(item => !imageType.includes(item.toLowerCase())).join('_');
    try{
      let image = await loadImage(file);
      let cuts = await tool.CUT_IMAGE(image);
      CreateImageInfo.push({n:name,w:image.width,h:image.height,cuts:cuts});
      if(i == files.length - 1){
        addTag('image',CreateImageInfo);
        if(isCreate){//仅图片类型是在拖拽上传时立即生成
          toolMessage([CreateImageInfo,'createImage'],PLUGINAPP);
        }
      }
    } catch (error) {
      console.log(error)
    }
    
  };
}
async function addTableText(files,isTags){
  clearTags.click();
  userText.focus();
  userText.value = '';
  let tableText;
  if(typeof(files) == 'string'){
    tableText = files;
  } else {
    tableText = await loadTable(files[0])
  }
  userText.value = tableText;
  let tableArray = tableTextToArray(tableText);
  let tableObj = tableArrayToObj(tableArray);
  CreateTableInfo = tableObj;
  //console.log(tableArray,tableTextToArray(tableText,true),tableObj)
  if(isTags){
    document.getElementById('upload-set-1').click()
  }
}
function addTableTags(){
  addTag('table',CreateTableInfo);
};
function addZyCatalogue(files,isCreate){
  
};
//添加标签-总
function addTag(type,info){
  switch (type){
    case 'image':
      info.forEach((img,index) => {
        let tag = document.createElement('div');
        createTagsBox.parentNode.setAttribute('data-create-tags-box','image');
        addTagMain(tag,index);
        let name = document.createElement('div');
        name.setAttribute('data-create-info','name');
        name.innerHTML = tool.TextMaxLength(img.n,16,'...');
        tag.appendChild(name);
        if(img.cuts.length > 1){
          let span = document.createElement('span');
          span.setAttribute('style','cursor: var(--pointer,pointer)');
          let text = ROOT.getAttribute('data-language') == 'Zh' ? "切片" : "Slice"
          span.innerHTML = `▶ 
          <span style="color: var(--themeColor)">${img.cuts.length}</span>
          <span data-en-text="Slice" data-zh-text="切片">${text}</span>
          ` ;
          tag.appendChild(span);
          span.addEventListener('click',()=>{
            dailogBox.innerHTML = '';
            dailog.style.display = 'flex';
            let cutinfo = document.createElement('div');
            cutinfo.className = 'w100 df-ffc';
            cutinfo.setAttribute('style','gap: 4px');
            img.cuts.forEach((cut,num) => { 
              let blob = new Blob([cut.img],{ type: 'image/png' });
              let cutone = document.createElement('span');
              cutone.innerHTML = `▶ 
              <span data-en-text="Slice" data-zh-text="切片">${text}</span>
              <span> &nbsp;${(num + 1)}</span>
              ` ;
              cutinfo.appendChild(cutone);
              let cutimgbox = document.createElement('a');
              cutimgbox.className = 'w100 df-cc'
              cutimgbox.href = URL.createObjectURL(blob);
              cutimgbox.setAttribute('download', tool.TextMaxLength(img.n,16,'...') + '_' + text + (num + 1)  + '.png')
              let cutimg = document.createElement('img');
              cutimg.setAttribute('style','width: 80%;');
              cutimg.src = URL.createObjectURL(blob);
              cutimgbox.appendChild(cutimg);
              cutinfo.appendChild(cutimgbox);
            });
            dailogBox.appendChild(cutinfo);
          });
        }
        createTagsBox.appendChild(tag);
      });
    break
    case 'table':
      let nameRegex = frameName.value;
      info.forEach((list,index) => {
        let tag = document.createElement('div');
        createTagsBox.parentNode.setAttribute('data-create-tags-box','table');
        addTagMain(tag,index);
        let name = document.createElement('div');
        name.setAttribute('data-create-info','name');
        let end = nameRegex
        .replace(/w/g,list.w)
        .replace(/h/g,list.h)

        if(list.type){
          end = end.replace(/type/g,list.type)
        }else{
          end = end.replace(/type/g,'')
        }
        if(list.add){
          end = end.replace(/add/g,list.add)
        }else{
          end = end.replace(/add/g,'')
        }
        if(list.s){
          end = end.replace(/s/g,list.s + 'k');
        } else {
          end = end.replace(/s/g,'');
        };
        name.innerHTML = `${list.name}${end}`.trim();
        if(nameRegex == 'none'){
          name.innerHTML = list.name;
        };
        tag.appendChild(name);
        createTagsBox.appendChild(tag);
      });
    break
    case 'zy':
      info.forEach(layer => {
        
      });
    break
  };
  //所有tag都支持二次确认, 以得到最终要生成的内容
  function addTagMain(tag,index){
    tag.setAttribute('data-create-tag','');
    tag.setAttribute('data-create-final','true');
    tag.className = 'df-lc';

    let checkbox = document.createElement('div');
    checkbox.setAttribute('style','width: 14px; height: 14px;');
    let checkid = 'cr_chk_' + index;
    let checkinput = document.createElement('input');
    checkinput.id = checkid;
    checkinput.type = 'checkbox';
    checkinput.setAttribute('checked','true');
    let checklabel = document.createElement('label');
    checklabel.setAttribute('for',checkid);
    checklabel.className = 'check'
    checklabel.innerHTML = '<btn-check></btn-check>'
    checkbox.appendChild(checkinput);
    checkbox.appendChild(checklabel);
    tag.appendChild(checkbox);
    
    checkinput.addEventListener('change',()=>{
      if(checkinput.checked){
        tag.setAttribute('data-check-checked','true');
        tag.setAttribute('data-create-final','true');
      }else{
        tag.setAttribute('data-check-checked','false');
        tag.setAttribute('data-create-final','false');
      };
    });
  };
  //重置文字样式
  loadFont(createTagsBox.parentNode);
};
//制表文案转数组, 兼容反转行列
function tableTextToArray(tableText,isColumn){
  let lines = tableText.split('\n');
  lines.forEach((item,index) => {
    lines[index] = item.split('\t');
  });
  let columns = lines[0].map((_, i) => lines.map(row => row[i]));
  if(isColumn){
    return columns;
  }else{
    return lines;
  }
};
//制表数组转对象组
function tableArrayToObj(tableArray){
  let keys = tableArray[0];
  let objs = [];
  for(let i = 1; i < tableArray.length; i++){
    let obj = {};
    tableArray[i].forEach((item,index) => {
      obj[keys[index]] = isNaN(item * 1) ? item : item * 1;;
    });
    objs.push(obj);
  };
  return objs;
};
//对象组转制表文案
function tableObjToText(obj){
  let header = Object.keys(obj[0]).join('\t') + '\n';
  let values = '';
  for(let i = 0; i < obj.length; i++){
    let text = Object.values(obj[i]).join('\t');
    if(i == obj.length - 1){
      values += text;
    }else{
      values += text + '\n';
    }
  };
  return header + values;
};
//移除标签
clearTags.addEventListener('click',()=>{
  CreateImageInfo = [];
  CreateTableInfo = [];
  createTagsBox.innerHTML = '';
  cataloguesBox.innerHTML = '';
});
//文本框内容转标签/大纲
convertTags.addEventListener('click',()=>{
  clearTags.click();
  let firstline = userText.value.trim().split('\n')[0];
  let isTableText = !['name','w','h'].some(item => !firstline.includes(item));
  if(isTableText){
    let tableArray = tableTextToArray(userText.value.trim());
    let tableObj = tableArrayToObj(tableArray);
    CreateTableInfo = tableObj;
    if(CreateTableInfo.some(item => item.add) && !frameName.value.includes('add') && userTableTitle.value.includes('add')){
      document.getElementById('upload-moreset').checked = true;
      document.querySelector('[for="upload-moreset"]').click();
      document.querySelector('[data-option-value="add w×h s"]').click();
    } else if(CreateTableInfo.some(item => item.s) && !frameName.value.includes('s') && userTableTitle.value.includes('s')){
      document.getElementById('upload-moreset').checked = true;
      document.querySelector('[for="upload-moreset"]').click();
      document.querySelector('[data-option-value=" w×h s"]').click();
    };
    setTimeout(()=>{
      addTableTags();
    },100);
  }else if(firstline.includes('svg')){

  }
  else{
    tipsAll(['数据格式错误, 请检查~','Data format error, please check~'],3000)
  };
});
//从所选图层获取数据
getTableText.addEventListener('click',()=>{
  toolMessage(['','getTableBySelects'],PLUGINAPP);
});
//显示所上传文件名
function reFileInfo(files){
  let languge = ROOT.getAttribute('data-language');
  let fileLength = '<span style="color: let(--code2)">' + files.length + '</span>'
  let fileName1 = files.length == 1 ? files[0].name : files[0].name + ' ...等 ' + fileLength + '  个文件';
  let fileName2 = files.length == 1 ? files[0].name : files[0].name + ' ... ' + fileLength + ' files';
  fileName1 = '📁 ' + tool.TextMaxLength(fileName1,20,'..');
  fileName2 = '📁 ' + tool.TextMaxLength(fileName2,20,'..');
  fileInfo.setAttribute('data-zh-text',fileName1);
  fileInfo.setAttribute('data-en-text',fileName2);
  if(languge == "Zh"){
    fileInfo.innerHTML = fileName1;
  }else{
    fileInfo.innerHTML = fileName2;
  };
};
//设置画板命名格式
frameName.addEventListener('input',()=>{
  if(frameNmaeSelect.includes(frameName.value)){
    frameName.nextElementSibling.querySelector(`[data-option-value="${frameName.value}"]`).click();
  }else{
    frameName.nextElementSibling.querySelector(`[data-select-input]`).value = '';
  };
});
//设置画板数据表头规则
userTableTitle.addEventListener('change',()=>{
  userTableTitle.value = reTableTitle(userTableTitle.value);
});
function reTableTitle(text){
  if(text == ''){
    return '';
  }
  //首先必须是逗号隔开的单词形式
  let regex = /^[a-z]+$/;
  let texts = text.split(',');
  if(texts.some(item => !tableTitleMust.includes(item))){
    tipsAll(['请用指定单词, 并用逗号隔开','Must use example words and separated by commas'],3000);
    texts = texts.filter(item => tableTitleMust.includes(item));
    if(texts.length == 0){
      return 'name,w,h'
    } else {
      if(texts.includes('name') && texts.includes('w') && texts.includes('h')){
        return [...new Set(texts)].join(',');
      }else{
        texts = [...new Set(texts)];
        if(!texts.includes('name')){
          texts.push('name')
        };
        if(!texts.includes('w')){
          texts.push('w')
        };
        if(!texts.includes('h')){
          texts.push('h')
        }
        return texts.join(',');
      }
    }
  }else{ 
    if(texts.includes('name') && texts.includes('w') && texts.includes('h')){
      if(texts.length == [...new Set(texts)].length){
        return text;
      }else{
        tipsAll(['单词重复','The word is repeated'],3000);
        return [...new Set(texts)].join(',');
      }
    }else{
      tipsAll(['必须包含name、w、h','Must include name, w, h'],3000);
      texts = [...new Set(texts)];
      if(!texts.includes('name')){
        texts.push('name')
      };
      if(!texts.includes('w')){
        texts.push('w')
      };
      if(!texts.includes('h')){
        texts.push('h')
      }
      return texts.join(',');
    }
  }; 
};
//设置表格初始样式
chkTablestyle.addEventListener('change',()=>{
  chkTablestyle.checked = true;
  getElementMix('chk-selectcomp').checked = false;
  getElementMix('data-selectcomp-box').style.display = 'none';
  getElementMix('data-tablestyle-box').style.display = 'flex';
  toolMessage([false,'selectComp'],PLUGINAPP);
});
chkSelectcomp.addEventListener('change',()=>{
  chkSelectcomp.checked = true;
  getElementMix('chk-tablestyle').checked = false;
  getElementMix('data-tablestyle-box').style.display = 'none';
  getElementMix('data-selectcomp-box').style.display = 'flex';
  toolMessage([true,'selectComp'],PLUGINAPP);
});
function reSelectComp(info){
 //console.log(info)
 if(info[0] || info[1]){
  getElementMix('data-selectcomp-box').setAttribute('data-selectcomp-box','true')
  let comp1 = getElementMix('data-selectcomp-1');
  let comp2 = getElementMix('data-selectcomp-2');
  comp1.textContent = info[0] ? info[0] : 'none';
  comp1.style.opacity = info[0] ? '1' : '0.5';
  comp2.textContent = info[1] ? info[1] : 'none';
  comp2.style.opacity = info[1] ? '1' : '0.5';
 } else {
  getElementMix('data-selectcomp-box').setAttribute('data-selectcomp-box','false')
 };

};
createTableBtn.addEventListener('click',()=>{
  let comp1 = getElementMix('data-selectcomp-1').textContent;
  let comp2 = getElementMix('data-selectcomp-2').textContent;
  comp1 = comp1 == 'none' ? null : comp1;
  comp2 = comp2 == 'none' ? null : comp2;
  let styleId = tableStyleSet.getAttribute('data-radio-value') - 1;
  if(getElementMix('chk-tablestyle').checked){
    toolMessage([[tableStyle[styleId]],'creTable'],PLUGINAPP);
  }else{
    toolMessage([[tableStyle[styleId],comp1,comp2],'creTable'],PLUGINAPP);
  };
});
//上传|拖拽|输入 的规则说明
btnHelp.forEach(item => {
  item.addEventListener('click',()=>{
    let key = item.getAttribute('data-help');
    if(dailogBox.innerHTML.split(helpData[key][0][1].split('<')[0]).length == 1){
      dailogBox.innerHTML = '';
      let node = document.createElement('div');
      node.className = 'df-ffc';
      helpData[key].forEach(item =>{
        let line = document.createElement(item[0]);
        let span =  document.createElement('span');
        span.innerHTML = item[1].replace(/\/\+\+/g,`<span data-highlight>`).replace(/\+\+\//g,'</span>');
        span.setAttribute('data-en-text',item[2].replace(/\/\+\+/g,`<span data-highlight>`).replace(/\+\+\//g,'</span>'));
        line.appendChild(span)
        if(item[0] == 'li'){
          line.setAttribute('data-li-style','2');
        };
        node.appendChild(line);
      });
      dailogBox.appendChild(node);
      //最后重置下语言
      if(ROOT.getAttribute('data-language') == 'En'){
        setLanguage(true);
        setLanguage(false);
      };
      //重置文字样式
      loadFont(dailogBox);
    };
    dailog.style.display = 'flex';
  });
});
//点击弹窗外关闭弹窗
dailog.addEventListener('click',(e)=>{
  if(!dailogBox.contains(e.target)){
    dailog.style.display = 'none';
  };
});
//收藏功能
skillStar.forEach(item =>{
  item.addEventListener('click',()=>{
    let isStar = item.getAttribute('data-skill-star');
    let skillId = item.parentNode.getAttribute('data-skill-sec');
    let cover = document.querySelector(`[data-skill-cover="${skillId}"]`);
    let skillNode = document.querySelector(`[data-skill-sec="${skillId}"]`);
    if(isStar == "true"){
      item.setAttribute('data-skill-star','false');
      cover.parentNode.insertBefore(skillNode,cover);
      userSkillStar = userSkillStar.filter(id => id !== skillId);
      storageMix.set('userSkillStar',JSON.stringify(userSkillStar));
      cover.remove();
    } else {
      let numModel = skillNode.parentNode.getAttribute('data-skillnum');
      if(numModel == 2){
        tipsAll(['禁止收藏整个模块的功能',"Don't star all functions of same module"],3000,4)
      }else{
        moveSkillStar([skillId]);
        userSkillStar.push(skillId);
        storageMix.set('userSkillStar',JSON.stringify(userSkillStar));
      }
    };
    reSkillNum();
    skillNode.scrollIntoView({
      behavior: 'smooth',
      block: 'center',
      inline: 'nearest',
    });
  });
});
function moveSkillStar(stars){
  stars.forEach(item => {
    let skillNode = document.querySelector(`[data-skill-sec="${item}"]`);
    if(skillNode){
      let cover = document.createElement('div');
      cover.setAttribute('data-skill-cover',item);
      cover.setAttribute('style','display: none');
      skillNode.parentNode.insertBefore(cover,skillNode);
      skillStarModel.prepend(skillNode);
      let star = skillNode.querySelector('[data-skill-star]');
      star.setAttribute('data-skill-star','true')
    };
  });
};
function reSkillNum(){
  let models = document.querySelectorAll('[data-skillmodule]');
  models.forEach(model => {
    let skills = model.querySelectorAll('[data-skill-sec]');
    model.setAttribute('data-skillnum',skills.length);//剩一个时不能继续收藏
    model.setAttribute('data-skillnum-odd',skills.length%2);//单数显示占位, 排版好看些
  });
};
//重置全部
document.querySelectorAll('[data-reset-all]').forEach(reall => {
  reall.addEventListener('click',()=>{
    let btnReAll = reall.parentNode.parentNode.querySelectorAll('[data-input-reset]');
    btnReAll.forEach(item =>{
      item.click();
    });
  });
});
//栅格化像素倍率绑定
pixelScale.addEventListener('change',()=>{
  let set = document.querySelector('[data-pixelscale-set]');
  let sets = set.querySelectorAll('[data-radio-data]');
  let num = [];
  sets.forEach(item => {
    num.push(item.getAttribute('data-radio-data'));
  })
  if(num.includes(pixelScale.value)){
    set.querySelector(`[data-radio-data="${pixelScale.value}"]`);
  }else{
    num.forEach(item => {
      set.querySelector(`[data-radio-data="${item}"]`).setAttribute('data-radio-main','false')
    });
  };
});
//返回裁切方案以栅格化
skillAllBox.querySelector('[data-pixel-copy]').addEventListener('click',()=>{
  
});
//点击即执行的功能
skillBtnMain.forEach(btn => {
  btn.addEventListener('click',()=>{
    let skillname = btn.getAttribute('data-en-text');
    switch (skillname){
      case 'Pixel As Copy':sendPixel(skillname);break
      case 'Pixel Overwrite':sendPixel(skillname);break
      case 'Reset All Transform':;break
      default : toolMessage(['',skillname],PLUGINAPP);break
    }
  });
  btn.addEventListener('dblclick',()=>{
    let skillname = btn.getAttribute('data-en-text');
    switch (skillname){
      case 'Arrange By Ratio': toolMessage([true,skillname],PLUGINAPP);;break
    };
  });

  function sendPixel(name){
    //返回裁切方案以栅格化
    let mix = skillAllBox.querySelector('[data-pixel-mix]').getAttribute('data-select-value').split('≤ ')[1].split('px')[0]*1;
    let s = pixelScale.value;
    let cuts = [];
    tipsAll(['读取中, 请耐心等待','Reading, please wait a moment'],SelectNodeInfo.length * 800);
    setTimeout(()=>{
      SelectNodeInfo.forEach((item) => {
      let w = item[1];
      let h = item[2];
      let cut = tool.CUT_AREA({w:w,h:h,x:0,y:0,s:s},mix);
      cuts.push(cut);
    });
    //console.log(cuts);
    toolMessage([cuts,name],PLUGINAPP);
    },100);
  };
});


/**
 * 模拟点击tab切换页面, 测试时更方便, 能直接显示目标页面
 * @param {string} name - 应该传入tab的英文名
 */
function viewPage(name){
  let tab = document.getElementById(`tab_${name}_0`);
  tab.checked = true;
  let inputEvent = new Event('change',{bubbles:true});
  tab.dispatchEvent(inputEvent);
};


/* ---钩子--- */

/*监听组件的自定义属性值, 变化时触发函数, 用于已经绑定事件用于自身的组件, 如颜色选择器、滑块输入框组合、为空自动填充文案的输入框、导航tab、下拉选项等*/
let observer = new MutationObserver((mutations) => {
  mutations.forEach((mutation) => {
    if(mutation.type === 'attributes'){
      switch(mutation.attributeName){
        case 'data-tab-pick':getUserTab(mutation.target); break;
        case 'data-color-hex':getUserColor(mutation.target); break;
        case 'data-number-value':getUserNumber(mutation.target); break;
        case 'data-text-value':getUserText(mutation.target); break;
        case 'data-select-value':getUserSelect(mutation.target); break;
        case 'data-radio-value':getUserRadio(mutation.target); break;
      }
    }
  })
});
let userEvent_tab = document.querySelectorAll('[data-tab-pick]');
userEvent_tab.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-tab-pick']};
  observer.observe(item,config);
});
let userEvent_color = document.querySelectorAll('[data-color]');
userEvent_color.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-color-hex']};
  observer.observe(item,config);
});
let userEvent_number = document.querySelectorAll('[data-number]');
userEvent_number.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-number-value']};
  observer.observe(item,config);
});
let userEvent_text = document.querySelectorAll('[data-text]');
userEvent_text.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-text-value']};
  observer.observe(item,config);
});
let userEvent_select = document.querySelectorAll('[data-select]');
userEvent_select.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-select-value']};
  observer.observe(item,config);
});
let userEvent_radio = document.querySelectorAll('[data-radio-value]');
userEvent_radio.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-radio-value']};
  observer.observe(item,config);
});

/**
 * @param {Element} node -带有data-tab-pick值的元素, 用于记录用户关闭前所选的tab
 */
function getUserTab(node){
  let tabPick = node.getAttribute('data-tab-pick').split('tab_')[1]
  if(tabPick){
    storageMix.set('tabPick',tabPick);
    if(tabPick == 'more tools'){
      toolMessage(['','selectInfo'],PLUGINAPP);
    }
  }
};

function getUserColor(node){
  let color = {
    HEX:node.getAttribute('data-color-hex'),
    RGB:node.getAttribute('data-color-rgb'),
    HSL:node.getAttribute('data-color-hsl'),
    HSV:node.getAttribute('data-color-hsv'),
  }
  //console.log(color)
};

function getUserNumber(node){
  let number = node.getAttribute('data-number-value');
  if(node.getAttribute('data-skewset-x') !== null){
    node.parentNode.parentNode.parentNode.style.setProperty('--skewX',number)
  };
  if(node.getAttribute('data-skewset-y') !== null){
    node.parentNode.parentNode.parentNode.style.setProperty('--skewY',number)
  };
  if(node.getAttribute('data-scaleset-x') !== null){
    node.parentNode.parentNode.parentNode.style.setProperty('--scaleX',number)
  };
  if(node.getAttribute('data-scaleset-y') !== null){
    node.parentNode.parentNode.parentNode.style.setProperty('--scaleY',number)
  };
};

function getUserText(node){
  let text = node.getAttribute('data-text-value');
  //console.log(text)
};

function getUserSelect(node){
  let userSelect = node.getAttribute('data-select-value');
  if(userSelect){
    if(node.previousElementSibling == frameName){
      frameName.value = userSelect;
    };
  };
};

function getUserRadio(node){
  let userRadio= node.getAttribute('data-radio-value');
  if(userRadio){
    if(node.getAttribute('data-pixelscale-set') !== null){
      pixelScale.value = userRadio;
    };
    if(node.getAttribute('data-clip-w-set') !== null){
      let set = node.parentNode.parentNode.querySelector('[data-clip-w]');
      let sets = set.querySelectorAll('[data-clip-set]');
      set.setAttribute('data-clip-w',userRadio);
      sets.forEach(item => {
        item.setAttribute('style','');
      });
    };
    if(node.getAttribute('data-clip-h-set') !== null){
      let set = node.parentNode.parentNode.querySelector('[data-clip-h]');
      let sets = set.querySelectorAll('[data-clip-set]');
      set.setAttribute('data-clip-h',userRadio);
      sets.forEach(item => {
        item.setAttribute('style','');
      });
    };
    if(node.getAttribute('data-skilltype-box') !== null){
      let modelid = skillModel[userRadio - 1][1];
      //console.log(modelid);
      let model = skillAllBox.querySelector(`[data-skillmodule="${modelid}"]`);
      let skillnode = model.querySelector('[data-skill-sec]');
      if(isSkillScroll){
        skillnode.scrollIntoView({
          behavior: 'smooth',
          block: 'center',
          inline: 'nearest',
        });
      };
    };
  }
};

</script>
</body>
</html>