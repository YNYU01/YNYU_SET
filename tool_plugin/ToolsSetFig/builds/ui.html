<html data-plugin="fig" data-theme="dark" data-language="Zh" data-mobile="false">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/builds/yn_style.css"  >
  <!-- INLINE_CSS -->
  <style>
@font-face {
  font-family: Shanggu Sans;
  src: url("https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/fonts/other/ShangguSans-Regular.otf") format('opentype');
  font-weight: 400;
  font-display: swap;;
}

:root{
  --top-h: 24px;
  --bottom-h: 32px;
  --option-font: 12px;
  --pointer:url('https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/VI/pointer_24.png'),auto;
  --code3:#48a64d;
  --code4:#b677b1;
  --code5:#a66e48;
  --code6:#77b6b6;
  --code7:#a64848;
  --code8:#527ac4;
  --code9:#e09524;
  --code10:#ec657c;
}

html{
  cursor: url('https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@ba19c5d927f0c9cc1bb1647b224fb58667102074/VI/cursor_16.png'),auto;
}

* {
  cursor: inherit;
}

body{
  min-width: 200px;
}

/*--ç»„ä»¶ä¿®æ”¹*/
.show-next{
  margin:0 2px 0 -2px;
  cursor: var(--pointer,pointer);
}

.show-next::after {
  transform-origin: 40% 40%;
}

p [data-highlight]{
  color: var(--themeColor)
}

[data-radio]{
  width: fit-content;
  height: fit-content;
  flex: 0 0 auto;
  border: none;
  background: none;
  padding: 0.5ch 0;
}

[data-radio-main]:hover {
  background: var(--boxGry);
}

[data-theme="dark"] [data-radio-main="true"] {
  --mainColor: inherit;
  background: var(--boxGry);
}

[data-resize]::after {
  pointer-events: none;
}

[data-option="type"] {
  padding: 1ch 0 0.5ch 1ch;
}

[data-option="option"] {
  padding: 0.5ch 0 0.5ch 3ch;
}

[data-language="En"] [data-tips]::after{
  content: var(--tips-text-en,'something there');
}

[data-mode-id="upload"] [data-tips-x="left"]::after,
#upload-set-main [data-tips-x="left"]::after,
#upload-moreset-box [data-tips-x="left"]::after{
  --x: -20px;
}

[data-mode-id="upload"] [data-tips-x="right"]::after {
  --x: calc(-100% + 70px);
}

[data-mode-id="upload"] [data-tips-x="center"]::after,
#upload-set-main [data-tips-x="center"]::after {
  --x:calc(-50% + 20px)
}


[data-tips-x="right"]::after {
  --x: calc(-100% + 40px);
}

#tips-all{
  display: none;
  justify-content: center;
  align-items: center;
  position: absolute;
  width: 100%;
  bottom: 80px;
  margin: auto;
  animation: boxUp 0.2s;
  z-index: 20;
  pointer-events: none;
}

.tips-all-text{
  color: #ffffff;
  background: rgba(0, 0, 0, 0.8);
  padding: 4px 8px;
  border-radius: 8px;
}

.switch [data-swi-icon]{
  transition:transform 0.2s ease-out;
  }
  
input[type="checkbox"]:checked+.switch [data-swi-icon]{
  transform: translateX(var(--swi-h,18px));
}
/*ç»„ä»¶ä¿®æ”¹--*/

html[data-language="En"] {
  --mainFontSize: 10px;
}

html[data-language="Zh"] {
  --mainFontSize: 12px;
}

body{
  font-size: var(--mainFontSize);
}

#top{
  height: var(--top-h);
  position: relative;
}

#top::after{
  content: '';
  position: absolute;
  bottom: -1px;
  width: 100%;
  height: 1px;
  background: var(--boxBod);
  opacity: 0.5;
}

#bottom{
  height: var(--bottom-h);
  bottom: 0;
}

#bottom::before{
  content: '';
  position: absolute;
  top: -1px;
  width: 100%;
  height: 1px;
  background: var(--boxBod);
  opacity: 0.5;
}

[data-tab-for="page"]{
  gap: 4px;
  padding-left: 2%;
}

.tab-top{
  padding: 2px 4px;
  border-radius: 4px;
  text-transform: capitalize;
  opacity: 0.5;
}

input[type="checkbox"]:checked + .tab-top{
  opacity: 1;
  background: var(--swi-bak);
}

[data-page-id="page"]{
 height: calc(100vh - var(--bottom-h) - var(--top-h));
}

[data-tv-box]{
  display: flex;
  align-items: center;
  width: calc(100% - 10px);
  font-size: 10px;
}

[data-tv-text]::before,
[data-tv-text]::after{
  content: 'â¤';
  color: rgb(248, 153, 169);
  width: 10px;
  height: 10px;
  padding: 1px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 auto;
  transform: scale(0.8);
  animation: heartUp 0.5s cubic-bezier(0,10,1,1) infinite;
}

@keyframes heartUp {
  to{
    transform: scale(0.86);
  }
}

.btn-big{
  width: 12px;
  height: 12px;
  margin-left: 2px;
  cursor: var(--pointer,pointer);
}

input[type="checkbox"]:checked+.btn-big .path1 {
  transform: translateY(6px) translateX(-6px);
}

input[type="checkbox"]:checked+.btn-big .path2 {
  transform: translateX(6px) translateY(-6px);
}

[data-side]{
  left: 0;
  z-index: 11;
  /*animation: topTabUp 0.5s;*/
}

[data-side-mix]{
  width: 200px;
  background: var(--boxGry);
  padding: 10px 10px;
  justify-content: space-between;
  display: none;
  overflow: hidden;
}


@keyframes sideUp {
  0%{
    width: 0;
  }
  100%{
    width: 200px;
  }
}

@keyframes sideOver {
  0%{
    width: 200px;
    padding-left: 10px;
  }
  100%{
    width: 0;
    padding-left: 0px;
  }
}

@keyframes topTabUp {
  0%{
    transform: translateY(calc(var(--top-h) * -1));
  }
  100%{
    transform: translateY(0%);
  }
}

[data-icon-more]{
  transition: transform 0.4s;
}

input[type="checkbox"]:checked + label [data-icon-more]{
  transform: rotate(90deg);
}

[data-icon-more-path]{
  stroke: var(--mainColor);
  stroke-width: 2;
  transition: transform 0.2s;
}

[data-icon-more-path="1"]{
  transform: matrix(1,0,0,1,1,4);
}
[data-icon-more-path="2"]{
  transform: matrix(1,0,0,1,1,10);
}
[data-icon-more-path="3"]{
  transform: matrix(1,0,0,1,1,16);
}

input[type="checkbox"]:checked + label [data-icon-more-path="1"]{
  transform: matrix(0.7,0.7,-0.7,0.7,3.64,3.64);
}
input[type="checkbox"]:checked + label [data-icon-more-path="2"]{
  transform: matrix(0.1,0,0,1,10,10);
}
input[type="checkbox"]:checked + label [data-icon-more-path="3"]{
  transform: matrix(0.7,-0.7,0.7,0.7,3.64,16.37);
}

#btn-theme,#btn-theme-2{
  width: 20px;
  height: 20px;
  padding: 4px;
  box-sizing: border-box;
  background: var(--swi-bak);
  border-radius: 4px;
  border: 1px solid var(--boxBod);
}

[data-mainset-top]{
  display: none;
}

.btn-more{
  width: 16px;
  height: 16px;
  opacity: 0.6;
  cursor: var(--pointer,pointer);
}

[data-mainset-side]{
  gap:4px;
  padding: 10px 0;
  border-top: 1px solid var(--boxBod);
}

[data-language="Zh"] [data-any="en"]{
  display: none;
}

[data-language="En"] [data-any="zh"]{
  display: none;
}

[data-resize-window]{
  content: '';
  position: absolute;
  cursor:nw-resize;
  bottom: 2px;
  right: 2px;
  width: 8px;
  height: 8px;
  background: linear-gradient(to top left,
  transparent 20%,
  var(--boxBod) 21%,
  var(--boxBod) 25%,
  transparent 26%,
  transparent 45%,
  var(--boxBod) 46%,
  var(--boxBod) 50%,
  transparent 51%);
}

[data-tv-box]{
  padding: 0 4px;
}

[data-tv-cut]{
  height: 18px;
  border-radius: 10px;
  background:  rgba(0, 0, 0, 0.8);
  --mainColor: #b9b9b9;
  color: var(--mainColor);
  margin-top: 2px;
}

[data-theme="dark"] [data-tv-cut]{
  --mainColor: #9b9b9b;
}

[data-btn-name]{
  opacity: 0.6;
  white-space: initial;
  text-align: center;
}


/*--æŒ‰é’®ç±»*/
[data-btn]{
  max-width: 580px;
  padding: 2px 0;
  border: 1px solid var(--boxBod);
  box-sizing: border-box;
  cursor: var(--pointer,pointer);
}

[data-btn]:hover{
  background: var(--boxGry);
}

[data-btn]:active{
  transform: translateY(1px);
}

[data-btn="main"]{
  width: calc(100% - 20px);
  border-radius: 20px;
  background: var(--boxGry);
}

[data-btn="main"]:hover{
  background: var(--boxBod);
}

[data-btn="skill"]{
  border-radius: 8px;
}

[data-btn="help"]{
  margin: 6px 0;
  padding: 0;
  --boxBod: var(--themeColor);
  background: var(--themeColor);
  border-radius: 20px;
  color: #000;
}

[data-btn="help"]:hover{
  background: var(--code1);
}

[data-btn="icon"]{
  display: block;
  width: 40px;
  height: 40px;
  background: none;
  border: none;
}

[data-btn="icon"]:hover{
  background: none;
  opacity: 0.5;
}

[data-btn="moreset"]{
  width: 40px;
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border-radius: 4px;
  border: 1px solid var(--boxBod);
}

[data-btn="moreset"]:hover{
  background: var(--boxGry);
}

input[type="checkbox"]:checked + .btn-moreset:hover{
  background: var(--themeColor);
  --mainColor: #242424;
}


.btn-moreset{
  width: 40px;
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border-radius: 4px;
  border: 1px solid transparent;
  background: var(--themeColor);
  --mainColor: #242424;
  cursor: var(--pointer,pointer);
}


input[type="checkbox"]:checked + .btn-moreset{
  background: transparent;
  border: 1px solid var(--boxBod);
  --mainColor: var(--boxBod);
}

[data-help]{
  width: 12px;
  height: 12px;
  border: 1px solid var(--boxBod); 
  border-radius: 50%;
  font-size: 10px;
  color: var(--boxBod);
  cursor: var(--pointer,pointer);
  margin-left: 4px;
}

[data-skilltype-icon]{
  width: 40px;
  height: 40px;
  padding: 4px;
  box-sizing: border-box;
  flex: 0 0 auto;
}

/*æŒ‰é’®ç±»--*/

/*--æ¨¡å—ç±»*/
[data-dailog]{
  display: none;
  width: 100vw;
  height: 100vh;
  padding: 50px 20px;
  background: rgba(0, 0, 0, 0.6);
  z-index: 12;
  gap: 4px;
  text-wrap: wrap;
}

[data-dailog-box] p{
  font-size: 11px;
}

[data-dailog-box] li{
  opacity: 0.6;
}

[data-dailog-box] p::before{
  content: 'ğŸ‘‰ ';
}
[data-dailog-box] p::after{
  content: ':';
}

[data-dailog-close]{
  width: 80%;
  max-width: 360;
}

[data-dailog-close] [data-close]{
  width: 20px;
  height: 20px;
}

[data-dailog-box]{
  width: 80%;
  height: 70%;
  max-width: 360;
  padding: 2% 4%;
  box-sizing: border-box;
  border-radius: 10px;
  border: 1px solid var(--boxBod);
  background: var(--boxGry); 
  gap: 4px;
}

.bod-d{
  border: 1px var(--boxBod) dashed;
  border-radius: 10px;
}
[data-drop="upload"]{
  max-width: 560px;
  /*filter: drop-shadow(0 0 var(--drop-w,0) var(--mainColor));*/
}
[data-mode-id="upload"]{
  visibility: var(--drop-df,visible)/*collapse*/;
  gap: 10px;
  padding: 10px;
  font-size: 10px;
}
.file-tag{
  visibility: var(--drop-df,visible)/*collapse*/;
  border-radius: 0 0 10px 10px;
  background: var(--boxGry);
  padding: 2px 8px;
  font-size: 10px;
}
.upload-set{
  height: 40px;
  padding: 8px;
  box-sizing: border-box;
  border: 1px solid var(--boxBod);
  border-radius: 4px;
}
.nobod {
  --boxBod: transparent;
}

#upload-textarea{
  height: 180px;
  min-height: 180px;
  resize: vertical;
  padding: 4px 10px;
}

#upload-set-box{
  width:100%;
  justify-content: space-between;
}

#upload-set-main{
  gap: 4px;
}

[data-resize]::-webkit-resizer{
  display: none;
}

[data-skilltype-box]{
  max-width: 560px;
  height: 70px;
  padding: 0 10px;
  gap: 6px;
}
[data-language="En"] [data-skilltype-box]{
  gap: 4px;
}

[data-skilltype-name]{
  font-size: 10px;
  line-height: 1.25em;
  text-wrap: wrap;
}

[data-skillModel]{
  border-top: 1px solid var(--boxBod);
  box-sizing: border-box;
  min-height: 180px;
}

/*æ¨¡å—ç±»--*/

/*--çº¹ç†ç±»*/
.tex-dot{
  --dot-wh: 1px;
  --dot-gap: 10px;
  background: 
  repeating-radial-gradient(
    circle at center,
    var(--dot-col) 0,
    var(--dot-col) var(--dot-wh),
    transparent var(--dot-wh),
    transparent calc(var(--dot-gap)*2)), var(--boxBak);
  background-size: var(--dot-gap) var(--dot-gap);
}
/*çº¹ç†ç±»--*/

@keyframes loadRo2 {/*æ—‹è½¬*/
  0%{
    transform: rotate(0deg);
  }
  100%{
    transform: rotate(-180deg);
  }
}

@media (max-width:460px) {
  [data-language="En"] [data-skillType-name]{
    max-width: 50px;
  }
}

@media (min-width:420px) {
  [data-mainset-top]{
    display: flex;
  }

}

@media (max-width:359px) {
  #upload-textarea-box{
    width: 100%;
    flex: 0 0 auto;
  }
  [data-language="Zh"] [data-skillType-name]{
    max-width: 5ch;
  }
  

}

@media (min-width:360px) {
  #upload-set-box{
    width: 40px;
  }
  #upload-set-main{
    width: 40px;
    height: calc(100% - 40px);
    flex-flow: column;
  }
  #upload-set-main [data-tips-x="left"]::after,
  #upload-set-main [data-tips-x="center"]::after {
    --x: calc(-100% + 40px);
  }

  [data-radio]{
    padding: 0.5ch;
  }
}
@media (max-width:299px) {
  [data-any="vw300"]{
    display: none;
  }
  [data-tips]::after{
    display: none;
  }
  
}
@media (min-width:300px) {
  [data-skillType-box]{
    justify-content: center;
    height: 100px;
  }
}

@media (max-width:239px) {
  [data-any="vw240"]{
    display: none;
  }

  [data-mainset-top]{
    display: flex;
  }

}

</style>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/public/run.js"></script>
  <!-- INLINE_RUN -->
  <script>
PULGIN_LOCAL = true;
if (ISPLUGIN){
  ROOT.setAttribute('data-mobile','false');
  ISMOBILE = false;
  toolMessage(['userTheme','getlocal'],PLUGINAPP);
  toolMessage(['userLanguage','getlocal'],PLUGINAPP);
  toolMessage(['tabPick','getlocal'],PLUGINAPP);
}

window.addEventListener('message',(message)=>{
  let isPluginMessge = message.data && message.data.type && message.data.type == 'figma-ex-page-info';
  if(!isPluginMessge){
    let messages = message.data.pluginMessage.pluginMessage || ['',''];
    let info = messages[0];
    let type = messages[1];
    switch (type){
      case 'userTheme': info == 'light' ? setTheme(true,false) : setTheme(false,false);break
      case 'userLanguage': info == 'Zh' ? setLanguage(true) : setLanguage(false);break
      case 'tabPick': viewPage(info);break
    }
  }
});

/**
 * @param {Array} data - [info,typeName/skillName]
 * @param {string} app - PLUGINAPP(éœ€å®šä¹‰) | 'fig' | 'mg'
 */
function toolMessage(data,app){
  switch (app){
    case 'fig': parent.postMessage({pluginMessage:data},"*"); break
    case 'mg' : parent.postMessage(data,"*");break
  }
}


</script>
</head>

<body class="noselect df-ffc df-cc">
  <!--é¡¶éƒ¨-->
  <div id="top" class="w100 df-sc">
    <div data-any="vw240" class="fl0" style="width: 24px; height: 24px;"></div>
    <div data-mainset-top class="df-lc" style="gap: 4px; margin-left: 2px;">
      <div id="btn-theme-2">
        <input id="theme-2" data-theme-check type="checkbox" checked="true">
        <label for="theme-2" class="btn-theme" style="position: relative;">
          <btn-theme></btn-theme>
        </label>
      </div>
      <input id="language-2" data-language-check type="checkbox" checked="true"/>
      <label for="language-2" class="switch pos-a" style="--swi-h:18px; --swi-r:6px; --swi-af:var(--mainColor);">
        <div class="pos-a" data-swi-icon style="top:3px; left: 2px; width: 11px; height: 11px; z-index: 2;">
          <svg style="margin: auto 1px;" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 22 22">
            <path fill="var(--boxBod)" d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2"></path>
          </svg>
        </div>
      </label>
    </div>
    <!--å…¬å‘Šæ -->
    <div data-tv-box data-any="vw240"  class="df-lc">
      <div data-tv-cut class="TV df-lc" >
        <div data-tv="true" class="df-lc" style="--tv-w: -29ch; --tv-s: 37s;">
          <div data-tv-text data-en-text="ğŸ’¬NOTICE:Please note the following">ğŸ’¬å…¬å‘Š:å…¬å‘Šå†…å®¹å…¬å‘Šå†…å®¹å…¬å‘Šå†…å®¹</div>  
        </div>  
      </div> 
    </div>
    <div class="df-cc" style="gap:4px; margin-right: 2%; font-size: 12px;">
      <input id="big" type="checkbox">
      <label for="big" class="btn-big df-cc">
        <btn-show></btn-show>
      </label>
    </div>
  </div>
  <!--å…¨å±€tips-->
  <div id="tips-all">
    <div id="tips-all-text" class="tips-all-text" ></div>
  </div>
  <!--å¼¹çª—-->
  <div data-dailog data-close-id="dailog" class="pos-a df-ffc df-cc">
    <!--å…³é—­-->
    <div data-dailog-close class="df-rc">
      <div data-close="close" data-close-for="dailog">
        <btn-close></btn-close>
      </div>
    </div>
    <div data-dailog-box class="ovy scrollbar df-ffc">
      <!--ç”Ÿæˆå†…å®¹-->
    </div>
    
  </div>
  <!--ä¾§è¾¹æ -->
  <div data-side data-any="vw240" class="df pos-a" style="top: 0; left: 0; --fill: var(--mainColor)">
    <div data-side-mix class="df-ffc" style="height: calc(100vh - 20px)">
      <div class="h100 df-ffc" style="justify-content: space-between;">
        <div ></div>
        <a class="df-cc" data-btn="help">
          <div data-en-text="HELP DOC">å¸®åŠ©æ–‡æ¡£</div>
          <div style="width:20px; height:20px; --arrow-w:2; transform:translate(2px,1px) rotate(-45deg);">
            <svg width="100%" height="100%" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.71411 11.3821H20.7141" stroke="#000" stroke-width="var(--arrow-w)" stroke-linecap="round"></path>
              <path d="M13.3421 4.38208L20.7141 11.3821L13.3421 18.3821" stroke="#000" stroke-width="var(--arrow-w)"></path>
            </svg>
          </div>
        </a>
      </div>
      <div data-mainset-side class="df-sc">
        <a href="https://www.ynyuset.cn" target="_blank" class="fl1 df-lc"
        data-tips="set" data-tips-y="top" data-tips-x="left" 
        style="--tips-gap: -16px; --tips-text: 'ğŸ”—https://www.ynyuset.cn'; --tips-text-en: 'https://www.ynyuset.cn';
        gap: 2px; color: var(--mainColor); font-size: 10px;">
          Â©2024-2025 
          <set-en data-any="en" class="fl0" style="height: 20px; margin-top: -2px;"></set-en>
          <set-zh data-any="zh" class="fl0" style="height: 20px; margin-top: -3px;"></set-zh>
        </a>
        <div class="df-lc" style="gap: 4px;">
          <div id="btn-theme">
            <input id="theme-1" data-theme-check type="checkbox" checked="true">
            <label for="theme-1" class="btn-theme" style="position: relative;">
              <btn-theme></btn-theme>
            </label>
          </div>
          <input id="language-1" data-language-check type="checkbox" checked="true"/>
          <label for="language-1" class="switch pos-a" style="--swi-h:18px; --swi-r:6px; --swi-af:var(--mainColor);">
            <div class="pos-a" data-swi-icon style="top:3px; left: 2px; width: 11px; height: 11px; z-index: 2;">
              <svg style="margin: auto 1px;" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 22 22">
                <path fill="var(--boxBod)" d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2"></path>
              </svg>
            </div>
          </label>
        </div>
      </div>
    </div>
    
    <div class="df-cc" style="width: 24px; height: 24px; background: var(--boxGry);">
      <input id="btn-more" type="checkbox" />
      <label for="btn-more" class="btn-more" >
        <svg data-icon-more width="100%" height="100%" viewBox="0 0 20 20">
          <g data-icon-more-path="1" >
            <path fill="none" d="M18 0L0 0"></path>
          </g>
          <g data-icon-more-path="2">
            <path fill="none" d="M18 0L0 0"></path>
          </g>
          <g data-icon-more-path="3">
            <path fill="none" d="M18 0L0 0"></path>
          </g>
        </svg>
      </label>
    </div>
  </div>
  <!--ä¾§è¾¹æ é®ç½©-->
  <div data-side-mask class="wh100 pos-a" style="display: none;  z-index: 10">
    <div class="wh100" style="background: rgba(0,0,0,0.3); backdrop-filter: blur(2px);"></div>
  </div>
  
  <!--åŠŸèƒ½é¡µé¢-->
  <div class="df-ffc w100 df-cc">
    <div data-page-id="page" class="df-ffc w100" data-tab-pick="create">
      <div data-page-name="åˆ›å»º" data-page-name-en="create" data-page-main="true" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: flex;">
        <div class="w100 df-ffc ovy noscrollbar" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
          <div class="w100 df-ffc" style="align-items: center;">
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>â–¼&nbsp;</span>
              <span data-en-text="Upload | Drop | Input" >ä¸Šä¼  | æ‹–æ‹½ | è¾“å…¥</span>
              &nbsp;&nbsp;
              <span data-any="vw300" data-en-text="data to create node in batches" style="opacity: 0.6;"> æ•°æ®ä»¥æ‰¹é‡åˆ›å»ºå†…å®¹</span>
              <div data-any="vw300" data-help="create" class="fl0 df-cc">?</div>
            </div>
            <div data-drop="upload" class="w100 df-ffc df-cc bod-d">
              <div class="w100 df-cc">
                <div data-file-info class="file-tag" data-en-text="ğŸ“ No files there">ğŸ“ æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶</div>
              </div>
              <div data-mode-id="upload" class="df-cc">
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-img" type="file" accept="image/*" style="display: none;" multiple/>
                  <label for="input-user-img" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text: 'å¯ä¸Šä¼ 1~10å¼ å¤§å›¾ï¼Œæ”¯æŒå¸¸è§å›¾ç‰‡æ ¼å¼'; --tips-text-en: 'Upload 1~10 large images (common formats)';" >
                    <btn-user-img  data-btn="icon" ></btn-user-img>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Cut large image">å¤§å›¾è‡ªåŠ¨åˆ‡ç‰‡</div>
                </div>
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-table" type="file" accept=".csv,.xls,.xlsx"  style="display: none;"/>
                  <label for="input-user-table" data-tips="auto" data-tips-y="top" data-tips-x="center"
                  style="--tips-text: 'ä¸Šä¼ å•ä¸ªè¡¨æ ¼ï¼Œéœ€æŒ‰ä¸€å®šæ ¼å¼å¡«å†™'; --tips-text-en: 'Upload 1 table in the prescribed format';" >
                    <btn-user-table data-btn="icon"></btn-user-table>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Table to frame">è¡¨æ ¼åˆ›å»ºç”»æ¿</div>
                </div>
                <div class="df-ffc df-cc" style="gap: 4px;">
                  <input id="input-user-zy" type="file" accept=".zy,.sketch,.xml,.json,.zip,.rar,.7z" style="display: none;"/>
                  <label for="input-user-zy" data-tips="auto" data-tips-y="top" data-tips-x="right"
                  style="--tips-text: 'ä¸Šä¼ ç”±äº‘å³ç³»åˆ—æ’ä»¶ç”Ÿæˆçš„å›¾å±‚ä¿¡æ¯æ–‡ä»¶'; --tips-text-en: 'Upload .zy (by YN+) or other compatible file';" >
                    <btn-user-zy data-btn="icon"></btn-user-zy>
                  </label>
                  <div data-btn-name data-any="vw300" data-en-text="Layers frome .zy">å…¼å®¹æ ¼å¼å¯¼å…¥</div>
                </div>
              </div>
            </div>
            <div class="w100 df" style="flex-wrap: wrap; max-width: 560px; margin: 4px 0; gap: 4px;">
              <div id="upload-textarea-box" data-resize class="pos-r fl1" style="min-width: 180px;">
                <textarea id="upload-textarea" data-textarea="eg" 
                data-eg="kv\t1920\t1080\nbanner\t1200\t300\nload\t1080\t1640\nicon\t256\t256"
                data-eg-en="kv\t1920\t1080\nbanner\t1200\t300\nload\t1080\t1640\nicon\t256\t256"
                onfocus="
                  this.parentNode.parentNode.querySelector('btn-re').style.animation = 'loadRo2 2s linear infinite';
                "
                onblur="
                  this.parentNode.parentNode.querySelector('btn-re').style.animation = '';
                "></textarea>
                <!--æ¸…ç©º-->
                <div class="pos-a" data-close="clear" style="right: 4px; top:4px; width: 12px; height: 12px;">
                  <btn-close></btn-close>
                </div>
                <div data-textarea="tips" class="pos-a w100 df-ffc" style="white-space: wrap; gap: 4px; font-size: 10px; color: var(--boxBod); bottom: 0; padding: 10px; box-sizing: border-box; animation: boxUp 0.5s; pointer-events: none;">
                  <li data-li-style="2" data-en-text="Double click fill sample" >åŒå‡»å¡«å……ç¤ºä¾‹</li>
                  <li data-li-style="2" data-en-text="Copy from a sheet or manually input with tab character(key)" >ä»è¡¨æ ¼å¤åˆ¶æˆ–ç”¨åˆ¶è¡¨ç¬¦ï¼ˆtabé”®ï¼‰æ‰‹åŠ¨è¾“å…¥</li>
                </div>
              </div>
              <div id="upload-set-box" class="df" style="flex-wrap: wrap; max-width: 560px; margin:0 0 4px 0; gap: 4px;">
                <div id="upload-set-main" class="df">
                  <div id="upload-set-1" data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text:'è½¬ä¸ºæ ‡ç­¾/å¤§çº²';  --tips-text-en:'Convert to tags/catalogue';">
                    <btn-re class="df-cc wh100"></btn-re>                   
                  </div>
                  <div id="upload-set-2" data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="left"
                  style=" --tips-text:'ä»æ‰€é€‰å¯¹è±¡è·å–æ•°æ®';  --tips-text-en:'Retrieve data from the selected node';">
                    <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill="var(--mainColor)" d="M18.8157 14.2207C19.7226 14.5107 19.7487 15.7845 18.8547 16.1123L10.4709 19.1855C10.2512 19.266 10.0096 19.2674 9.78931 19.1885L1.21313 16.1152C0.310723 15.7914 0.337167 14.505 1.2522 14.2188L2.41919 13.8535L10.1301 16.6172L17.6672 13.8535L18.8157 14.2207ZM8.89771 7.89746C9.81186 8.73115 10.3983 9.70031 10.8049 10.3096L12.2288 12.4434L12.6243 9.90918C12.708 9.3731 12.7298 8.84584 12.7034 8.33301L18.8167 10.2881C19.7234 10.5782 19.7496 11.8519 18.8557 12.1797L10.4719 15.2529C10.2521 15.3335 10.0107 15.3348 9.79028 15.2559L1.21411 12.1816C0.311182 11.858 0.337567 10.5722 1.25317 10.2861L8.89771 7.89746Z"/>
                      <path fill="var(--mainColor)" d="M2.90601 2.11987L9.23639 0.345091L5.85843 8.12319L2.90601 2.11987Z"/>
                      <path fill="var(--mainColor)" d="M11.6365 9.75528C12.233 5.93585 9.27837 2.47694 7.9768 2.36549L6.13448 5.42255C9.41622 6.02688 10.952 8.72977 11.6365 9.75528Z"/>
                    </svg>                    
                  </div>
                  <a href="https://www.ynyuset.cn/tool_web/ListEase/" target="_blank" id="upload-set-3" data-btn="moreset" data-tips="auto" data-tips-y="top" data-tips-x="center"
                  style=" --tips-text:'å‰å¾€åˆ¶ä½œæ›´å¤æ‚çš„æ¨¡æ¿æ•°æ®';  --tips-text-en:'To create more complex template data';">
                    <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle fill="var(--mainColor)" cx="3" cy="4" r="2"/>
                      <path stroke="var(--mainColor)" d="M3 5V10H9"/>
                      <path stroke="var(--mainColor)" d="M3 4H9"/>
                      <path stroke="var(--mainColor)" d="M3 5V16H9"/>
                      <rect fill="var(--mainColor)" x="7" y="8" width="12" height="4" rx="2"/>
                      <rect fill="var(--mainColor)" x="7" y="2" width="12" height="4" rx="2"/>
                      <rect fill="var(--mainColor)" x="7" y="14" width="12" height="4" rx="2"/>
                    </svg>                                       
                  </a>
                </div>
                <input id="upload-moreset" type="checkbox" checked onchange="showNext(this,this.parentNode.parentNode.nextElementSibling,'flex',true)">
                <label for="upload-moreset" class="btn-moreset" data-tips="auto" data-tips-y="top" data-tips-x="right"
                style="--tips-text:'é«˜çº§è®¾ç½®';  --tips-text-en:'Advanced setting';">
                  <btn-set></btn-set>
                </label>
              </div>
            </div>
            <div id="upload-moreset-box" class="w100 df-lc" style="flex-wrap: wrap; max-width: 560px; gap: 4px; display: none;">
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 180px;">
                <div data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch; 
                  --tips-text:'å¯è‡ªå®šä¹‰åˆ—é¡ºåºï¼Œæ— ç‰¹æ®Šéœ€è¦ä¿æŒé»˜è®¤å³å¯';  --tips-text-en:'Custom column order if necessary'; width: 20px; height: 20px;">
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path stroke="var(--mainColor)" fill="var(--mainColor)" d="M1.40967 3.66602C1.40967 2.56145 2.3051 1.66602 3.40967 1.66602H7.40967V6.59054H1.40967V3.66602Z"/>
                    <rect stroke="var(--mainColor)" x="1.40967" y="7.13843" width="5.63721" height="5.5603" />
                    <path stroke="var(--mainColor)" d="M1.40967 12.6987H7.04688V18.2185H3.40967C2.3051 18.2185 1.40967 17.3231 1.40967 16.2185V12.6987Z"/>
                    <path stroke="var(--mainColor)" fill="var(--mainColor)" d="M9.86572 2.19995H17C18.1046 2.19995 19 3.09538 19 4.19995V7.36918H9.86572V2.19995Z"/>
                    <rect stroke="var(--mainColor)" x="9.86572" y="7.36914" width="9.13428" height="5.7478"/>
                    <path stroke="var(--mainColor)" d="M9.86572 13.1169H19V17.0002C19 18.1048 18.1046 19.0002 17 19.0002H9.86572V13.1169Z"/>
                  </svg>
                </div>
                <input id="input-user-table-title" data-input class="nobod fl1" type="text" placeholder="name,w,h,s,type,add"> 
                <!--æ¸…ç©º-->
                <div class="pos-a" data-close="clear" style="right: 10px; top:calc(50% - 6px); width: 12px; height: 12px;">
                  <btn-close></btn-close>
                </div>   
              </div>
              <div class="df-lc fl1 pos-r upload-set" style="gap:4px; min-width: 180px;">
                <div data-tips="auto" class="fl0" data-tips-y="top" data-tips-x="left" style="--tips-w: 8ch; 
                  --tips-text:'ç”»æ¿å‘½ååç¼€, è‡ªå®šä¹‰æ ¼å¼æˆ–é€‰æ‹©é¢„è®¾';  --tips-text-en:'Frame naming suffix,input or select a preset'; width: 20px; height: 20px;">
                  <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect fill="var(--mainColor)" x="16" y="4" width="4" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" y="4" width="8.5" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" y="16" width="20" height="2" rx="1"/>
                    <rect fill="var(--mainColor)" x="18" y="4" width="17" height="2" rx="1" transform="rotate(90 18 4)"/>
                    <rect fill="var(--mainColor)" x="4" y="2" width="20" height="2" rx="1" transform="rotate(90 4 2)"/>
                    <path fill="var(--mainColor)" d="M6.97137 16.0954C6.62768 16.3986 6.09115 16.1182 6.14391 15.6629L6.71709 10.717L10.7051 12.8016L6.97137 16.0954Z"/>
                    <path fill="var(--mainColor)" d="M11.3154 11.5259L7.35709 9.45685L11.5784 1.38079C11.8343 0.891339 12.4385 0.701954 12.9279 0.957792L15.1138 2.10035C15.6032 2.35618 15.7926 2.96036 15.5368 3.44982L11.3154 11.5259Z"/>
                  </svg>
                </div>
                <input id="input-framename" data-input class="nobod fl1" type="text" data-input-type="text" data-input-must="none" value="wÃ—h">  
                <div class="df-lc pos-r" data-select="" data-select-value="" style="gap: 4px; width: 90px; z-index:2;">
                  <input id="select-value-1" type="text" data-select-input readonly value="wÃ—h">
                  <input id="select-show-1" data-select-pick="wÃ—h" type="checkbox">
                  <label for="select-show-1" class="show-next wh100" style="position: absolute; top:0; right: 0;"></label>
                  <div data-select-options="" class="df-ffc pos-a w100 noscrollbar" style="white-space: wrap; display: none; top:24px;">
                    <div data-option="type" data-en-text="Basic">åŸºç¡€</div>
                    <div data-option="option" data-option-main="false" data-option-value="none">none</div>
                    <div data-option="option" data-option-main="true" data-option-value="wÃ—h">wÃ—h</div>
                    <div data-option="option" data-option-main="false" data-option-value="w_h">w_h</div>
                    <div data-option="type" data-en-text="Complex">å¤æ‚</div>
                    <div data-option="option" data-option-main="false" data-option-value="wÃ—h s">wÃ—h s</div>
                    <div data-option="option" data-option-main="false" data-option-value="w_h s">w_h s</div>
                    <div data-option="option" data-option-main="false" data-option-value="add wÃ—h s">add wÃ—h s</div>
                    <div data-option="option" data-option-main="false" data-option-value="add w_h s">add w_h s</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="w100 df-lc"  style="max-width: 560px; padding:4px 0 10px 0; opacity: 0.6; vertical-align: baseline;"> 
              <span>â–¼&nbsp;</span>
              <span data-en-text="Edit final tags/catalogue" > ç¼–è¾‘æ ‡ç­¾/å¤§çº² </span>
                &nbsp;&nbsp;
                <span data-en-text="to create finally" data-any="vw240" style="opacity: 0.6;">ä»¥ç¡®è®¤æœ€ç»ˆåˆ›å»ºå†…å®¹</span>
            </div>
            <div class="wh100 upload-set pos-r ovy noscrollbar" data-resize style="resize: vertical; height: 200px; max-width: 560px; min-height: 20vh; max-height: 80vh;"></div>
          </div>
        </div>
        <div data-btn="main" class="df-cc" data-en-text="CREATER">åˆ›å»º</div>
      </div>
      <div data-page-name="å¯¼å‡º" data-page-name-en="export" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="w100 df-ffc" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
        </div>
        <div data-btn="main" class="df-cc" data-en-text="EXPORT">å¯¼å‡º</div>
      </div>
      <div data-page-name="ç¼–è¾‘" data-page-name-en="editor" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="w100 df-ffc" style="height: calc(100% - 40px); align-items: center; padding:0 10px 10px 10px; box-sizing: border-box;">
        </div>
        <div data-btn="main" class="df-cc" data-en-text="APPLY">åº”ç”¨</div>
      </div>
      <div data-page-name="å˜é‡" data-page-name-en="variable" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        
      </div>
      <div data-page-name="è¡¨å•" data-page-name-en="sheet" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        
      </div>
      <div data-page-name="æ›´å¤šåŠŸèƒ½" data-page-name-en="more tools" data-page-main="false" data-page-tabclass="tab-top" class="df-ffc df-cc wh100" style="display: none;">
        <div class="wh100 df-ffc" style="align-items: center; padding: 10px; box-sizing: border-box;">
          <div class="w100 df-lc ovx noscrollbar" data-radio-value data-scroll data-skilltype-box>
            <div data-radio data-radio-data="1" data-radio-main="true" class="df-ffc df-cc" style="gap: 4px;">
              <div data-skilltype-icon>
                <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill="var(--mainColor)" d="M9.10133 5.24013C9.4668 4.4921 10.5329 4.4921 10.8983 5.24013L11.9152 7.32142L14.2089 7.64537C15.0332 7.76179 15.3626 8.77567 14.7642 9.3544L13.099 10.9647L13.4996 13.2462C13.6437 14.0661 12.7812 14.6928 12.0458 14.3024L9.99983 13.2163L7.95381 14.3024C7.21847 14.6928 6.35601 14.0661 6.50002 13.2462L6.9007 10.9647L5.23551 9.3544C4.63703 8.77567 4.96646 7.76179 5.79081 7.64537L8.08446 7.32142L9.10133 5.24013Z"/>
                  <rect stroke="var(--mainColor)" x="2.5" y="2.5" width="15" height="15" rx="2"/>
                </svg>           
              </div>
              <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Useful & Starts" >
                å¸¸ç”¨åŠŸèƒ½
              </div>
            </div>
            <div data-radio data-radio-data="2" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
              <div data-skilltype-icon>
                <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill="var(--mainColor)" d="M7 7H2V2H7V7ZM3 3V6H6V3H3Z"/>
                  <rect fill="var(--mainColor)" x="6" y="4" width="6" height="1" rx="0.5"/>
                  <rect fill="var(--mainColor)" x="4" y="6" width="1" height="6" rx="0.5"/>
                  <path fill="var(--mainColor)" d="M3 15C3 14.4477 3.44772 14 4 14H6C6.55228 14 7 14.4477 7 15V17C7 17.5523 6.55228 18 6 18H4C3.44772 18 3 17.5523 3 17V15Z"/>
                  <path fill="var(--mainColor)" d="M8.5 15C8.5 14.4477 8.94772 14 9.5 14H11.5C12.0523 14 12.5 14.4477 12.5 15V17C12.5 17.5523 12.0523 18 11.5 18H9.5C8.94772 18 8.5 17.5523 8.5 17V15Z"/>
                  <path fill="var(--mainColor)" d="M8.5 9.5C8.5 8.94772 8.94772 8.5 9.5 8.5H11.5C12.0523 8.5 12.5 8.94772 12.5 9.5V11.5C12.5 12.0523 12.0523 12.5 11.5 12.5H9.5C8.94772 12.5 8.5 12.0523 8.5 11.5V9.5Z"/>
                  <rect fill="var(--mainColor)" x="14" y="14" width="4" height="4" rx="1"/>
                  <path fill="var(--mainColor)" d="M14 9.5C14 8.94772 14.4477 8.5 15 8.5H17C17.5523 8.5 18 8.94772 18 9.5V11.5C18 12.0523 17.5523 12.5 17 12.5H15C14.4477 12.5 14 12.0523 14 11.5V9.5Z"/>
                  <path fill="var(--mainColor)" d="M14 4C14 3.44772 14.4477 3 15 3H17C17.5523 3 18 3.44772 18 4V6C18 6.55228 17.5523 7 17 7H15C14.4477 7 14 6.55228 14 6V4Z"/>
                </svg>              
              </div>
              <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Pixel & Transform" >
                åƒç´ &å˜æ¢
              </div>
            </div>
            <div data-radio data-radio-data="3" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
              <div data-skilltype-icon>
                <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill="var(--mainColor)" d="M9 2L8.99992 4.81319H8.02803L7.94126 3.8956H6.19353L6.19361 8.41026L7.13657 8.5641V10H3.66841V8.5641L4.73222 8.41026L4.73214 3.8956H3.05867L2.97767 4.81319H2L2.00008 2H9Z"/>
                  <path fill="var(--mainColor)" d="M2 13C2 11.8954 2.89543 11 4 11H8C9.10457 11 10 11.8954 10 13V17C10 18.1046 9.10457 19 8 19H4C2.89543 19 2 18.1046 2 17V13Z"/>
                  <path fill="var(--mainColor)" d="M11.7126 4.04181C11.8915 3.86285 12.1817 3.86285 12.3607 4.04181L13.7493 5.43044C13.9282 5.6094 13.9282 5.89954 13.7493 6.0785L12.3607 7.46713C12.1817 7.64609 11.8915 7.64609 11.7126 7.46713L10.324 6.0785C10.145 5.89954 10.145 5.6094 10.324 5.43044L11.7126 4.04181Z"/>
                  <path fill="var(--mainColor)" d="M14.2585 1.49591C14.4374 1.31695 14.7276 1.31695 14.9066 1.49591L16.2952 2.88454C16.4741 3.0635 16.4741 3.35365 16.2952 3.5326L14.9066 4.92124C14.7276 5.10019 14.4374 5.10019 14.2585 4.92123L12.8699 3.5326C12.6909 3.35365 12.6909 3.0635 12.8699 2.88454L14.2585 1.49591Z"/>
                  <rect fill="var(--mainColor)" x="14.5825" y="6.26343" width="2.88032" height="2.88032" rx="0.458252" transform="rotate(45 14.5825 6.26343)"/>
                  <path fill="var(--mainColor)" d="M16.8044 4.04181C16.9833 3.86285 17.2735 3.86285 17.4525 4.04181L18.8411 5.43044C19.02 5.6094 19.02 5.89954 18.8411 6.0785L17.4525 7.46713C17.2735 7.64609 16.9833 7.64609 16.8044 7.46713L15.4158 6.0785C15.2368 5.89954 15.2368 5.6094 15.4158 5.43044L16.8044 4.04181Z"/>
                  <path stroke="var(--mainColor)"  stroke-linecap="round" stroke-dasharray="2 2" d="M11.5 13.5C11.5 12.3954 12.3954 11.5 13.5 11.5H16.5C17.6046 11.5 18.5 12.3954 18.5 13.5V16.5C18.5 17.6046 17.6046 18.5 16.5 18.5H13.5C12.3954 18.5 11.5 17.6046 11.5 16.5V13.5Z"/>
                </svg>                                   
              </div>
              <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Text & Layer" >
                æ–‡æœ¬&å›¾å±‚
              </div>
            </div>
            <div data-radio data-radio-data="4" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
              <div data-skilltype-icon>
                <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill="var(--mainColor)" d="M12.5 7H7.5V2H12.5V7ZM8.5 3V6H11.5V3H8.5Z"/>
                  <rect fill="var(--mainColor)" x="1" y="3" width="3" height="3"/>
                  <rect fill="var(--mainColor)" x="16" y="3" width="3" height="3"/>
                  <rect fill="var(--mainColor)" x="12" y="4" width="4" height="1"/>
                  <rect fill="var(--mainColor)" x="4" y="4" width="4" height="1"/>
                  <path stroke="var(--mainColor)" stroke-linecap="round" d="M17 10C17 7.59975 15.0191 5.57184 12 5M3 10C3 7.58397 4.95063 5.55643 8 5"/>
                  <circle stroke="var(--mainColor)" cx="8.5" cy="10.5" r="1.5"/>
                  <path fill="var(--mainColor)" d="M4.63324 12.8363L4.94986 12.4494L4.94986 12.4494L4.63324 12.8363ZM11.1597 13.6771L11.4886 14.0537L11.5013 14.0426L11.5132 14.0307L11.1597 13.6771ZM12.5 13.6103L12.8271 13.2319L12.8166 13.2233L12.5 13.6103ZM17.5 13.5731C17.5 13.2969 17.2761 13.0731 17 13.0731C16.7239 13.0731 16.5 13.2969 16.5 13.5731H17.5ZM16.5 12C16.5 12.2761 16.7239 12.5 17 12.5C17.2761 12.5 17.5 12.2761 17.5 12H16.5ZM17.5 11.5C17.5 11.2239 17.2761 11 17 11C16.7239 11 16.5 11.2239 16.5 11.5H17.5ZM7.19138 14.9294L6.87476 15.3163L7.19138 14.9294ZM4.63324 12.8363L4.31662 13.2233L6.87476 15.3163L7.19138 14.9294L7.508 14.5424L4.94986 12.4494L4.63324 12.8363ZM9.77349 14.8878L10.1024 15.2644L11.4886 14.0537L11.1597 13.6771L10.8307 13.3006L9.44458 14.5112L9.77349 14.8878ZM12.5 13.6103L12.173 13.9886L16.673 17.8783L17 17.5001L17.327 17.1218L12.827 13.232L12.5 13.6103ZM11.1597 13.6771L11.5132 14.0307C11.6948 13.8491 11.9846 13.8346 12.1834 13.9973L12.5 13.6103L12.8166 13.2233C12.2202 12.7353 11.351 12.7787 10.8061 13.3236L11.1597 13.6771ZM3 13.6103H3.5C3.5 13.1885 3.99015 12.9562 4.31662 13.2233L4.63324 12.8363L4.94986 12.4494C3.97046 11.648 2.5 12.3449 2.5 13.6103H3ZM4 18.0001V18.5001H16V18.0001V17.5001H4V18.0001ZM17 17.0001H17.5V13.5731H17H16.5V17.0001H17ZM16 18.0001V18.5001C16.8284 18.5001 17.5 17.8285 17.5 17.0001H17H16.5C16.5 17.2762 16.2761 17.5001 16 17.5001V18.0001ZM3 17.0001H2.5C2.5 17.8285 3.17157 18.5001 4 18.5001V18.0001V17.5001C3.72386 17.5001 3.5 17.2762 3.5 17.0001H3ZM3 17.0001H3.5V13.6103H3H2.5V17.0001H3ZM17 12H17.5V11.5H17H16.5V12H17ZM7.19138 14.9294L6.87476 15.3163C7.81915 16.089 9.18336 16.0671 10.1024 15.2644L9.77349 14.8878L9.44458 14.5112C8.89316 14.9928 8.07463 15.006 7.508 14.5424L7.19138 14.9294Z"/>
                </svg>                  
              </div>
              <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Vector & Generate" >
                çŸ¢é‡&ç”Ÿæˆ
              </div>
            </div>
            <div data-radio data-radio-data="5" data-radio-main="false" class="df-ffc df-cc" style="gap: 4px;">
              <div data-skilltype-icon>
                <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill="var(--mainColor)" d="M7.53784 8.53784C7.53784 7.98556 7.98556 7.53784 8.53784 7.53784H11.4618C12.0141 7.53784 12.4618 7.98556 12.4618 8.53784V11.4618C12.4618 12.0141 12.0141 12.4618 11.4618 12.4618H8.53784C7.98556 12.4618 7.53784 12.0141 7.53784 11.4618V8.53784Z"/>
                  <path stroke="var(--mainColor)" d="M17.5 8.125V7C17.5 4.51472 15.4853 2.5 13 2.5H11.875M17.5 11.875V13C17.5 15.4853 15.4853 17.5 13 17.5H11.875M2.5 11.875V13C2.5 15.4853 4.51472 17.5 7 17.5H8.125M2.5 8.125V7C2.5 4.51472 4.51472 2.5 7 2.5H8.125"/>
                  <path stroke="var(--mainColor)" d="M5.65112 7.65112C5.65112 6.54655 6.54655 5.65112 7.65112 5.65112H12.3489C13.4535 5.65112 14.3489 6.54655 14.3489 7.65112V12.3489C14.3489 13.4535 13.4535 14.3489 12.3489 14.3489H7.65112C6.54655 14.3489 5.65112 13.4535 5.65112 12.3489V7.65112Z" stroke-dasharray="2.14 2.14"/>
                  <circle stroke="var(--mainColor)" cx="10" cy="2.5" r="1.5"/>
                  <circle stroke="var(--mainColor)" cx="10" cy="17.5" r="1.5"/>
                  <circle stroke="var(--mainColor)" cx="2.5" cy="10" r="1.5"/>
                  <circle stroke="var(--mainColor)" cx="17.5" cy="10" r="1.5"/>
                </svg>                  
              </div>
              <div data-skilltype-name data-btn-name data-any="vw300" data-en-text="Style & Prototype" >
                æ ·å¼&åŸå‹
              </div>
            </div>
          </div>
          <div class="wh100 df-ffc ovy noscrollbar" style="max-width: 560px;">
            <div data-skills-box="" class="w100 df-ffc" style="gap: 4px;">
              <div class="w100 df-ffc" data-skillmodel="Useful & Starts">

              </div>
              <div class="w100 df-ffc" data-skillmodel="Pixel & Transform">

              </div>
              <div class="w100 df-ffc" data-skillmodel="Text & Layer">

              </div>
              <div class="w100 df-ffc" data-skillmodel="Vector & Generate">

              </div>
              <div class="w100 df-ffc" data-skillmodel="Style & Prototype">
                
              </div>
            </div>
          </div>
        </div>
      
      </div>
    </div>
  </div>
  <!--åº•éƒ¨-->
  <div id="bottom" class="df-lc w100 pos-a">
    <div data-scroll class="df ovx noscrollbar" data-tab="auto" data-tab-for="page" style="padding: 6px 4px;">
      <!--è‡ªåŠ¨å¡«å……tab-->
    </div>
  </div>
  <!--æ’ä»¶ç«¯è°ƒæ•´å¤§å°-->
  <div data-resize-window></div>
  
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/builds/yn_comp.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/builds/yn_tool.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/public/compressor.min.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/public/jszip.js"></script>
  <script src="https://cdn.jsdelivr.net.cn/gh/YNYU01/YNYU_SET@1937a27188af1dd9dd856e8401c79d78b08ec06c/public/graph.js"></script>
  <!-- INLINE_JS -->
  <script>
/*let skillModel = [
  ["å¸¸ç”¨åŠŸèƒ½","Useful & Starts"],
  ["åƒç´ &å˜æ¢","Pixel & Transform"],
  ["æ–‡æœ¬&å›¾å±‚","Text & Layer"],
  ["çŸ¢é‡&ç”Ÿæˆ","Vector & Generate"],
  ["æ ·å¼&åŸå‹","Style & Prototype"],
]
*/

let userSkillStart = ['äºŒçº§åŠŸèƒ½å','äºŒçº§åŠŸèƒ½å']

let toUserTips = {
  worktime: ["ğŸ”’ä¸‹ç­æ—¶é—´ä¸å»ºè®®å·¥ä½œ~ (ä»˜è´¹è§£é”)","ğŸ”’You shouldn't work after work!(pay to unlock)"],
  random: [
    ["ä¹…åä¼¤èº«, å¿«èµ·æ¥èµ°ä¸¤æ­¥å§~","Get up and take a walk now~"],
    ["èº«å¿ƒè¦ç´§, ä¸èˆ’æœåŠæ—¶ä¼‘æ¯~","Put down your work and rest in time~"],
    ["å·¥å…·ææ•ˆ, æ˜¯ä¸ºäº†å¤šé™ªå®¶äºº~","Spend more time with your family~"],
    ["æ”¯æŒå¼€æº, è¦ä»·å€¼è€Œéä»·æ ¼~","Support open source and design~"],
    ["ä¹…åä¼¤èº«, å¿«èµ·æ¥èµ°ä¸¤æ­¥å§~","Get up and take a walk now~"],
    ["èº«å¿ƒè¦ç´§, ä¸èˆ’æœåŠæ—¶ä¼‘æ¯~","Put down your work and rest in time~"],
    ["å·¥å…·ææ•ˆ, æ˜¯ä¸ºäº†å¤šé™ªå®¶äºº~","Spend more time with your family~"],
    ["æ”¯æŒå¼€æº, è¦ä»·å€¼è€Œéä»·æ ¼~","Support open source and design~"],
  ],
};

let helpData = {
  create: [
    ["p",
    "æœ¬é¡µåŠŸèƒ½ä¸»è¦ç”¨äº<span data-highlight> æ‰¹é‡åˆ›å»ºç”»æ¿ã€å›¾å±‚ç­‰ </span>",
    "This page is used for batch creation of <span data-highlight> frames, layers, etc </span>"],
    ["li",
    "ä¼ å…¥å¤§å›¾ï¼ˆé•¿å›¾ï¼‰å¯åˆ›å»ºå¤§å°å‡åŒ€çš„åˆ‡ç‰‡ç»„ï¼Œä»¥é¿å…å‹ç¼©",
    "Upload large images (long images) will create slice groups to avoid compression"],
    ["li",
    "ä¼ å…¥å¸¦å‘½åã€å®½é«˜ç­‰ä¿¡æ¯çš„è¡¨æ ¼æ•°æ®åˆ™åˆ›å»ºç”»æ¿",
    "Upload table data with name, width, height, and other information, will will create frames"],
    ["li",
    "ä¼ å…¥ç”±æœ¬ç³»åˆ—æ’ä»¶ç”Ÿæˆçš„å…¼å®¹æ–‡ä»¶åˆ™åˆ›å»ºå›¾å±‚",
    "Upload files by YN+ will create layers"],
    ["br","",""],
    ["p",
    "æ‹–æ‹½å’Œä¸Šä¼ æ–‡ä»¶ä¼šç«‹å³ç”Ÿæˆç”¨ä»¥ç¡®è®¤æœ€ç»ˆç”Ÿæˆå†…å®¹çš„<span data-highlight> æ ‡ç­¾/å¤§çº² </span>",
    "Dragging or uploading files will immediately convert to <span data-highlight> tags/catalogue </span>"],
    ["li",
    "æ‹–æ‹½çš„æ–‡ä»¶éœ€å…¨éƒ¨æ˜¯ä¸ºå›¾ç‰‡ç±»ã€å…¨éƒ¨æ˜¯è¡¨æ ¼ç±»æˆ–å…¨éƒ¨æ˜¯å…¼å®¹æ–‡ä»¶ï¼Œ<span data-highlight>ä¸èƒ½æ··æ‚ç±»å‹</span>",
    "Drag and drop files must be all images, tables, or compatible files. <span data-highlight> Mixed file types are not allowed </span>"],
    ["li",
    "ä¸Šä¼ æ–‡ä»¶è®¾ç½®äº†å…·ä½“æ ¼å¼ï¼Œä¸æ”¯æŒçš„æ ¼å¼å°†æ— æ³•ç‚¹é€‰",
    "The three upload buttons restrict the file format, and unsupported formats cannot be uploaded"],
    ["br","",""],
    ["p",
    "é€šè¿‡æ–‡æœ¬æ¡†è¾“å…¥æ•°æ®ï¼Œéœ€è¦ç‚¹å‡»ç¬¬ä¸€ä¸ªæŒ‰é’®æ¥ç”Ÿæˆæ ‡ç­¾/å¤§çº²",
    "If input data through the textarea, click the first button to convert the data to tags/catalogue"],
    ["li",
    "è¾“å…¥è¡¨æ ¼æ•°æ®æ— éœ€åŒ…å«è¡¨å¤´ã€å•ä½ï¼Œ<span data-highlight>å¯åŒå‡»æ–‡æœ¬æ¡†æŸ¥çœ‹ç¤ºä¾‹</span>",
    "Does not need to include a table header or unit.<span data-highlight> May double-click the textarea to fill an example <span>"],
    ["li",
    "å¯ä»¥é€‰ä¸­æ–‡ä»¶é‡Œçš„ç”»æ¿æˆ–å›¾å±‚ï¼Œç„¶åç‚¹å‡»ç¬¬äºŒä¸ªæŒ‰é’®è·å–å‘½åå’Œå®½é«˜æ•°æ®",
    "Select frames or layers in the file, and then click the second button to obtain theirs name, width and height data"],
    ["li",
    "å¦‚æœéœ€è¦åˆ¶ä½œæ›´å¤æ‚çš„æ¨¡æ¿ï¼Œç‚¹å‡»ç¬¬ä¸‰ä¸ªæŒ‰é’®å‰å¾€èµ„æºåŠ©æ‰‹",
    "If you need to create more complex templates, click the third button to go to the <span data-highlight> YN+ ListEase </span> online"],
    ["br","",""],
    ["p",
    "è¡¨æ ¼æ•°æ®é»˜è®¤æŒ‰<span data-highlight>å‘½åã€å®½é«˜ã€ç›®æ ‡æ–‡ä»¶å¤§å°ã€ç›®æ ‡æ–‡ä»¶æ ¼å¼ã€è¡¥å……ä¿¡æ¯</span>çš„é¡ºåºè¯»å–åˆ—ï¼Œå¦‚éœ€ä¿®æ”¹è§„åˆ™å¯ç‚¹å‡»ç¬¬å››ä¸ªæŒ‰é’®å±•å¼€é«˜çº§è®¾ç½®",
    "Table data is read in the order of <span data-highlight> name, width, height, target file size, target file format, and supplementary information </span> by default. To modify the rules, click the fourth button to expand advanced settings"],
    ["li",
    "ä¿®æ”¹åˆ—é¡ºåºè§„åˆ™æ—¶éœ€æ³¨æ„,å¿…é¡»åŒ…å«å‘½åå’Œå®½é«˜"
    ,"When modifying column order rules, it is important to include <span data-highlight> name, width and height </span>"],
    ["li",
    "ç”»æ¿åé»˜è®¤å¸¦wÃ—håç¼€ï¼Œå¦‚â€œkv 1920Ã—1080 â€ï¼Œå¯é€‰æ‹©å…¶ä»–é¢„è®¾æˆ–è‡ªè¡Œå®šä¹‰",
    "The frame defaults to a suffix with width and height,such as 'kv 1920 Ã— 1080', you can selected a presets or input oneself"],
  ]
}

let skillModel = [];
let skilltypeNameNode = document.querySelector('[data-skilltype-box]').querySelectorAll('[data-skilltype-name]')
skilltypeNameNode.forEach(item => {
  let name1 = item.getAttribute('data-zh-text');
  name1 = name1 ? name1 : item.textContent.trim();
  let name2 = item.getAttribute('data-en-text');
  skillModel.push([name1,name2]);
});

/*
skillModel.forEach(item => {
  let box = document.querySelector('[data-skills-box]');
  let node = document.createElement('div');
  node.className = 'w100 df-ffc';
  //node.innerHTML = item[0];
  node.setAttribute('data-skillModel',item[1]);
  box.appendChild(node);
});
*/

const UI_MINI = [200,460];
const UI = [300,660];
const UI_BIG = [620,660];
const sideMix = document.querySelector('[data-side-mix]');
const sideMask = document.querySelector('[data-side-mask]');
const btnMore = document.getElementById('btn-more');
const btnResize = document.querySelector('[data-resize-window]');
const btnBig = document.getElementById('big');
const TV_text = document.querySelector('[data-tv-text]');
const dropUp = document.querySelector('[data-drop="upload"]');
const userImg = document.getElementById('input-user-img');
const userTable = document.getElementById('input-user-table');
const userTableTitle = document.getElementById('input-user-table-title');
const userZy = document.getElementById('input-user-zy');
const fileInfo = document.querySelector('[data-file-info]');
const frameName =  document.getElementById('input-framename');
const helpCreate = document.querySelector('[data-help="create"]');
const dailog = document.querySelector('[data-dailog]');
const dailogBox = document.querySelector('[data-dailog-box]');

let isResize = false;
let reStartW,reStartH,reStartX,reStartY;
let tableTitleMust = userTableTitle.getAttribute('placeholder').split(',');
let imageType = document.getElementById('input-user-img').getAttribute('accept');
let tableType = document.getElementById('input-user-table').getAttribute('accept');
let zyType = document.getElementById('input-user-zy').getAttribute('accept');
let frameNmaeSelect = [];
frameName.nextElementSibling.querySelectorAll('[data-option="option"]')
.forEach(item => {
  frameNmaeSelect.push(item.getAttribute('data-option-value'));
});

window.addEventListener('load',()=>{
  viewPage('more tools')
  if(window.innerWidth < 300){
    TV_MOVE = true;
  } else {
    TV_MOVE = false;
  };
  reTV();
  loadFont();
  addToUserTips();
  setInterval(() => {
    addToUserTips();
  }, 12000);
});

window.addEventListener('resize',()=>{
/*é˜²æŠ–*/
let MOVE_TIMEOUT;
if(MOVE_TIMEOUT){
    clearTimeout(MOVE_TIMEOUT)
};
MOVE_TIMEOUT = setTimeout(()=>{
  if(window.innerWidth < 300){
    TV_MOVE = true;
  } else {
    TV_MOVE = false;
  }
},500);
});

let loadFontAfter = [
  "data-en-text",
  "data-en-input",
  "data-en-placeholder",
  "data-turnto",
  "data-back",
]

function loadFont(){
  setTimeout(()=>{
    loadFontAfter.forEach(key => {
      let nodes = document.querySelectorAll(`[${key}]`);
      nodes.forEach(item => {
        item.style.fontFamily = '"Shanggu Sans", Arial, Helvetica, sans-serif';
      })
    });
  },500);
}

function addToUserTips(){
  let languge = ROOT.getAttribute('data-language');
  let num = languge == 'Zh' ? 0 : 1;
  let languge2 = languge == 'Zh' ? 'en' : 'zh';
  let random = toUserTips.random[Math.floor(Math.random()*toUserTips.random.length)]
  TV_text.textContent = random[num]
  TV_text.setAttribute('data-'+ languge2 +'-text',random[1 - num]);
  TV_text.setAttribute('data-'+ languge.toLowerCase() +'-text',random[num]);
  let textW
  if(num){
    textW = random[num].length * -1 - 4 + 'ch';//è‹±æ–‡1ch
  }else{
    textW = random[num].length * -2 - 4 + 'ch';//ä¸­æ–‡2ch
  }
  TV_text.parentNode.style.setProperty('--tv-w',textW)

}

//ä¾§è¾¹æ å±•å¼€
btnMore.addEventListener('change',(event)=>{
  if(event.target.checked){
    sideMix.style.display = 'flex';
    sideMask.style.display = 'block';
    sideMix.style.animation = 'sideUp 0.3s ease-out';
    sideMask.style.animation = 'loadOp 0.3s ';
  } else {
    sideMix.style.animation = 'sideOver 0.3s ease-out';
    sideMask.style.animation = 'overOp 0.3s ease-out';
    setTimeout(()=>{ 
      sideMix.style.display = 'none'
      sideMask.style.display = 'none'
    },280)
  }
});
//ä¾§è¾¹æ å…³é—­
document.addEventListener('click',(event)=>{
  if(!sideMix.contains(event.target) && sideMask.style.display !== 'none' && sideMix.style.display !== 'none' && btnMore.checked == true ){
    btnMore.checked = false;
    let inputEvent = new Event('change',{bubbles:true});
    btnMore.dispatchEvent(inputEvent);
  }
});
//ç¼©æ”¾çª—å£
btnResize.addEventListener('mousedown',(event)=>{
  isResize = true;
  let reNodeStyle = document.defaultView.getComputedStyle(ROOT);
  reStartW = parseInt(reNodeStyle.width,10);
  reStartH = parseInt(reNodeStyle.height,10);
  reStartX = event.clientX;
  reStartY = event.clientY;
  //console.log(reStartW,reStartH)
  document.addEventListener('mousemove',(e)=>{
    if(isResize){
      let w = reStartW + e.clientX - reStartX;
      let h = reStartH + e.clientY - reStartY;
      w = Math.max(w,UI_MINI[0]);
      h = Math.max(h,UI_MINI[1]);
      toolMessage([[w,h],'resize'],PLUGINAPP);
      /*//
      console.log(w,h)
      ROOT.style.width = w;
      ROOT.style.height = h;
      //*/
      
      /*é˜²æŠ–*/
      let MOVE_TIMEOUT;
      if(MOVE_TIMEOUT){
          clearTimeout(MOVE_TIMEOUT)
      };
      MOVE_TIMEOUT = setTimeout(()=>{
        if(w > UI[0]){
          btnBig.checked = true;
        } else {
          btnBig.checked = false;
        }
      },500);
    }
  });
  document.addEventListener('mouseup',()=>{
    isResize = false;
  })
});
//æ‰“å°æ‰€é€‰å¯¹è±¡
document.getElementById('bottom').addEventListener('dblclick',()=>{
  toolMessage(['','getnode'],PLUGINAPP)
});
//æœ€å¤§åŒ–çª—å£
btnBig.addEventListener('change',()=>{
  let w = window.innerWidth;
  let h = window.innerHeight;
  if(btnBig.checked){
    if(w < UI[0] || h < UI[1]){
      toolMessage([false,'big'],PLUGINAPP);
      btnBig.checked = false;
    }else{
      toolMessage([true,'big'],PLUGINAPP);
    }
  }else{
    toolMessage([false,'big'],PLUGINAPP);
  }
});
//ç‚¹å‡»ä¸Šä¼ 
userImg.addEventListener('change',(e)=>{
  let files = userImg.files;
  reFileInfo(files);
  let reader = new FileReader();
});
userTable.addEventListener('change',(e)=>{
  let files = userTable.files;
  reFileInfo(files);
});
userZy.addEventListener('change',(e)=>{
  let files = userZy.files;
  reFileInfo(files);
});
function reFileInfo(files){
  let languge = ROOT.getAttribute('data-language');
  let fileLength = '<span style="color: var(--code2)">' + files.length + '</span>'
  let fileName1 = files.length == 1 ? files[0].name : files[0].name + ' ...ç­‰ ' + fileLength + '  ä¸ªæ–‡ä»¶';
  let fileName2 = files.length == 1 ? files[0].name : files[0].name + ' ... ' + fileLength + ' files';
  fileName1 = 'ğŸ“ ' + fileName1;
  fileName2 = 'ğŸ“ ' + fileName2;
  fileInfo.setAttribute('data-zh-text',fileName1);
  fileInfo.setAttribute('data-en-text',fileName2);
  if(languge == "Zh"){
    fileInfo.innerHTML = fileName1;
  }else{
    fileInfo.innerHTML = fileName2;
  };
}
//æ‹–æ‹½ä¸Šä¼ 
let dragAreaInfo;
dropUp.addEventListener('dragover',(e)=>{
  dragAreaInfo = dropUp.getBoundingClientRect();
  e.stopPropagation();
  e.preventDefault();
  e.dataTransfer.dropEffect = 'copy';
  dropUp.style.filter = 'drop-shadow(0 0 4px var(--mainColor))';
  dropUp.style.setProperty('--drop-df','collapse');
});
dropUp.addEventListener('dragleave',(e)=>{
  let x = e.clientX;
  let y = e.clientY;
  let areaX = dragAreaInfo.x;
  let areaY = dragAreaInfo.y;
  let areaW = dragAreaInfo.width;
  let areaH = dragAreaInfo.height;
  if( x <= areaX || x >= areaX + areaW || y <= areaY || y >= areaY + areaH){
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
    dropUp.style.filter = '';
    dropUp.style.setProperty('--drop-df','visible');
  }
});
dropUp.addEventListener('drop',(e)=>{
  e.stopPropagation();
  e.preventDefault();
  dropUp.style.filter = '';
  dropUp.style.setProperty('--drop-df','visible');
  let files = Array.from(e.dataTransfer.files).sort((a, b) => b.size - a.size);
  reFileInfo(files);
  let reader = new FileReader();
});
//è®¾ç½®ç”»æ¿å‘½åæ ¼å¼
frameName.addEventListener('input',()=>{
  if(frameNmaeSelect.includes(frameName.value)){
    frameName.nextElementSibling.querySelector(`[data-option-value="${frameName.value}"]`).click();
  }else{
    frameName.nextElementSibling.querySelector(`[data-select-input]`).value = '';
  };
});
//è®¾ç½®ç”»æ¿æ•°æ®è¡¨å¤´è§„åˆ™
userTableTitle.addEventListener('change',()=>{
  userTableTitle.value = reTableTitle(userTableTitle.value);
});
function reTableTitle(text){
  if(text == ''){
    return '';
  }
  //é¦–å…ˆå¿…é¡»æ˜¯é€—å·éš”å¼€çš„å•è¯å½¢å¼
  let regex = /^[a-z]+$/;
  let texts = text.split(',');
  if(texts.some(item => !tableTitleMust.includes(item))){
    tipsAll(['è¯·ç”¨æŒ‡å®šå•è¯ï¼Œå¹¶ç”¨é€—å·éš”å¼€','Must use example words and separated by commas'],3000);
    texts = texts.filter(item => tableTitleMust.includes(item));
    if(texts.length == 0){
      return 'name,w,h'
    } else {
      if(texts.includes('name') && texts.includes('w') && texts.includes('h')){
        return [...new Set(texts)].join(',');
      }else{
        texts = [...new Set(texts)];
        if(!texts.includes('name')){
          texts.push('name')
        };
        if(!texts.includes('w')){
          texts.push('w')
        };
        if(!texts.includes('h')){
          texts.push('h')
        }
        return texts.join(',');
      }
    }
  }else{ 
    if(texts.includes('name') && texts.includes('w') && texts.includes('h')){
      if(texts.length == [...new Set(texts)].length){
        return text;
      }else{
        tipsAll(['å•è¯é‡å¤','The word is repeated'],3000);
        return [...new Set(texts)].join(',');
      }
    }else{
      tipsAll(['å¿…é¡»åŒ…å«nameã€wã€h','Must include name, w, h'],3000);
      texts = [...new Set(texts)];
      if(!texts.includes('name')){
        texts.push('name')
      };
      if(!texts.includes('w')){
        texts.push('w')
      };
      if(!texts.includes('h')){
        texts.push('h')
      }
      return texts.join(',');
    }
  }; 
};
//ä¸Šä¼ |æ‹–æ‹½|è¾“å…¥ çš„è§„åˆ™è¯´æ˜
helpCreate.addEventListener('click',()=>{
  if(dailogBox.innerHTML.split(helpData.create[0][1].split('<')[0]).length == 1){
    dailogBox.innerHTML = '';
    let node = document.createElement('div');
    node.className = 'df-ffc';
    helpData.create.forEach(item =>{
      let line = document.createElement(item[0]);
      line.innerHTML = item[1];
      line.setAttribute('data-en-text',item[2]);
      if(item[0] == 'li'){
        line.setAttribute('data-li-style','2')
      }
      node.appendChild(line);
    });
    dailogBox.appendChild(node);
    //æœ€åé‡ç½®ä¸‹è¯­è¨€
    if(ROOT.getAttribute('data-language') == 'En'){
      setLanguage(true);
      setLanguage(false);
    };
    //é‡ç½®æ–‡å­—æ ·å¼
    loadFont();
  };
  dailog.style.display = 'flex';
});
//ç‚¹å‡»å¼¹çª—å¤–å…³é—­å¼¹çª—
dailog.addEventListener('click',(e)=>{
  if(!dailogBox.contains(e.target)){
    dailog.style.display = 'none';
  };
});


/**
 * æ¨¡æ‹Ÿç‚¹å‡»tabåˆ‡æ¢é¡µé¢ï¼Œæµ‹è¯•æ—¶æ›´æ–¹ä¾¿ï¼Œèƒ½ç›´æ¥æ˜¾ç¤ºç›®æ ‡é¡µé¢
 * @param {string} name - åº”è¯¥ä¼ å…¥tabçš„è‹±æ–‡å
 */
function viewPage(name){
  let tab = document.getElementById(`tab_${name}_0`);
  tab.checked = true;
  let inputEvent = new Event('change',{bubbles:true});
  tab.dispatchEvent(inputEvent);
}

/*ç›‘å¬ç»„ä»¶çš„è‡ªå®šä¹‰å±æ€§å€¼ï¼Œå˜åŒ–æ—¶è§¦å‘å‡½æ•°ï¼Œç”¨äºå·²ç»ç»‘å®šäº‹ä»¶ç”¨äºè‡ªèº«çš„ç»„ä»¶ï¼Œå¦‚é¢œè‰²é€‰æ‹©å™¨ã€æ»‘å—è¾“å…¥æ¡†ç»„åˆã€ä¸ºç©ºè‡ªåŠ¨å¡«å……æ–‡æ¡ˆçš„è¾“å…¥æ¡†ã€å¯¼èˆªtabã€ä¸‹æ‹‰é€‰é¡¹ç­‰*/
let observer = new MutationObserver((mutations) => {
  mutations.forEach((mutation) => {
    if(mutation.type === 'attributes'){
      switch(mutation.attributeName){
        case 'data-tab-pick':getUserTab(mutation.target); break;
        case 'data-select-value':getUserSelect(mutation.target); break;
      }
    }
  })
});
let userEvent_tab = document.querySelectorAll('[data-tab-pick]');
userEvent_tab.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-tab-pick']};
  observer.observe(item,config);
});
let userEvent_select = document.querySelectorAll('[data-select]');
userEvent_select.forEach(item => {
  let config = {attributes:true,attributeFilter:['data-select-value']};
  observer.observe(item,config);
});

/**
 * @param {Element} node -å¸¦æœ‰data-tab-pickå€¼çš„å…ƒç´ ï¼Œç”¨äºè®°å½•ç”¨æˆ·å…³é—­å‰æ‰€é€‰çš„tab
 */
function getUserTab(node){
  let tabPick = node.getAttribute('data-tab-pick').split('tab_')[1]
  if(tabPick){
    storageMix.set('tabPick',tabPick);
  }
}

function getUserSelect(node){
  let userSelect = node.getAttribute('data-select-value');
  if(userSelect){
    if(node.previousElementSibling == frameName){
      frameName.value = userSelect;
    }
  }
}


//ç”Ÿæˆå¯¼å‡ºæ ‡ç­¾
function addExport(frameDataOld,frameDataNew,isNew) {
  //console.log(frameData)
  var index = 0;
  if(isNew == 'new'){
    exportNum = 0;
    tagsContainer2.innerHTML = "";
    frameData = frameDataNew;
  }else{
    frameData = frameDataNew;
    index = exportNum//é¿å…åºå·é”™ä¹±
  }

  for (var i = 0; i < frameData.length; i++) {
    var option = `<option value="` + frameData[i].type + `">` + frameData[i].type + `</option>`
    var options = "";
    typeAllow.forEach(item => {
      if( item != frameData[i].type){
        options += `<option value="` + item + `">` + item + `</option>`
      }
    })
    var filetype = `<select id="imgtype-` + (i + index) + `" class="input-btn-skill" 
    name="æ–‡ä»¶æ ¼å¼"
    style="width: 60px; min-width: 60px; height:22px; width: 14ch; color: var(--mainColor); font-size: 12;" 
    onchange="
    var name = document.getElementById('fileName-' +` + (i + index) + `);
    var text = name.value.split('.')[0] + '.' + this.value; 
    name.value = text;
    message([[this.value,'` + frameData[i].id + `'],'exportTypeSet']);
    imgExportData[`+ (i + index) +`].fileName = text ">
      `+ option + options +`
    </select>`
    var info = `<div class="info">
      <span style="opacity: 0.5;">` + ((i + index) + 1) + `.</span>
      <input type="text" class="input-nobg" id="fileName-` + (i + index) + `"value="` + frameData[i].name + `.` + frameData[i].type + `" 
      onKeyPress="if(window.event.keyCode==13) this.blur()" 
      onchange="imgExportData[`+ (i + index) +`].fileName = this.value; 
      var type = this.value.split('.')[1] ? this.value.split('.')[1].toLowerCase() : '';
      if (type && typeAllow.includes(type)){
      document.getElementById('imgtype-' +` + (i + index) + `).value = type;
      } else {
       this.value = this.value.split('.')[0] + '.' + document.getElementById('imgtype-' +` + (i + index) + `).value;
      }
      
      //console.log(imgExportData.map(item => item.fileName))"/>
    </div>`;
    var size = '<span id="imgsize-'+ (i + index) +'" style="color:var(--mainColor2);opacity: 0.8;"></span>';
    var setsize = `<div class="input-btn-skill" style="width: 60px; min-width: 60px; height:20px" >
      <input  id="exportSize-` + (i + index) + `" type="text" class="input-btn-skill" 
      style="border:0px; height: 18px;" value="` + frameData[i].s + `" 
      onKeyPress="if(window.event.keyCode==13) this.blur()" 
      onchange="message([[this.value,'` + frameData[i].id + `'],'exportSizeSet']);
      imgExportData[`+ (i + index) +`].s = this.value;
      console.log(imgExportData.map(item => item.s))"/>
      <div class="input-btn-skill" style="border:0px; width:30px; border-radius: 0px ;background-color: var(--boxGry); opacity: 0.8;  color:var(--mainColor)">k</div>
      </div>`
    var chk = `
    <input id="chk-export-` + (i + index) + `" type="checkbox" style="display: none;" />
    <label for="chk-export-` + (i + index) + `" class="chk-export-key set" style="width:100%; display: flex;align-items: center;gap: 4px;">
      `+ info +`
      <svg style="display:var(--export-edit);" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="14" height="14" viewBox="0 0 10 10">
          <g transform="matrix(0.8660253882408142,0.5,-0.5,0.8660253882408142,1.3172291698792833,-2.3877065935394057)">
            <path fill="var(--has)" d="M8.4255957421875,1.264617919671875L8.4255957421875,6.264129638671875Q8.4255957421875,6.313379638671875,8.4159857421875,6.361679638671875Q8.4063857421875,6.409969638671875,8.3875357421875,6.455469638671875Q8.3686957421875,6.500969638671875,8.3413357421875,6.541909638671875Q8.3139757421875,6.582859638671875,8.2791557421875,6.617679638671875Q8.244325742187499,6.652499638671875,8.2033857421875,6.679859638671875Q8.1624357421875,6.707219638671875,8.1169357421875,6.726069638671875Q8.0714457421875,6.744909638671875,8.0231457421875,6.754519638671875Q7.9748457421875,6.764129638671875,7.9255957421875,6.764129638671875Q7.8640457421875,6.764129638671875,7.8043357421875,6.749199638671875L4.9928757421875,6.046379638671875Q4.9117407421875,6.026099638671875,4.8416217421875,5.980519638671875Q4.7715037421875,5.934939638671875,4.7200357421875,5.869019638671875Q4.6685667421875,5.803099638671875,4.6413517421875,5.724019638671875Q4.6141357421875,5.644939638671875,4.6141357421875,5.561309638671875Q4.6141357421875,5.512059638671875,4.6237427421875,5.463759638671875Q4.6333507421875,5.415469638671875,4.6521957421875,5.369969638671875Q4.6710417421875,5.324469638671875,4.6984007421875,5.283519638671875Q4.7257607421875,5.2425796386718755,4.7605827421875,5.207759638671876Q4.7954047421875,5.172929638671874,4.8363507421875,5.145579638671875Q4.8772967421875,5.118219638671874,4.9227937421875,5.099369638671876Q4.9682907421875,5.080519638671875,5.0165906421875,5.0709196386718745Q5.0648900421875,5.061309638671875,5.1141357421875,5.061309638671875Q5.1756846421875,5.061309638671875,5.2353957421875,5.0762396386718756L5.2358847421875,5.076359638671875L7.4255957421875,5.623749638671875L7.4255957421875,1.264129638671875Q7.4255957421875,1.214883938671875,7.435205742187501,1.166584538671875Q7.4448157421875,1.118284638671875,7.4636557421875,1.0727876386718749Q7.4825057421875005,1.027290638671875,7.5098657421875,0.986344638671875Q7.5372257421875,0.945398638671875,7.5720457421875,0.910576638671875Q7.6068657421875,0.875754638671875,7.6478157421875,0.848394638671875Q7.6887557421874995,0.821035638671875,7.7342557421875,0.802189638671875Q7.7797557421875005,0.783344638671875,7.8280557421875,0.7737366386718749Q7.8763557421875,0.764129638671875,7.9255957421875,0.764129638671875Q7.9748457421875,0.764129638671875,8.0231457421875,0.7737366386718749Q8.0714457421875,0.783344638671875,8.1169357421875,0.802189638671875Q8.1624357421875,0.821035638671875,8.2033857421875,0.848394638671875Q8.244325742187499,0.875754638671875,8.2791557421875,0.910576638671875Q8.3139757421875,0.945398638671875,8.3413357421875,0.986344638671875Q8.3686957421875,1.027290638671875,8.3875357421875,1.0727876386718749Q8.4063857421875,1.118284638671875,8.4159857421875,1.166584538671875Q8.4255957421875,1.214883938671875,8.4255957421875,1.264129638671875L8.4255957421875,1.264617919671875Z" fill-rule="evenodd" fill-opacity="1"/>
          </g>
          <rect stroke="var(--boxBod)" x="0.5" y="0.5" width="9" height="9" rx="1.5" fill-opacity="0" stroke-opacity="1"  fill="none" stroke-width="1"/>
      </svg>
    </label>`
    var node = document.createElement('div');
    node.className = "tags-exports";
    node.id = "tags-exports-" + (i + index);
    node.innerHTML = '<div style="display:flex;gap:4px; align-items: center; width:100%;"><div class="btn-text" style="width:14px; height:14px; z-index:1;"onclick="this.parentNode.parentNode.remove();imgExportData['+ (i + index) +`].fileName = ''"><btn-close style=" opacity: 0.6;"></btn-close></div>` + chk + '</div><div class="set">' + size + '<div style="display:flex; gap:4px">'  + setsize + filetype + '</div></div>';
    tagsContainer2.appendChild(node);
    console.log("åˆ›å»ºå¯¼å‡ºï¼šç¬¬" + (i + index))
    exportNum++
  }

}
//åˆ é™¤å¯¼å‡ºæ ‡ç­¾
function noExport(e){
  if(e == 'all'){
    tagsContainer2.innerHTML = "";
    imgExportData = [];
    imgExportInfo = [];
    exportNum = 0;
    exportInfo.innerHTML = "[-- æœªé€‰ä¸­å®¹å™¨ --]"
  }
}

//ç”Ÿæˆå›¾ç‰‡æ ‡ç­¾
function addImg(imgsName) {
  tagsContainer1.innerHTML = "";
  var icon = `
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="20" height="16" viewBox="0 0 16 13.75732421875">
    <rect x="0" y="11.75732421875" width="16" height="2" rx="0" fill="#6E6E6E" fill-opacity="1"/>
    <g transform="matrix(0.7071067690849304,-0.7071067690849304,0.7071067690849304,0.7071067690849304,-2.3430887013528263,2.8286348765686853)">
      <rect x="2.242919921875" y="4.24267578125" width="6" height="9" rx="0" fill="#6E6E6E" fill-opacity="1"/>
      <path d="M5.242919921875,10.24267578125L6.727839921875,11.75775578125L8.242919921875,13.24267578125L6.727839921875,14.727595781249999L5.242919921875,16.24267578125L3.757999921875,14.727595781249999L2.242919921875001,13.24267578125L3.757999921875,11.75775578125L5.242919921875,10.24267578125Z" fill="#6E6E6E" fill-opacity="1"/>
    </g>
  </svg>
  `
  for (var i = 0; i < imgsName.length; i++) {
    //tagsContainer1.innerHTML += '<div class="tags-imports">' + icon + '<div style="width:4px"></div><input id="imgName-' + i + '" class="input-btn-skill" style="border: 0;text-align: left;" type="text" value="' + imgsName[i].name + '" onchange="imgsNameNew[' + i + '].name = this.value; if (!this.value){this.value = imgsName[' + i + '].name;console.log(`æ¢å¤åŸå‘½å`,imgsName[' + i + ']) }"/></div>';
    tagsContainer1.innerHTML += '<div class="tags-imports"><div style="width:4px">' + (i + 1) + '.' + imgsName[i] + '</div>';

  }
}

//ç”Ÿæˆç¼–è¾‘æ ‡ç­¾
function addEdit(type,copynode) {
  if(copynode){
    copyEdit = copynode.parentNode
  } else {
    editTag.scrollTop = 0;
  }
  if ( editTag.children.length !== 0){
    document.getElementById('chk-editor-' + editorPick).checked = false
  }
  var chk = '<input id="chk-editor-' + editorNum + '" type="checkbox" checked=" true" style="display:none" onchange="editorChk(this,' + editorNum + ')"/>'
  var main = type;
  var close = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 17 17"><g><g><rect x="3.5" y="7.5" width="10" height="2" rx="0" fill="var(--mainColor)" fill-opacity="1"/></g><g><ellipse cx="8.5" cy="8.5" rx="8" ry="8" fill-opacity="0" stroke-opacity="1" stroke="var(--mainColor)" fill="none" stroke-width="1"/></g></g></svg>';
  var set = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 18 18"><g><path d="M3.59452,1.67756L6.80722,3.70617L7.6445,0L10.3555,0L11.1928,3.70617L14.4055,1.67756L16.3224,3.59452L14.2938,6.80722L18,7.64451L18,10.3555L14.2938,11.1928L16.3224,14.4055L14.4055,16.3224L11.1928,14.2938L10.3555,18L7.64451,18L6.80722,14.2938L3.59452,16.3224L1.67756,14.4055L3.70617,11.1928L0,10.3555L0,7.64451L3.70617,6.80722L1.67756,3.59452L3.59452,1.67756ZM13.5,9C13.5,11.4853,11.4853,13.5,9,13.5C6.51472,13.5,4.5,11.4853,4.5,9C4.5,6.51472,6.51472,4.5,9,4.5C11.4853,4.5,13.5,6.51472,13.5,9ZM9.00006,11.9999C10.6569,11.9999,12.0001,10.6568,12.0001,8.99994C12.0001,7.34308,10.6569,5.99994,9.00006,5.99994C7.34321,5.99994,6.00006,7.34308,6.00006,8.99994C6.00006,10.6568,7.34321,11.9999,9.00006,11.9999Z" fill-rule="evenodd" fill="var(--mainColor)" fill-opacity="1"/></g></svg>';
  var copy = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 11 11"><g><g><path d="M5,2L4,2L4,4L2,4L2,5L4,5L4,7L5,7L5,5L7,5L7,4L5,4L5,2Z" fill-rule="evenodd" fill="var(--mainColor)" fill-opacity="1"/></g><g><path d="M0,2.5L0,6.5Q0,7.53553,0.732233,8.26777Q1.29574,8.83127,2.03888,8.96112Q2.16872,9.70426,2.73223,10.2678Q3.46447,11,4.5,11L8.5,11Q9.53553,11,10.2678,10.2678Q11,9.53553,11,8.5L11,4.5Q11,3.46447,10.2678,2.73223Q9.70426,2.16872,8.96112,2.03888Q8.83127,1.29574,8.26777,0.732233Q7.53553,0,6.5,0L2.5,0Q1.46447,0,0.732233,0.732233Q0,1.46447,0,2.5ZM9,3.08099L9,6.5Q9,7.53553,8.26777,8.26777Q7.53553,9,6.5,9L3.08099,9Q3.18864,9.30996,3.43934,9.56066Q3.87868,10,4.5,10L8.5,10Q9.12132,10,9.56066,9.56066Q10,9.12132,10,8.5L10,4.5Q10,3.87868,9.56066,3.43934Q9.30996,3.18864,9,3.08099ZM1.43934,7.56066Q1,7.12132,1,6.5L1,2.5Q1,1.87868,1.43934,1.43934Q1.87868,1,2.5,1L6.5,1Q7.12132,1,7.56066,1.43934Q8,1.87868,8,2.5L8,6.5Q8,7.12132,7.56066,7.56066Q7.12132,8,6.5,8L2.5,8Q1.87868,8,1.43934,7.56066Z" fill-rule="evenodd" fill="var(--mainColor)" fill-opacity="1"/></g></g></svg>';
  if (type == 'HSL') {

  }
  if (type == 'é€è§†') {

  }
  if (type == 'æ¸å˜æ˜ å°„') {

  }
  if (type == 'æ»¤é•œ') {

  }
  if (type == 'å˜å½¢') {

  }
  var newEdit = document.createElement('div')
  newEdit.id = 'edits-'+ editorNum;
  newEdit.className = 'edits';
  newEdit.draggable = true;
  newEdit.innerHTML = chk + '<label for="chk-editor-' + editorNum + '" class="tags-editor"><div class="btn-text" style="width:10px;height:10px" onclick="if(this.parentNode.parentNode.firstChild.checked !== true) { this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)};">' + close + '</div>' + type + '<div class="btn-text" style="width:10px;height:10px"></div></label>' +  '<div class="btn-text" style="width:10px;height:10px;position: absolute;top:7px;right:-8px;" onclick="addEdit(this.parentNode.innerText,this);">' + copy + '</div>'
  if ( editTag.children.length == 0 ){
    editTag.appendChild(newEdit)
  } else {
    if (copynode){
      editTag.insertBefore(newEdit,copyEdit)
    } else {
      editTag.insertBefore(newEdit,editTag.children[0])
    }
  }
  
  editorPick = editorNum;
  editorNum++;
  editsID()
}
function editorChk(node,e) {
    if (e !== editorPick) {
      document.getElementById('chk-editor-' + editorPick).checked = false;
      node.checked = true;
      editorPick = e;
      //console.log("new", editorPick, e)
    } else {
        //node.checked = false;
        //console.log("copy", editorPick, e)
        node.checked = true;
        //console.log("old", editorPick, e)

  }
}

//æ‹–æ‹½ç¼–è¾‘æ ‡ç­¾
function editsID(){  
  for (var i = 0; i < dragSources.length; i++) {
    dragSources[i].addEventListener('dragstart', function(event) {
      event.dataTransfer.setData("text/plain", event.target.id); 
      dropStartY = event.clientY;
    });
  
    dragSources[i].addEventListener('dragend', function(event) {
      event.dataTransfer.clearData("text/plain");
      dropEndY = event.clientY;
    });
  }
}

//æ¢¯åº¦å˜åŒ–ç±»å‹
function chkMix(type,checked){
  if (checked){
    mixType.push(type)
    //console.log(mixType)
  } else {

    if(mixType.includes(type)){
      mixType = mixType.filter(item => item !== type)
      //console.log(mixType)
    }
  }
}

//æŸ¥æ‰¾ç›¸ä¼¼ç±»å‹
function chkSame(type,checked){
  if (checked){
    searchSameType.push(type)
  } else {

    if(searchSameType.includes(type)){
      searchSameType = searchSameType.filter(item => item !== type)
    }
  }
}


//æŸ¥æ‰¾å¹¶é€‰ä¸­
function searchToRe(info) {
  message([{ area: searchArea, type: searchType, info: info }, 'searchToRe'])
}
//æŸ¥æ‰¾ç±»å‹
function chkSearchType(e) {
  if (e.id.split("-")[2] !== searchType) {
    message([{ area: searchArea, type: e.id.split("-")[2], info: searchInfo }, 'searchToRe'])
  }
  //var type = ["Text", "Component", "ComponentSet", "Font"]
  var type = ["Text", "Name"]

  for (var i = 0; i < type.length; i++) {
    document.getElementById("chk-for-" + type[i]).checked = false
  }

  e.checked = true
  searchType = e.id.split("-")[2]

}

//è¾“å…¥å€æ•°
function chkNum(e) {
  for (var i = 0; i < 4; i++) {
    document.getElementById('chk-num-list').style.opacity = '1';
    document.getElementById('chk-num-' + i).checked = false;
    document.getElementById('chk-num-' + e).checked = true;
  }
  document.getElementById('input-num-2').value = e + 1;
  document.getElementById('input-num-2').style.color = 'var(--boxBod)';
}

//é€‰æ‹©å€æ•°
function numSize() {
  for (var i = 0; i < 4; i++) {
    document.getElementById('chk-num-' + i).checked = false;

  }
  document.getElementById('input-num-2').style.color = 'var(--mainColor)';
  if (document.getElementById('input-num-2').value != "") {
    document.getElementById('chk-num-list').style.opacity = '0.5';
  } else {
    document.getElementById('chk-num-list').style.opacity = '1';
  }
}


//ç¼©æ”¾ä¸­å¿ƒ
function chkScaleCenter(e) {
  var center = ["TL", "TC", "TR", "CL", "CC", "CR", "BL", "BC", "BR"]
  for (var i = 0; i < center.length; i++) {
    document.getElementById("chk-scale-" + center[i]).checked = false
  }
  e.checked = true
  scaleCenter = e.id.split("-")[2]
}
//ç¼©æ”¾ç±»å‹
function chkScaleType(e) {
  var type = ["W", "H", "WH"]
  if (scaleType != e.id.split("-")[2]) {
    if (e.id.split("-")[2] == "WH") {
      document.getElementById("input-num-scale").value = 100;
    } else {
      document.getElementById("input-num-scale").value = 0;
    }
  }
  for (var i = 0; i < type.length; i++) {
    document.getElementById("chk-scale-" + type[i]).checked = false
  }

  e.checked = true
  scaleType = e.id.split("-")[2]

}
//ç­‰æ¯”ç¼©æ”¾
function chkScale(s) {
  //message([{center:scaleCenter,type:scaleType,value:s},'scaleSelf'])
}

//éå†å‰©ä½™æ ‡ç­¾ï¼Œè¯»å–å¯¹åº”æ•°ç»„çš„å®½é«˜ï¼Œå¹¶å‘å¾€ä¸»çº¿ç¨‹ï¼Œä»¥åˆ›å»ºç”»æ¿
function createrObj() {
  if (createrType == "frame") {
    console.log('å·²ä¸Šä¼ æ•°é‡ï¼š' + allFrame.length);

    for (var i = 0; i < allFrame.length; i++) {
      if (document.getElementById('tag-' + i).style.display !== 'none') {
        finalFrame.push(allFrame[i])
      }
    }
    console.log('å·²é€‰æ‹©ï¼š' + finalFrame.length);
    message([finalFrame, "createrframe"])
    finalFrame = [];
  }

}

//é€‰æ‹©è½¬çŸ¢é‡ç±»å‹
function chkVector(e) {
  for (var i = 0; i < 4; i++) {
    document.getElementById('chk-vector-' + i).checked = false;
    document.getElementById('chk-vector-' + e).checked = true;
  }
}

//è¿”å›å›¾ç‰‡å®½é«˜ä¿¡æ¯å’Œåˆ†æ®µï¼Œæ¢å¤å›¾ç‰‡åŸå°ºå¯¸
function imgURLtoWH(e) {
  var img = new Image();
  img.src = e.imgURL;
  img.onload = function () {
    message([{ w:img.width, h:img.height,index:e.index}, 'imgWH'])
  }
}

//æ·»åŠ å™ªç‚¹
function noise() {
  var noiseV = document.getElementById('input-num-tjzs').value
  var dom = document.createElement('canvas');
  dom.width = 512;
  dom.height = 512;
  var ctx = dom.getContext('2d');
  /*
  for (let y = 0; y < e[0]; y++) {
    for (let x = 0; x < e[1]; x++) {
      var color = Math.floor(Math.random() * 12 + (255 - 16)).toString(16);
      ctx.fillStyle = `#${color}${color}${color}`;
      ctx.fillRect(x, y, 1, 1);
    };
  };
  */
  for (var i = 0; i < noiseV * 65536; i++) {
    var x = Math.random() * dom.width;
    var y = Math.random() * dom.height;
    var color = Math.floor(Math.random() * 6 + (255 - 16)).toString(16);
    //ctx.fillStyle = `#${color}${color}${color}`;
    ctx.fillStyle = 'rgba(' + Math.random() * 255 + ',' + Math.random() * 255 + ',' + Math.random() * 255 + ',' + (Math.random() * 0.5 + 0.5) + ')';
    ctx.beginPath();
    ctx.arc(x, y, Math.random() * 0.5, 0, 6);
    ctx.fill();
  }
  var url = dom.toDataURL(`image/png`, 0.6);
  return B64ToU8A(url.split(',')[1]);

}


function reCenter(event, node) {
  var XY = [event.pageX - node.x, event.pageY - node.y]
  var x = Math.round(inView.x + XY[0] * inView.s)
  var y = Math.round(inView.y + XY[1] * inView.s)
  singleClick = false;
  //console.log(node)
  //console.log(x,y,node.width,node.height,XY,inView.s)
  message([{ x: x, y: y }, "reCenter"])


}

//æ–œåˆ‡
function skew(e) {
  if (e) {
    var skewInfo = {
      x: parseInt(document.getElementById('input-num-skewW').value),
      y: parseInt(document.getElementById('input-num-skewH').value),
      w: parseInt(document.getElementById('input-num-scaleW').value),
      h: parseInt(document.getElementById('input-num-scaleH').value),
    }
    //console.log(skewInfo)
    message([skewInfo, 'skewSet'])
  } else {
    document.getElementById('slider-skewW').value = 0;
    document.getElementById('slider-skewH').value = 0;
    document.getElementById('input-num-skewW').value = 0;
    document.getElementById('input-num-skewH').value = 0;
    document.getElementById('slider-scaleW').value = 100;
    document.getElementById('slider-scaleH').value = 100;
    document.getElementById('input-num-scaleW').value = 100;
    document.getElementById('input-num-scaleH').value = 100;
    message([{ x: 0, y: 0, w: 100, h: 100 }, 'skewSet'])
  }

}


//////ä½¿ç”¨å…«å‰æ ‘æå–è‰²è¡¨//////
//å®šä¹‰å…«å‰æ ‘
class OctreeNode {
  constructor(level, parent) {
      this.level = level; // å½“å‰èŠ‚ç‚¹æ‰€åœ¨çš„å±‚æ¬¡
      this.pixelCount = 0; // å½“å‰èŠ‚ç‚¹åŒ…å«çš„åƒç´ æ•°é‡
      this.redSum = 0;     // çº¢è‰²åˆ†é‡çš„æ€»å’Œ
      this.greenSum = 0;   // ç»¿è‰²åˆ†é‡çš„æ€»å’Œ
      this.blueSum = 0;    // è“è‰²åˆ†é‡çš„æ€»å’Œ
      this.paletteIndex = -1; // å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè®°å½•å…¶åœ¨è°ƒè‰²æ¿ä¸­çš„ç´¢å¼•
      this.children = new Array(8); // å­èŠ‚ç‚¹æ•°ç»„
      this.parent = parent; // çˆ¶èŠ‚ç‚¹å¼•ç”¨
  }

  // åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹
  isLeaf() {
      return this.children.every(child => child === undefined);
  }

  // è·å–å½“å‰èŠ‚ç‚¹çš„å¹³å‡é¢œè‰²
  getAverageColor() {
      if (this.pixelCount === 0) return [0, 0, 0];
      return [
          Math.round(this.redSum / this.pixelCount),
          Math.round(this.greenSum / this.pixelCount),
          Math.round(this.blueSum / this.pixelCount)
      ];
  }
}
//æ„å»ºå…«å‰æ ‘
class OctreeQuantizer {
  constructor(maxDepth) {
      this.maxDepth = maxDepth;
      this.root = new OctreeNode(0, null);
      this.palette = [];
      this.leafNodes = [];
  }

  // æ’å…¥ä¸€ä¸ªåƒç´ åˆ°å…«å‰æ ‘ä¸­
  insertPixel(pixel) {
      let node = this.root;
      for (let level = 0; level < this.maxDepth; level++) {
          const index = this.getOctantIndex(pixel, level);
          if (!node.children[index]) {
              node.children[index] = new OctreeNode(level + 1, node);
          }
          node = node.children[index];
      }
      node.pixelCount++;
      node.redSum += pixel[0];
      node.greenSum += pixel[1];
      node.blueSum += pixel[2];
  }

  // æ ¹æ®å½“å‰å±‚çº§è·å–å…«å‰æ ‘ç´¢å¼•
  getOctantIndex(pixel, level) {
      const bitShift = 8 - level - 1;
      const redBit = (pixel[0] >> bitShift) & 0x1;
      const greenBit = (pixel[1] >> bitShift) & 0x1;
      const blueBit = (pixel[2] >> bitShift) & 0x1;
      return (redBit << 2) | (greenBit << 1) | blueBit;
  }

  // åˆå¹¶å¶å­èŠ‚ç‚¹ä»¥å‡å°‘é¢œè‰²æ•°é‡
  reduceColors(targetColors) {
      while (this.leafNodes.length > targetColors) {
          let deepestNode = null;
          for (const leaf of this.leafNodes) {
              if (!deepestNode || leaf.level > deepestNode.level) {
                  deepestNode = leaf;
              }
          }
          this.mergeNode(deepestNode);
      }
  }

  // åˆå¹¶ä¸€ä¸ªèŠ‚ç‚¹
  mergeNode(node) {
      if (!node.isLeaf()) return;

      node.parent.pixelCount += node.pixelCount;
      node.parent.redSum += node.redSum;
      node.parent.greenSum += node.greenSum;
      node.parent.blueSum += node.blueSum;
      node.parent.children[node.getIndex()] = undefined;

      const index = this.leafNodes.indexOf(node);
      if (index !== -1) {
          this.leafNodes.splice(index, 1);
      }
      if (node.parent.isLeaf()) {
          this.leafNodes.push(node.parent);
      }
  }

  // ç”Ÿæˆè°ƒè‰²æ¿
  generatePalette() {
      this.leafNodes = [];
      this.collectLeaves(this.root);

      this.palette = this.leafNodes.map((leaf, index) => {
          leaf.paletteIndex = index;
          return leaf.getAverageColor();
      });
  }

  // æ”¶é›†æ‰€æœ‰å¶å­èŠ‚ç‚¹
  collectLeaves(node) {
      if (node.isLeaf()) {
          this.leafNodes.push(node);
      } else {
          for (const child of node.children) {
              if (child) {
                  this.collectLeaves(child);
              }
          }
      }
  }

  // è·å–è°ƒè‰²æ¿
  getPalette() {
      return this.palette;
  }
}

//è½½å…¥å›¾ç‰‡æ•°æ®
async function imgDataSet(imgDataOld,imgDataNew,isNew) {
  //console.log(imgExportInfo)
    if(isNew == "new"){
      imgExportData = [];
      var imgData = imgDataNew;
      for (var i = 0; i < imgData.length; i++) {
        var fileName = document.getElementById('fileName-' + i).value;
        var s = document.getElementById('exportSize-' + i).value;
        var colorBox = await getColorBox2(imgData[i]);//å…«å‰æ ‘æ³•
        imgExportData.push({u8a:imgData[i],src:U8AToB64(imgData[i]),fileName: fileName,s:s,col:colorBox})
        //console.log(imgExportData)
        if ( imgData[i].length/1000 <= s || s == ''){
          document.getElementById('imgsize-' + i).innerHTML =  Math.floor(imgData[i].length/1000)  + 'k /æ— éœ€å‹ç¼©' 
        } else {
          document.getElementById('imgsize-' + i).innerHTML =  Math.floor(imgData[i].length/1000) + 'k /<span style="color:var(--liColor1)">å¾…å‹ç¼©</span>' 
        }
    }
    }else{
      var imgData = imgDataNew;

      var index = exportNum - imgDataNew.length
      //console.log(exportNum,index)
      for (var i = 0; i < imgData.length; i++) {
        
        if ( document.getElementById('fileName-' + (i + index)) ){
          var fileName = document.getElementById('fileName-' + (i + index)).value
          var s = document.getElementById('exportSize-' + (i + index)).value
        } else {
          var fileName = ''
          var s = ''
        }
        var colorBox = await getColorBox2(imgData[i]);//å…«å‰æ ‘æ³• 
        imgExportData.push({u8a:imgData[i],src:U8AToB64(imgData[i]),fileName: fileName,s:s,col:colorBox})
      }

      //console.log(imgExportData)
      for (var i = 0; i < imgData.length; i++) {
        //console.log((i + index - 1))
        if ( imgExportData[(i + index)].u8a.length/1000 <= imgExportData[(i + index)].s || imgExportData[(i + index)].s == ''){
          document.getElementById('imgsize-' + (i + index)).innerHTML =  Math.floor(imgExportData[(i + index)].u8a.length/1000)  + 'k /æ— éœ€å‹ç¼©' 
        } else {
          document.getElementById('imgsize-' + (i + index)).innerHTML =  Math.floor(imgExportData[(i + index)].u8a.length/1000) + 'k /<span style="color:var(--liColor1)">å¾…å‹ç¼©</span>' 
        }
      }

    }

}
function getColorBox2(imgDatas){
  return new Promise((resolve, reject) => {
    var blob = new Blob([imgDatas], { type: 'image/png' }); 
    var url = URL.createObjectURL(blob);
    var img = new Image()
    img.src = url;

    img.onload = function(){
      var canvas = document.createElement('canvas');
      canvas.width = img.width;
      canvas.height = img.height;
      var ctx = canvas.getContext('2d')
      ctx.drawImage(img,0,0)
      var imageData = ctx.getImageData(0,0,img.width,img.height)
      var data = imageData.data;

      function quantizeImage(datas) {
        const octree = new OctreeQuantizer(3); // è®¾ç½®æœ€å¤§æ·±åº¦

        // æ’å…¥æ¯ä¸ªåƒç´ åˆ°å…«å‰æ ‘ä¸­
        for (let i = 0; i <  datas.length; i += 4) {
            const r =  datas[i];
            const g =  datas[i + 1];
            const b =  datas[i + 2];
            octree.insertPixel([r, g, b]);
        }

        // å‡å°‘é¢œè‰²æ•°é‡
        octree.reduceColors(128);

        // ç”Ÿæˆè°ƒè‰²æ¿
        octree.generatePalette();

        return octree.getPalette();
      }

      resolve(quantizeImage(imageData.data))

    }
  })
}

//å¯¼å‡ºå›¾ç‰‡ä¸ºzip
async function exportImg(){
  //console.log(666)
  if(imgExportData.length > 0){
    //console.log(777)
    try {
      //console.log(888)
      const compressedImages = await compressImages(imgExportData);
      createZipAndDownload(compressedImages);
    } catch (error) {
      console.error('å¤„ç†è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:', error);
    }
  }
  
}

//å•ä¸ªå›¾ç‰‡çš„å‹ç¼©
function compressImage(blob,quality,type,colorBox) {
   //console.log(u8a,quality,type)
    if (type == 'jpg' || type == 'jpeg'){
      //console.log(type)
      return new Promise((resolve, reject) => {
        //var blob = new Blob([u8a], { type: 'image/jpeg' });
        var file = new File([blob],'image.jpg',{type:'image/jpeg'})
        //console.log(file)
        new Compressor(file, {
          quality:quality/10,
          success(result) {
            resolve(result);
          },
          error(err) {
            reject(err);
          },
        });
      });
    } else if ( type == 'png') {
      var colorThief = new ColorThief();
      return new Promise((resolve, reject) => {
        //var blob = new Blob([u8a], { type: 'image/png' });    
        if(quality == 10){
          resolve(blob)
        } else {
          var url = URL.createObjectURL(blob);
          var img = new Image()
          img.src = url;

          img.onload = function(){
            var palette = colorThief.getPalette(img,20,1)//æå–å…³é”®é¢œè‰²
            var canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            var ctx = canvas.getContext('2d')
            ctx.drawImage(img,0,0)
            var imageData = ctx.getImageData(0,0,img.width,img.height)
            var data = imageData.data;
            var colorcut = new Promise((resolve, reject) => {
              var deep = [0,2,6,8,12,14,16,18,20,22]
              var newStep = deep[Math.floor(10 - quality)];  

              function toStep(value,step){//é€šè¿‡æ­¥é•¿é™å®šè‰²å€¼ï¼ˆå¤±çœŸï¼‰
                return Math.round(value/step)*step
              }

              function findColor(r,g,b){//é€šè¿‡è‰²æ¿ç®€åŒ–é¢œè‰²ï¼ˆä¿çœŸï¼‰
                var palette2 = [...palette,...colorBox];
                //console.log(palette2)
                var minDist = Infinity;
                var keyColor = null;
                
                if ( !palette2.includes([r,g,b])){
                  for ( var i = 0; i < palette2.length; i++){
                    //var dist = Math.abs(palette2[i][0] - r) + Math.abs(palette2[i][1] - g) + Math.abs(palette2[i][2] - b);
                    var dist = Math.sqrt(
                      Math.pow(palette2[i][0] - r,2) + Math.pow(palette2[i][1] - g,2) + Math.pow(palette2[i][2] - b,2)
                    )
                    if ( dist < minDist){
                      minDist = dist;
                      keyColor = [palette2[i][0],palette2[i][1],palette2[i][2]]
                    }
                  }
                } else {
                  keyColor = [r,g,b]
                }
                
                return keyColor
              }

              //*
              for (var i = 0; i < data.length; i += 4){
                var [r,g,b,a] = [data[i],data[i + 1],data[i + 2],data[i + 3]];
                var x = (i / 4) % img.width,y = Math.floor((i / 4) / img.width);//è·å–åƒç´ åæ ‡
                if(r !== g && r !== b && g !== b ){
                  data[i] = toStep(r,newStep);
                  data[i + 1] = toStep(g,newStep);
                  data[i + 2] = toStep(b,newStep);
                }
                if ( quality < 5){
                  if ( a < 10 || a > 245){
                    data[i + 3] = a;
                  } else {
                    var stepA = Math.ceil(2.5 * ((10 - quality)/10 + 1));
                    newA = Math.floor((a - 1) / stepA) * stepA + 1;
                    ea = newA - data[i + 3];
                    data[i + 3] = newA;

                    function floyd(dx,dy,factor){//è¯¯å·®æ‰©æ•£
                      if (x + dx >= 0 && x + dx < img.width && y + dy < img.height){
                        var newIndex = ((y + dy) * img.width + (x + dx)) * 4;//å½“å‰åƒç´ çš„å‘¨å›´åƒç´ 
                        data[newIndex + 3] += ea * factor;//æŠ–åŠ¨
                      }
                    }
                    //*
                    floyd(1,0,7/32)
                    floyd(-1,1,3/32)
                    floyd(0,1,4/32)
                    floyd(1,1,2/32)
                    floyd(2,0,6/32)
                    floyd(-2,2,2/32)
                    floyd(0,2,5/32)
                    floyd(2,2,3/32)//çŸ©é˜µ
                    //*/
                  }
                } else {
                  data[i + 3] = a;
                }
              }
              //*/

              if ( quality == 9){
                for (var i = 0; i < data.length; i += 4){
                  var [r,g,b,a] = [data[i],data[i + 1],data[i + 2],data[i + 3]];
                  var x = (i / 4) % img.width,y = Math.floor((i / 4) / img.width);//è·å–åƒç´ åæ ‡
                  if(r !== g && r !== b && g !== b ){
                    var cl = findColor(r,g,b);
                    var er = r - cl[0], eg = g - cl[1], eb = b - cl[2];
                    data[i] = cl[0];
                    data[i + 1] = cl[1];
                    data[i + 2] = cl[2];
                    function floyd(dx,dy,factor){//è¯¯å·®æ‰©æ•£
                      if (x + dx >= 0 && x + dx < img.width && y + dy < img.height){
                        var newIndex = ((y + dy) * img.width + (x + dx)) * 4;//å½“å‰åƒç´ çš„å‘¨å›´åƒç´ 
                        data[newIndex] += er * factor;
                        data[newIndex + 1] += eg * factor;
                        data[newIndex + 2] += eb * factor;//æŠ–åŠ¨
                      }
                    }
                    //*
                    floyd(1,0,7/32)
                    floyd(-1,1,3/32)
                    floyd(0,1,4/32)
                    floyd(1,1,2/32)
                    floyd(2,0,6/32)
                    floyd(-2,2,2/32)
                    floyd(0,2,5/32)
                    floyd(2,2,3/32)//çŸ©é˜µ
                    //*/
                    
                  }
                }

              }
              ctx.putImageData(imageData,0,0);
              canvas.toBlob(function(blob){
                resolve(blob)
              },'image/png')
            })

            resolve(colorcut)
          }
        }
        
      })
      //return new Blob([u8a], { type: 'image/png' });
    } else if ( type == 'webp') {
      return new Promise((resolve, reject) => {
        //var blob = new Blob([u8a], { type: 'image/png' });
        var url = URL.createObjectURL(blob);
        var img = new Image()
        img.src = url;

        img.onload = function(){
          var palette = colorThief.getPalette(img,20,1)
          //console.log(Math.pow(2,quality*10))
          var canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          var ctx = canvas.getContext('2d')
          ctx.drawImage(img,0,0)
          canvas.toBlob(function(blob){
            resolve(blob)
          },'image/webp',(quality/10))
        }
      })
    }
  
}

// æ‰¹é‡å‹ç¼©
async function compressImages(imgExportData) {
  //console.log(999)
  var imageDataArray = imgExportData.map(item => item.u8a)
  var targetSize = imgExportData.map(item => item.s*1000)
  var type = imgExportData.map(item => item.fileName.split('.').pop())
  var colorBox = imgExportData.map(item => item.col)
  const compressedImages = [];
  for (let i = 0; i < imageDataArray.length; i++) {
    var quality = 10; // åˆå§‹å‹ç¼©è´¨é‡
    //console.log(111)
    var result = new Blob([imageDataArray[i]], { type: 'image/png' });//åˆå§‹åŒ–
    //console.log(222,result.size,[i],imageDataArray[i].length,targetSize[i])
    //if (targetSize[i] && imageDataArray[i].length > targetSize[i] ){//å·²åˆ é™¤è¯¥åˆ¤æ–­ï¼Œä¼šå¯¼è‡´épngæ ¼å¼ç¼–ç é”™è¯¯
    var newBlob = new Blob([imageDataArray[i]], { type: 'image/jpeg' });
      do {
        try {
          result = await compressImage(newBlob, quality,type[i],colorBox[i]);
          if (quality == 9){//å…ˆä¸Š256è‰²+æ‰©æ•£ç®—æ³•ï¼Œåé¢é å‡è‰²å‹ç¼©
            newBlob = result;
          }
          if (targetSize[i] && result.size > targetSize[i] && quality > 1) {
            if ( quality - 1 >= 0){
              console.log("å‹ç¼©è´¨é‡:" + quality )
              quality -= 1; // å¦‚æœè¶…è¿‡ç›®æ ‡å¤§å°ï¼Œå‡å°‘è´¨é‡å†æ¬¡å°è¯•
            } else {
              quality = 0;
            }
            
            //console.log(result.size/1000 + 'k')
          } else {
            if ( !targetSize[i] || result.size <= targetSize[i] ){
              //console.log(targetSize[i])
              document.getElementById('imgsize-' + i ).innerHTML =  Math.floor(result.size/1000) + "k /è´¨é‡:" + Math.ceil(quality) 
            } else {
              if (result.size){
                document.getElementById('imgsize-' + i ).innerHTML = '<span style="color:var(--liColor1)">' +  Math.floor(result.size/1000) + "k /å‹ç¼©å¤±è´¥</span>"
              } else {
                document.getElementById('imgsize-' + i ).innerHTML = '<span style="color:var(--liColor1)">' +  Math.floor(result.length/1000) + "k /å‹ç¼©å¤±è´¥</span>"
              }
              
            }
            //console.log(result)
            break;
          }
        } catch (error) {
          console.error('å‹ç¼©è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:', error);
          break;
        }
      } while (result.size > targetSize[i]);
    //}//å·²åˆ é™¤è¯¥åˆ¤æ–­ï¼Œä¼šå¯¼è‡´épngæ ¼å¼ç¼–ç é”™è¯¯
    

    compressedImages.push(result);
  }
  return compressedImages;
}

// åˆ›å»ºZIPæ–‡ä»¶å¹¶æä¾›ä¸‹è½½
function createZipAndDownload(compressedImages) {
  var MN = new Date()
  var M = String(MN.getMonth() + 1).padStart(2, '0');
  var N = String(MN.getDate()).padStart(2, '0');
  var HHMMSS = String(MN.getHours()).padStart(2, '0') + String(MN.getMinutes()).padStart(2, '0') + String(MN.getSeconds()).padStart(2, '0');
  var zip = new JSZip();

  var imgs = imgExportData;
  compressedImages.forEach((blob, index) => {
    var path = imgs[index].fileName.split('/');
    var name = path.pop();
    if (imgs[index].fileName.split('/').length == 2) {
      var folder = zip.folder(path[0]);
      folder.file(name,blob);
    } else if (imgs[index].fileName.split('/').length == 3) {
      var folder1 = zip.folder(path[0]);
      var folder2 = folder1.folder(path[1]);
      folder2.file(name,blob);
    } else {
      zip.file(name,blob);
    }
  });


  zip.generateAsync({ type: "blob" }).then(function (content) {
    saveAs(content, docInfo + '-' + M + N + '_' + HHMMSS + '.zip');
  });
}

//å¤§å›¾å¯¼å…¥è£å‰ª
function cutImg(file, name) {
  if (file instanceof File) {
    // å¤„ç†æ–‡ä»¶
    //console.log('è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶');
    var reader = new FileReader();
    reader.readAsArrayBuffer(file);
    reader.onload = function (e) {
      var data = new Uint8Array(e.target.result);
      var url = URL.createObjectURL(new Blob([data]));
      cutImgToCanvas(url)
    };
  } else if (typeof file === 'string') {
    // å¤„ç†å­—ç¬¦ä¸²
    //console.log(file)
    cutImgToCanvas(file)
    //console.log('è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²');
  } else {
    // å…¶ä»–ç±»å‹çš„å¤„ç†
    console.log('æœªçŸ¥ç±»å‹è¾“å…¥');
  }



  function cutImgToCanvas(url) {

    var canvas = document.createElement("canvas")
    var ctx = canvas.getContext("2d")

    var image = new Image();
    image.src = url;
    image.onload = function () {
      canvas.width = image.width;
      canvas.height = image.height;

      requestAnimationFrame(function draw() {
        // ç»˜åˆ¶å›¾ç‰‡
        ctx.drawImage(image, 0, 0);
        var cuts = creCutArea({ w: canvas.width, h: canvas.height, x: 0, y: 0, s: 1 },4096);
        // æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å®Œå…¨ç»˜åˆ¶
        if (image.complete) {
          //console.log(cuts.length)
          var cutImgs = []
          for (var i = 0; i < cuts.length; i++) {
            var canvas2 = document.createElement("canvas");
            canvas2.width = cuts[i].w;
            canvas2.height = cuts[i].h;
            var ctx2 = canvas2.getContext("2d");
            //requestAnimationFrame(function draw() {
            ctx2.drawImage(canvas, cuts[i].x, cuts[i].y, cuts[i].w, cuts[i].h, 0, 0, cuts[i].w, cuts[i].h);
            var imgData = new Uint8Array(atob(canvas2.toDataURL('image/png').split(',')[1]).split('').map(function (c) { return c.charCodeAt(0); }));
            if (cuts.length > 1) {
              cutImgs.push({ img: imgData, w: canvas2.width, h: canvas2.height, name: name + "-" + (i + 1), x: cuts[i].x, y: cuts[i].y })
            } else {
              cutImgs.push({ img: imgData, w: canvas2.width, h: canvas2.height, name: name, x: cuts[i].x, y: cuts[i].y })
            }

            //});  
            if (i == cuts.length - 1) {
              //console.log(cutImgs)
              message([cutImgs, 'pixelIm'])
            }
          }

        }

      });
    }

  }

}

//svgæ‹†è§£
function processSVG(svgCode) {

  // åˆ›å»ºä¸€ä¸ªæ–°çš„DOMè§£æå™¨
  var parser = new DOMParser();
  // è§£æSVGä»£ç 
  var svgDoc = parser.parseFromString(svgCode, 'text/xml');
  var svgRoot = svgDoc.documentElement;
  //console.log(svgRoot)
  // ç»“æœæ•°ç»„
  var result = [];
  // å¼€å§‹éå†
  traverse(svgRoot);
  function traverse(node) {
    if (node.nodeType === Node.ELEMENT_NODE) {
      if (node.tagName.toLowerCase() === 'image') {
        // å¤„ç†imageèŠ‚ç‚¹
        var imgs = cutImg(node.getAttribute('xlink:href'), "å›¾ç‰‡")
      }
    }
    for (let i = 0; i < node.childNodes.length; i++) {
      traverse(node.childNodes[i]);
    }
  }
}

//è£åˆ‡æ–¹æ¡ˆ
function creCutArea(info,mix) {//{w:,h:,x:,y:,s:}
  var W = info.w, H = info.h;//å›¾ç‰‡å®½é«˜
  var Ws = info.w, Hs = info.h;//éå°¾éƒ¨éƒ¨åˆ†çš„è£å‰ªå®½é«˜
  var lastWs = info.w, lastHs = info.h;//å°¾éƒ¨çš„è£å‰ªå®½é«˜
  var X = info.x, Y = info.y;//è£åˆ‡åŒºåæ ‡
  var cutW = 1, cutH = 1;//çºµæ¨ªè£å‰ªæ•°é‡
  var cuts = [];//ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°å°çš„è£åˆ‡åŒºåŸŸé›†
  var tips;
  //åˆ‡å‰²æ–¹æ¡ˆ
  if (W * info.s <= mix && H * info.s <= mix) {//4Kä»¥å†…ï¼Œæ­£å¸¸ç”Ÿæˆ
    cuts = [{ w: W, h: H, x: info.x, y: info.y, s: 1 }]
    return cuts;
  } else {//å¤šè¡Œåˆ—å®«æ ¼
    cutW = Math.ceil((W * info.s) / mix)
    cutH = Math.ceil((H * info.s) / mix)
    if (W % cutW == 0) { //å®½åº¦åˆšå¥½ç­‰åˆ†
      Ws = W / cutW
      lastWs = Ws

    } else { //æœ‰å°æ•°ç‚¹
      Ws = Math.ceil(W / cutW) //å‘ä¸Šå–æ•´ï¼Œæœ€åä¸€æˆªçŸ­ä¸€äº›
      lastWs = W - (Ws * (cutW - 1))
    }
    if (H % cutH == 0) { //é•¿åº¦åˆšå¥½ç­‰åˆ†
      Hs = H / cutH
      lastHs = Hs
      tips = "é«˜è¢«æ•´é™¤"
    } else { //æœ‰å°æ•°ç‚¹
      Hs = Math.ceil(H / cutH) //å‘ä¸Šå–æ•´ï¼Œæœ€åä¸€æˆªçŸ­ä¸€äº›
      lastHs = H - (Hs * (cutH - 1))
      tips = "é«˜ä¸èƒ½æ•´é™¤ï¼Œå‰©ä½™ï¼š" + lastHs
    }

    // æ‹†åˆ†å›¾åƒæ•°æ®
    for (var i = 0; i < (cutW * cutH); i++) {

      if ((i + 1) % cutW == 0 && i !== (cutW * cutH) - 1 && i !== 0) {
        cuts.push({ w: lastWs, h: Hs, x: X, y: Y, });
        Y = Y + Hs;
        X = info.x;
      } else if (i == (cutW * cutH) - 1) {
        cuts.push({ w: lastWs, h: lastHs, x: X, y: Y, t: tips });
      } else {
        if (i > (cutW * (cutH - 1)) - 1) {
          cuts.push({ w: Ws, h: lastHs, x: X, y: Y });
        } else {
          cuts.push({ w: Ws, h: Hs, x: X, y: Y });
        }

        if (cutW == 1) {
          X = info.x;
          Y = Y + Hs;
        } else {
          X = X + Ws;
        }

      }

    }
    return cuts;
  }

}

</script>
</body>
</html>